{"version":3,"file":"dc.min.js","sources":["../src/core/bad-argument-exception.js","../src/core/constants.js","../src/core/logger.js","../src/core/config.js","../src/core/chart-registry.js","../src/core/core.js","../src/core/events.js","../src/core/filters.js","../src/core/invalid-state-exception.js","../src/core/utils.js","../src/core/printers.js","../src/core/units.js","../src/core/d3compat.js","../src/base/base-mixin.js","../src/base/color-mixin.js","../src/base/bubble-mixin.js","../src/base/cap-mixin.js","../src/base/margin-mixin.js","../src/base/coordinate-grid-mixin.js","../src/base/d3.box.js","../src/base/stack-mixin.js","../src/charts/bar-chart.js","../src/charts/box-plot.js","../src/charts/bubble-chart.js","../src/charts/bubble-overlay.js","../src/charts/cbox-menu.js","../src/charts/composite-chart.js","../src/charts/data-count.js","../src/charts/data-grid.js","../src/charts/data-table.js","../src/charts/geo-choropleth-chart.js","../src/charts/heatmap.js","../src/charts/html-legend.js","../src/charts/legend.js","../src/charts/line-chart.js","../src/charts/number-display.js","../src/charts/pie-chart.js","../src/charts/row-chart.js","../src/charts/scatter-plot.js","../src/charts/select-menu.js","../src/charts/series-chart.js","../src/charts/sunburst-chart.js","../src/charts/text-filter-widget.js"],"sourcesContent":["\nexport class BadArgumentException extends Error { }\n","export const constants = {\n    CHART_CLASS: 'dc-chart',\n    DEBUG_GROUP_CLASS: 'debug',\n    STACK_CLASS: 'stack',\n    DESELECTED_CLASS: 'deselected',\n    SELECTED_CLASS: 'selected',\n    NODE_INDEX_NAME: '__index__',\n    GROUP_INDEX_NAME: '__group_index__',\n    DEFAULT_CHART_GROUP: '__default_chart_group__',\n    EVENT_DELAY: 40,\n    NEGLIGIBLE_NUMBER: 1e-10\n};\n","/**\n * Provides basis logging and deprecation utilities\n */\nexport class Logger {\n\n    constructor () {\n        /**\n         * Enable debug level logging. Set to `false` by default.\n         * @name enableDebugLog\n         * @memberof Logger\n         * @instance\n         */\n        this.enableDebugLog = false;\n\n        this._alreadyWarned = {};\n    }\n\n    /**\n     * Put a warning message to console\n     * @example\n     * logger.warn('Invalid use of .tension on CurveLinear');\n     * @param {String} [msg]\n     * @returns {Logger}\n     */\n    warn (msg) {\n        if (console) {\n            if (console.warn) {\n                console.warn(msg);\n            } else if (console.log) {\n                console.log(msg);\n            }\n        }\n\n        return this;\n    }\n\n    /**\n     * Put a warning message to console. It will warn only on unique messages.\n     * @example\n     * logger.warnOnce('Invalid use of .tension on CurveLinear');\n     * @param {String} [msg]\n     * @returns {Logger}\n     */\n    warnOnce (msg) {\n        if (!this._alreadyWarned[msg]) {\n            this._alreadyWarned[msg] = true;\n\n            logger.warn(msg);\n        }\n\n        return this;\n    }\n\n    /**\n     * Put a debug message to console. It is controlled by `logger.enableDebugLog`\n     * @example\n     * logger.debug('Total number of slices: ' + numSlices);\n     * @param {String} [msg]\n     * @returns {Logger}\n     */\n    debug (msg) {\n        if (this.enableDebugLog && console) {\n            if (console.debug) {\n                console.debug(msg);\n            } else if (console.log) {\n                console.log(msg);\n            }\n        }\n\n        return this;\n    }\n}\n\nexport const logger = new Logger();\n","import {timeFormat} from 'd3-time-format';\n\nimport {logger} from './logger';\n\n/**\n * General configuration\n */\nexport class Config {\n    constructor () {\n        this._defaultColors = Config._schemeCategory20c;\n\n        /**\n         * The default date format for dc.js\n         * @type {Function}\n         * @default d3.timeFormat('%m/%d/%Y')\n         */\n        this.dateFormat = timeFormat('%m/%d/%Y');\n\n        this._renderlet = null;\n\n        /**\n         * If this boolean is set truthy, all transitions will be disabled, and changes to the charts will happen\n         * immediately.\n         * @type {Boolean}\n         * @default false\n         */\n        this.disableTransitions = false;\n    }\n\n    /**\n     * Set the default color scheme for ordinal charts. Changing it will impact all ordinal charts.\n     *\n     * By default it is set to a copy of\n     * `d3.schemeCategory20c` for backward compatibility. This color scheme has been\n     * [removed from D3v5](https://github.com/d3/d3/blob/master/CHANGES.md#changes-in-d3-50).\n     * In DC 3.1 release it will change to a more appropriate default.\n     *\n     * @example\n     * config.defaultColors(d3.schemeSet1)\n     * @param {Array} [colors]\n     * @returns {Array|config}\n     */\n    defaultColors (colors) {\n        if (!arguments.length) {\n            // Issue warning if it uses _schemeCategory20c\n            if (this._defaultColors === Config._schemeCategory20c) {\n                logger.warnOnce('You are using d3.schemeCategory20c, which has been removed in D3v5. ' +\n                    'See the explanation at https://github.com/d3/d3/blob/master/CHANGES.md#changes-in-d3-50. ' +\n                    'DC is using it for backward compatibility, however it will be changed in DCv3.1. ' +\n                    'You can change it by calling dc.config.defaultColors(newScheme). ' +\n                    'See https://github.com/d3/d3-scale-chromatic for some alternatives.');\n            }\n            return this._defaultColors;\n        }\n        this._defaultColors = colors;\n        return this;\n    }\n\n}\n\n// D3v5 has removed schemeCategory20c, copied here for backward compatibility\nConfig._schemeCategory20c = [\n    '#3182bd', '#6baed6', '#9ecae1', '#c6dbef', '#e6550d',\n    '#fd8d3c', '#fdae6b', '#fdd0a2', '#31a354', '#74c476',\n    '#a1d99b', '#c7e9c0', '#756bb1', '#9e9ac8', '#bcbddc',\n    '#dadaeb', '#636363', '#969696', '#bdbdbd', '#d9d9d9'];\n\n/**\n * General configuration object; see {@link Config} for members.\n */\nexport const config = new Config();\n","import {constants} from './constants';\nimport {config} from './config';\n\n/**\n * The ChartRegistry maintains sets of all instantiated dc.js charts under named groups\n * and the default group. There is a single global ChartRegistry object named `chartRegistry`\n *\n * A chart group often corresponds to a crossfilter instance. It specifies\n * the set of charts which should be updated when a filter changes on one of the charts or when the\n * global functions {@link filterAll filterAll}, {@link refocusAll refocusAll},\n * {@link renderAll renderAll}, {@link redrawAll redrawAll}, or chart functions\n * {@link baseMixin#renderGroup baseMixin.renderGroup},\n * {@link baseMixin#redrawGroup baseMixin.redrawGroup} are called.\n */\nclass ChartRegistry {\n    constructor () {\n        // chartGroup:string => charts:array\n        this._chartMap = {};\n    }\n\n    _initializeChartGroup (group) {\n        if (!group) {\n            group = constants.DEFAULT_CHART_GROUP;\n        }\n\n        if (!(this._chartMap)[group]) {\n            (this._chartMap)[group] = [];\n        }\n\n        return group;\n    }\n\n    /**\n     * Determine if a given chart instance resides in any group in the registry.\n     * @param {Object} chart dc.js chart instance\n     * @returns {Boolean}\n     */\n    has (chart) {\n        for (const e in this._chartMap) {\n            if ((this._chartMap)[e].indexOf(chart) >= 0) {\n                return true;\n            }\n        }\n        return false;\n    }\n\n    /**\n     * Add given chart instance to the given group, creating the group if necessary.\n     * If no group is provided, the default group `constants.DEFAULT_CHART_GROUP` will be used.\n     * @param {Object} chart dc.js chart instance\n     * @param {String} [group] Group name\n     * @return {undefined}\n     */\n    register (chart, group) {\n        const _chartMap = this._chartMap;\n        group = this._initializeChartGroup(group);\n        _chartMap[group].push(chart);\n    }\n\n    /**\n     * Remove given chart instance from the given group, creating the group if necessary.\n     * If no group is provided, the default group `constants.DEFAULT_CHART_GROUP` will be used.\n     * @param {Object} chart dc.js chart instance\n     * @param {String} [group] Group name\n     * @return {undefined}\n     */\n    deregister (chart, group) {\n        group = this._initializeChartGroup(group);\n        for (let i = 0; i < (this._chartMap)[group].length; i++) {\n            if ((this._chartMap)[group][i].anchorName() === chart.anchorName()) {\n                (this._chartMap)[group].splice(i, 1);\n                break;\n            }\n        }\n    }\n\n    /**\n     * Clear given group if one is provided, otherwise clears all groups.\n     * @param {String} group Group name\n     * @return {undefined}\n     */\n    clear (group) {\n        if (group) {\n            delete (this._chartMap)[group];\n        } else {\n            this._chartMap = {};\n        }\n    }\n\n    /**\n     * Get an array of each chart instance in the given group.\n     * If no group is provided, the charts in the default group are returned.\n     * @param {String} [group] Group name\n     * @returns {Array<Object>}\n     */\n    list (group) {\n        group = this._initializeChartGroup(group);\n        return (this._chartMap)[group];\n    }\n}\n\n/**\n * The chartRegistry object maintains sets of all instantiated dc.js charts under named groups\n * and the default group. See {@link ChartRegistry ChartRegistry} for its methods.\n */\nexport const chartRegistry = new ChartRegistry();\n\n/**\n * Add given chart instance to the given group, creating the group if necessary.\n * If no group is provided, the default group `constants.DEFAULT_CHART_GROUP` will be used.\n * @function registerChart\n * @param {Object} chart dc.js chart instance\n * @param {String} [group] Group name\n * @return {undefined}\n */\nexport const registerChart = function (chart, group) {\n    chartRegistry.register(chart, group);\n};\n\n/**\n * Remove given chart instance from the given group, creating the group if necessary.\n * If no group is provided, the default group `constants.DEFAULT_CHART_GROUP` will be used.\n * @function deregisterChart\n * @param {Object} chart dc.js chart instance\n * @param {String} [group] Group name\n * @return {undefined}\n */\nexport const deregisterChart = function (chart, group) {\n    chartRegistry.deregister(chart, group);\n};\n\n/**\n * Determine if a given chart instance resides in any group in the registry.\n * @function hasChart\n * @param {Object} chart dc.js chart instance\n * @returns {Boolean}\n */\nexport const hasChart = function (chart) {\n    return chartRegistry.has(chart);\n};\n\n/**\n * Clear given group if one is provided, otherwise clears all groups.\n * @function deregisterAllCharts\n * @param {String} group Group name\n * @return {undefined}\n */\nexport const deregisterAllCharts = function (group) {\n    chartRegistry.clear(group);\n};\n\n/**\n * Clear all filters on all charts within the given chart group. If the chart group is not given then\n * only charts that belong to the default chart group will be reset.\n * @function filterAll\n * @param {String} [group]\n * @return {undefined}\n */\nexport const filterAll = function (group) {\n    const charts = chartRegistry.list(group);\n    for (let i = 0; i < charts.length; ++i) {\n        charts[i].filterAll();\n    }\n};\n\n/**\n * Reset zoom level / focus on all charts that belong to the given chart group. If the chart group is\n * not given then only charts that belong to the default chart group will be reset.\n * @function refocusAll\n * @param {String} [group]\n * @return {undefined}\n */\nexport const refocusAll = function (group) {\n    const charts = chartRegistry.list(group);\n    for (let i = 0; i < charts.length; ++i) {\n        if (charts[i].focus) {\n            charts[i].focus();\n        }\n    }\n};\n\n/**\n * Re-render all charts belong to the given chart group. If the chart group is not given then only\n * charts that belong to the default chart group will be re-rendered.\n * @function renderAll\n * @param {String} [group]\n * @return {undefined}\n */\nexport const renderAll = function (group) {\n    const charts = chartRegistry.list(group);\n    for (let i = 0; i < charts.length; ++i) {\n        charts[i].render();\n    }\n\n    if (config._renderlet !== null) {\n        config._renderlet(group);\n    }\n};\n\n/**\n * Redraw all charts belong to the given chart group. If the chart group is not given then only charts\n * that belong to the default chart group will be re-drawn. Redraw is different from re-render since\n * when redrawing dc tries to update the graphic incrementally, using transitions, instead of starting\n * from scratch.\n * @function redrawAll\n * @param {String} [group]\n * @return {undefined}\n */\nexport const redrawAll = function (group) {\n    const charts = chartRegistry.list(group);\n    for (let i = 0; i < charts.length; ++i) {\n        charts[i].redraw();\n    }\n\n    if (config._renderlet !== null) {\n        config._renderlet(group);\n    }\n};\n","import {config} from './config';\n\n/**\n * Start a transition on a selection if transitions are globally enabled\n * ({@link disableTransitions} is false) and the duration is greater than zero; otherwise return\n * the selection. Since most operations are the same on a d3 selection and a d3 transition, this\n * allows a common code path for both cases.\n * @function transition\n * @param {d3.selection} selection - the selection to be transitioned\n * @param {Number|Function} [duration=250] - the duration of the transition in milliseconds, a\n * function returning the duration, or 0 for no transition\n * @param {Number|Function} [delay] - the delay of the transition in milliseconds, or a function\n * returning the delay, or 0 for no delay\n * @param {String} [name] - the name of the transition (if concurrent transitions on the same\n * elements are needed)\n * @returns {d3.transition|d3.selection}\n */\nexport const transition = function (selection, duration, delay, name) {\n    if (config.disableTransitions || duration <= 0) {\n        return selection;\n    }\n\n    let s = selection.transition(name);\n\n    if (duration >= 0 || duration !== undefined) {\n        s = s.duration(duration);\n    }\n    if (delay >= 0 || delay !== undefined) {\n        s = s.delay(delay);\n    }\n\n    return s;\n};\n\n/* somewhat silly, but to avoid duplicating logic */\nexport const optionalTransition = function (enable, duration, delay, name) {\n    if (enable) {\n        return function (selection) {\n            return transition(selection, duration, delay, name);\n        };\n    } else {\n        return function (selection) {\n            return selection;\n        };\n    }\n};\n\n// See http://stackoverflow.com/a/20773846\nexport const afterTransition = function (_transition, callback) {\n    if (_transition.empty() || !_transition.duration) {\n        callback.call(_transition);\n    } else {\n        let n = 0;\n        _transition\n            .each(() => { ++n; })\n            .on('end', () => {\n                if (!--n) {\n                    callback.call(_transition);\n                }\n            });\n    }\n};\n\nexport const renderlet = function (_) {\n    if (!arguments.length) {\n        return config._renderlet;\n    }\n    config._renderlet = _;\n    return null;\n};\n\nexport const instanceOfChart = function (o) {\n    return o instanceof Object && o.__dcFlag__ && true;\n};\n","export const events = {\n    current: null\n};\n\n/**\n * This function triggers a throttled event function with a specified delay (in milli-seconds).  Events\n * that are triggered repetitively due to user interaction such brush dragging might flood the library\n * and invoke more renders than can be executed in time. Using this function to wrap your event\n * function allows the library to smooth out the rendering by throttling events and only responding to\n * the most recent event.\n * @name events.trigger\n * @example\n * chart.on('renderlet', function(chart) {\n *     // smooth the rendering through event throttling\n *     events.trigger(function(){\n *         // focus some other chart to the range selected by user on this chart\n *         someOtherChart.focus(chart.filter());\n *     });\n * })\n * @param {Function} closure\n * @param {Number} [delay]\n * @return {undefined}\n */\nevents.trigger = function (closure, delay) {\n    if (!delay) {\n        closure();\n        return;\n    }\n\n    events.current = closure;\n\n    setTimeout(() => {\n        if (closure === events.current) {\n            closure();\n        }\n    }, delay);\n};\n","/**\n * The dc.js filters are functions which are passed into crossfilter to chose which records will be\n * accumulated to produce values for the charts.  In the crossfilter model, any filters applied on one\n * dimension will affect all the other dimensions but not that one.  dc always applies a filter\n * function to the dimension; the function combines multiple filters and if any of them accept a\n * record, it is filtered in.\n *\n * These filter constructors are used as appropriate by the various charts to implement brushing.  We\n * mention below which chart uses which filter.  In some cases, many instances of a filter will be added.\n *\n * Each of the dc.js filters is an object with the following properties:\n * * `isFiltered` - a function that returns true if a value is within the filter\n * * `filterType` - a string identifying the filter, here the name of the constructor\n *\n * Currently these filter objects are also arrays, but this is not a requirement. Custom filters\n * can be used as long as they have the properties above.\n * @namespace filters\n * @type {{}}\n */\nexport const filters = {};\n\n/**\n * RangedFilter is a filter which accepts keys between `low` and `high`.  It is used to implement X\n * axis brushing for the {@link CoordinateGridMixin coordinate grid charts}.\n *\n * Its `filterType` is 'RangedFilter'\n * @name RangedFilter\n * @memberof filters\n * @param {Number} low\n * @param {Number} high\n * @returns {Array<Number>}\n * @constructor\n */\nfilters.RangedFilter = function (low, high) {\n    const range = new Array(low, high);\n    range.isFiltered = function (value) {\n        return value >= this[0] && value < this[1];\n    };\n    range.filterType = 'RangedFilter';\n\n    return range;\n};\n\n/**\n * TwoDimensionalFilter is a filter which accepts a single two-dimensional value.  It is used by the\n * {@link HeatMap heat map chart} to include particular cells as they are clicked.  (Rows and columns are\n * filtered by filtering all the cells in the row or column.)\n *\n * Its `filterType` is 'TwoDimensionalFilter'\n * @name TwoDimensionalFilter\n * @memberof filters\n * @param {Array<Number>} filter\n * @returns {Array<Number>}\n * @constructor\n */\nfilters.TwoDimensionalFilter = function (filter) {\n    if (filter === null) { return null; }\n\n    const f = filter;\n    f.isFiltered = function (value) {\n        return value.length && value.length === f.length &&\n               value[0] === f[0] && value[1] === f[1];\n    };\n    f.filterType = 'TwoDimensionalFilter';\n\n    return f;\n};\n\n/**\n * The RangedTwoDimensionalFilter allows filtering all values which fit within a rectangular\n * region. It is used by the {@link ScatterPlot scatter plot} to implement rectangular brushing.\n *\n * It takes two two-dimensional points in the form `[[x1,y1],[x2,y2]]`, and normalizes them so that\n * `x1 <= x2` and `y1 <= y2`. It then returns a filter which accepts any points which are in the\n * rectangular range including the lower values but excluding the higher values.\n *\n * If an array of two values are given to the RangedTwoDimensionalFilter, it interprets the values as\n * two x coordinates `x1` and `x2` and returns a filter which accepts any points for which `x1 <= x <\n * x2`.\n *\n * Its `filterType` is 'RangedTwoDimensionalFilter'\n * @name RangedTwoDimensionalFilter\n * @memberof filters\n * @param {Array<Array<Number>>} filter\n * @returns {Array<Array<Number>>}\n * @constructor\n */\nfilters.RangedTwoDimensionalFilter = function (filter) {\n    if (filter === null) { return null; }\n\n    const f = filter;\n    let fromBottomLeft;\n\n    if (f[0] instanceof Array) {\n        fromBottomLeft = [\n            [Math.min(filter[0][0], filter[1][0]), Math.min(filter[0][1], filter[1][1])],\n            [Math.max(filter[0][0], filter[1][0]), Math.max(filter[0][1], filter[1][1])]\n        ];\n    } else {\n        fromBottomLeft = [[filter[0], -Infinity], [filter[1], Infinity]];\n    }\n\n    f.isFiltered = function (value) {\n        let x, y;\n\n        if (value instanceof Array) {\n            x = value[0];\n            y = value[1];\n        } else {\n            x = value;\n            y = fromBottomLeft[0][1];\n        }\n\n        return x >= fromBottomLeft[0][0] && x < fromBottomLeft[1][0] &&\n               y >= fromBottomLeft[0][1] && y < fromBottomLeft[1][1];\n    };\n    f.filterType = 'RangedTwoDimensionalFilter';\n\n    return f;\n};\n\n// ******** Sunburst Chart ********\n\n/**\n * HierarchyFilter is a filter which accepts a key path as an array. It matches any node at, or\n * child of, the given path. It is used by the {@link SunburstChart sunburst chart} to include particular cells and all\n * their children as they are clicked.\n *\n * @name HierarchyFilter\n * @memberof filters\n * @param {String} path\n * @returns {Array<String>}\n * @constructor\n */\nfilters.HierarchyFilter = function (path) {\n    if (path === null) {\n        return null;\n    }\n\n    const filter = path.slice(0);\n    filter.isFiltered = function (value) {\n        if (!(filter.length && value && value.length && value.length >= filter.length)) {\n            return false;\n        }\n\n        for (let i = 0; i < filter.length; i++) {\n            if (value[i] !== filter[i]) {\n                return false;\n            }\n        }\n\n        return true;\n    };\n    return filter;\n};\n","\nexport class InvalidStateException extends Error { }\n","import {timeDay, timeHour, timeMinute, timeMonth, timeSecond, timeWeek, timeYear} from 'd3-time';\nimport {format} from 'd3-format';\n\nimport {constants} from './constants';\nimport {config} from './config';\n\n/**\n * Returns a function that given a string property name, can be used to pluck the property off an object.  A function\n * can be passed as the second argument to also alter the data being returned.\n *\n * This can be a useful shorthand method to create accessor functions.\n * @example\n * var xPluck = pluck('x');\n * var objA = {x: 1};\n * xPluck(objA) // 1\n * @example\n * var xPosition = pluck('x', function (x, i) {\n *     // `this` is the original datum,\n *     // `x` is the x property of the datum,\n *     // `i` is the position in the array\n *     return this.radius + x;\n * });\n * selectAll('.circle').data(...).x(xPosition);\n * @function pluck\n * @param {String} n\n * @param {Function} [f]\n * @returns {Function}\n */\nexport const pluck = function (n, f) {\n    if (!f) {\n        return function (d) { return d[n]; };\n    }\n    return function (d, i) { return f.call(d, d[n], i); };\n};\n\n/**\n * @namespace utils\n * @type {{}}\n */\nexport const utils = {};\n\n/**\n * Print a single value filter.\n * @method printSingleValue\n * @memberof utils\n * @param {any} filter\n * @returns {String}\n */\nutils.printSingleValue = function (filter) {\n    let s = `${filter}`;\n\n    if (filter instanceof Date) {\n        s = config.dateFormat(filter);\n    } else if (typeof (filter) === 'string') {\n        s = filter;\n    } else if (utils.isFloat(filter)) {\n        s = utils.printSingleValue.fformat(filter);\n    } else if (utils.isInteger(filter)) {\n        s = Math.round(filter);\n    }\n\n    return s;\n};\nutils.printSingleValue.fformat = format('.2f');\n\n// convert 'day' to d3.timeDay and similar\nutils._toTimeFunc = function (t) {\n    const mappings = {\n        'second': timeSecond,\n        'minute': timeMinute,\n        'hour': timeHour,\n        'day': timeDay,\n        'week': timeWeek,\n        'month': timeMonth,\n        'year': timeYear\n    };\n    return mappings[t];\n};\n\n/**\n * Arbitrary add one value to another.\n *\n * If the value l is of type Date, adds r units to it. t becomes the unit.\n * For example utils.add(dt, 3, 'week') will add 3 (r = 3) weeks (t= 'week') to dt.\n *\n * If l is of type numeric, t is ignored. In this case if r is of type string,\n * it is assumed to be percentage (whether or not it includes %). For example\n * utils.add(30, 10) will give 40 and utils.add(30, '10') will give 33.\n *\n * They also generate strange results if l is a string.\n * @method add\n * @memberof utils\n * @param {Date|Number} l the value to modify\n * @param {String|Number} r the amount by which to modify the value\n * @param {Function|String} [t=d3.timeDay] if `l` is a `Date`, then this should be a\n * [d3 time interval](https://github.com/d3/d3-time/blob/master/README.md#_interval).\n * For backward compatibility with dc.js 2.0, it can also be the name of an interval, i.e.\n * 'millis', 'second', 'minute', 'hour', 'day', 'week', 'month', or 'year'\n * @returns {Date|Number}\n */\nutils.add = function (l, r, t) {\n    if (typeof r === 'string') {\n        r = r.replace('%', '');\n    }\n\n    if (l instanceof Date) {\n        if (typeof r === 'string') {\n            r = +r;\n        }\n        if (t === 'millis') {\n            return new Date(l.getTime() + r);\n        }\n        t = t || timeDay;\n        if (typeof t !== 'function') {\n            t = utils._toTimeFunc(t);\n        }\n        return t.offset(l, r);\n    } else if (typeof r === 'string') {\n        const percentage = (+r / 100);\n        return l > 0 ? l * (1 + percentage) : l * (1 - percentage);\n    } else {\n        return l + r;\n    }\n};\n\n/**\n * Arbitrary subtract one value from another.\n *\n * If the value l is of type Date, subtracts r units from it. t becomes the unit.\n * For example utils.subtract(dt, 3, 'week') will subtract 3 (r = 3) weeks (t= 'week') from dt.\n *\n * If l is of type numeric, t is ignored. In this case if r is of type string,\n * it is assumed to be percentage (whether or not it includes %). For example\n * utils.subtract(30, 10) will give 20 and utils.subtract(30, '10') will give 27.\n *\n * They also generate strange results if l is a string.\n * @method subtract\n * @memberof utils\n * @param {Date|Number} l the value to modify\n * @param {String|Number} r the amount by which to modify the value\n * @param {Function|String} [t=d3.timeDay] if `l` is a `Date`, then this should be a\n * [d3 time interval](https://github.com/d3/d3-time/blob/master/README.md#_interval).\n * For backward compatibility with dc.js 2.0, it can also be the name of an interval, i.e.\n * 'millis', 'second', 'minute', 'hour', 'day', 'week', 'month', or 'year'\n * @returns {Date|Number}\n */\nutils.subtract = function (l, r, t) {\n    if (typeof r === 'string') {\n        r = r.replace('%', '');\n    }\n\n    if (l instanceof Date) {\n        if (typeof r === 'string') {\n            r = +r;\n        }\n        if (t === 'millis') {\n            return new Date(l.getTime() - r);\n        }\n        t = t || timeDay;\n        if (typeof t !== 'function') {\n            t = utils._toTimeFunc(t);\n        }\n        return t.offset(l, -r);\n    } else if (typeof r === 'string') {\n        const percentage = (+r / 100);\n        return l < 0 ? l * (1 + percentage) : l * (1 - percentage);\n    } else {\n        return l - r;\n    }\n};\n\n/**\n * Is the value a number?\n * @method isNumber\n * @memberof utils\n * @param {any} n\n * @returns {Boolean}\n */\nutils.isNumber = function (n) {\n    return n === +n;\n};\n\n/**\n * Is the value a float?\n * @method isFloat\n * @memberof utils\n * @param {any} n\n * @returns {Boolean}\n */\nutils.isFloat = function (n) {\n    return n === +n && n !== (n | 0);\n};\n\n/**\n * Is the value an integer?\n * @method isInteger\n * @memberof utils\n * @param {any} n\n * @returns {Boolean}\n */\nutils.isInteger = function (n) {\n    return n === +n && n === (n | 0);\n};\n\n/**\n * Is the value very close to zero?\n * @method isNegligible\n * @memberof utils\n * @param {any} n\n * @returns {Boolean}\n */\nutils.isNegligible = function (n) {\n    return !utils.isNumber(n) || (n < constants.NEGLIGIBLE_NUMBER && n > -constants.NEGLIGIBLE_NUMBER);\n};\n\n/**\n * Ensure the value is no greater or less than the min/max values.  If it is return the boundary value.\n * @method clamp\n * @memberof utils\n * @param {any} val\n * @param {any} min\n * @param {any} max\n * @returns {any}\n */\nutils.clamp = function (val, min, max) {\n    return val < min ? min : (val > max ? max : val);\n};\n\n/**\n * Given `x`, return a function that always returns `x`.\n *\n * {@link https://github.com/d3/d3/blob/master/CHANGES.md#internals `d3.functor` was removed in d3 version 4}.\n * This function helps to implement the replacement,\n * `typeof x === \"function\" ? x : utils.constant(x)`\n * @method constant\n * @memberof utils\n * @param {any} x\n * @returns {Function}\n */\nutils.constant = function (x) {\n    return function () {\n        return x;\n    };\n};\n\n/**\n * Using a simple static counter, provide a unique integer id.\n * @method uniqueId\n * @memberof utils\n * @returns {Number}\n */\nlet _idCounter = 0;\nutils.uniqueId = function () {\n    return ++_idCounter;\n};\n\n/**\n * Convert a name to an ID.\n * @method nameToId\n * @memberof utils\n * @param {String} name\n * @returns {String}\n */\nutils.nameToId = function (name) {\n    return name.toLowerCase().replace(/[\\s]/g, '_').replace(/[\\.']/g, '');\n};\n\n/**\n * Append or select an item on a parent element.\n * @method appendOrSelect\n * @memberof utils\n * @param {d3.selection} parent\n * @param {String} selector\n * @param {String} tag\n * @returns {d3.selection}\n */\nutils.appendOrSelect = function (parent, selector, tag) {\n    tag = tag || selector;\n    let element = parent.select(selector);\n    if (element.empty()) {\n        element = parent.append(tag);\n    }\n    return element;\n};\n\n/**\n * Return the number if the value is a number; else 0.\n * @method safeNumber\n * @memberof utils\n * @param {Number|any} n\n * @returns {Number}\n */\nutils.safeNumber = function (n) { return utils.isNumber(+n) ? +n : 0;};\n\n/**\n * Return true if both arrays are equal, if both array are null these are considered equal\n * @method arraysEqual\n * @memberof utils\n * @param {Array|null} a1\n * @param {Array|null} a2\n * @returns {Boolean}\n */\nutils.arraysEqual = function (a1, a2) {\n    if (!a1 && !a2) {\n        return true;\n    }\n\n    if (!a1 || !a2) {\n        return false;\n    }\n\n    return a1.length === a2.length &&\n        // If elements are not integers/strings, we hope that it will match because of toString\n        // Test cases cover dates as well.\n        a1.every((elem, i) => elem.valueOf() === a2[i].valueOf());\n};\n\n// ******** Sunburst Chart ********\nutils.allChildren = function (node) {\n    let paths = [];\n    paths.push(node.path);\n    console.log('currentNode', node);\n    if (node.children) {\n        for (let i = 0; i < node.children.length; i++) {\n            paths = paths.concat(utils.allChildren(node.children[i]));\n        }\n    }\n    return paths;\n};\n\n// builds a d3 Hierarchy from a collection\n// TODO: turn this monster method something better.\nutils.toHierarchy = function (list, accessor) {\n    const root = {'key': 'root', 'children': []};\n    for (let i = 0; i < list.length; i++) {\n        const data = list[i];\n        const parts = data.key;\n        const value = accessor(data);\n        let currentNode = root;\n        for (let j = 0; j < parts.length; j++) {\n            const currentPath = parts.slice(0, j + 1);\n            const children = currentNode.children;\n            const nodeName = parts[j];\n            let childNode;\n            if (j + 1 < parts.length) {\n                // Not yet at the end of the sequence; move down the tree.\n                childNode = findChild(children, nodeName);\n\n                // If we don't already have a child node for this branch, create it.\n                if (childNode === void 0) {\n                    childNode = {'key': nodeName, 'children': [], 'path': currentPath};\n                    children.push(childNode);\n                }\n                currentNode = childNode;\n            } else {\n                // Reached the end of the sequence; create a leaf node.\n                childNode = {'key': nodeName, 'value': value, 'data': data, 'path': currentPath};\n                children.push(childNode);\n            }\n        }\n    }\n    return root;\n};\n\nfunction findChild (children, nodeName) {\n    for (let k = 0; k < children.length; k++) {\n        if (children[k].key === nodeName) {\n            return children[k];\n        }\n    }\n}\n\nutils.getAncestors = function (node) {\n    const path = [];\n    let current = node;\n    while (current.parent) {\n        path.unshift(current.name);\n        current = current.parent;\n    }\n    return path;\n};\n\nutils.arraysIdentical = function (a, b) {\n    let i = a.length;\n    if (i !== b.length) {\n        return false;\n    }\n    while (i--) {\n        if (a[i] !== b[i]) {\n            return false;\n        }\n    }\n    return true;\n};\n","import {utils} from './utils';\n\n/**\n * @namespace printers\n * @type {{}}\n */\nexport const printers = {};\n\n/**\n * Converts a list of filters into a readable string.\n * @method filters\n * @memberof printers\n * @param {Array<filters>} filters\n * @returns {String}\n */\nprinters.filters = function (filters) {\n    let s = '';\n\n    for (let i = 0; i < filters.length; ++i) {\n        if (i > 0) {\n            s += ', ';\n        }\n        s += printers.filter(filters[i]);\n    }\n\n    return s;\n};\n\n/**\n * Converts a filter into a readable string.\n * @method filter\n * @memberof printers\n * @param {filters|any|Array<any>} filter\n * @returns {String}\n */\nprinters.filter = function (filter) {\n    let s = '';\n\n    if (typeof filter !== 'undefined' && filter !== null) {\n        if (filter instanceof Array) {\n            if (filter.length >= 2) {\n                s = `[${filter.map(e => utils.printSingleValue(e)).join(' -> ')}]`;\n            } else if (filter.length >= 1) {\n                s = utils.printSingleValue(filter[0]);\n            }\n        } else {\n            s = utils.printSingleValue(filter);\n        }\n    }\n\n    return s;\n};\n","import {utils} from './utils';\n\n/**\n * @namespace units\n * @type {{}}\n */\nexport const units = {};\n\n/**\n * The default value for {@link CoordinateGridMixin#xUnits .xUnits} for the\n * {@link CoordinateGridMixin Coordinate Grid Chart} and should\n * be used when the x values are a sequence of integers.\n * It is a function that counts the number of integers in the range supplied in its start and end parameters.\n * @method integers\n * @memberof units\n * @see {@link CoordinateGridMixin#xUnits coordinateGridMixin.xUnits}\n * @example\n * chart.xUnits(units.integers) // already the default\n * @param {Number} start\n * @param {Number} end\n * @returns {Number}\n */\nunits.integers = function (start, end) {\n    return Math.abs(end - start);\n};\n\n/**\n * This argument can be passed to the {@link CoordinateGridMixin#xUnits .xUnits} function of a\n * coordinate grid chart to specify ordinal units for the x axis. Usually this parameter is used in\n * combination with passing\n * {@link https://github.com/d3/d3-scale/blob/master/README.md#ordinal-scales d3.scaleOrdinal}\n * to {@link CoordinateGridMixin#x .x}.\n *\n * As of dc.js 3.0, this is purely a placeholder or magic value which causes the chart to go into ordinal mode; the\n * function is not called.\n * @method ordinal\n * @memberof units\n * @return {uncallable}\n * @see {@link https://github.com/d3/d3-scale/blob/master/README.md#ordinal-scales d3.scaleOrdinal}\n * @see {@link CoordinateGridMixin#xUnits coordinateGridMixin.xUnits}\n * @see {@link CoordinateGridMixin#x coordinateGridMixin.x}\n * @example\n * chart.xUnits(units.ordinal)\n *      .x(d3.scaleOrdinal())\n */\nunits.ordinal = function () {\n    throw new Error('dc.units.ordinal should not be called - it is a placeholder');\n};\n\n/**\n * @namespace fp\n * @memberof units\n * @type {{}}\n */\nunits.fp = {};\n/**\n * This function generates an argument for the {@link CoordinateGridMixin Coordinate Grid Chart}\n * {@link CoordinateGridMixin#xUnits .xUnits} function specifying that the x values are floating-point\n * numbers with the given precision.\n * The returned function determines how many values at the given precision will fit into the range\n * supplied in its start and end parameters.\n * @method precision\n * @memberof units.fp\n * @see {@link CoordinateGridMixin#xUnits coordinateGridMixin.xUnits}\n * @example\n * // specify values (and ticks) every 0.1 units\n * chart.xUnits(units.fp.precision(0.1)\n * // there are 500 units between 0.5 and 1 if the precision is 0.001\n * var thousandths = units.fp.precision(0.001);\n * thousandths(0.5, 1.0) // returns 500\n * @param {Number} precision\n * @returns {Function} start-end unit function\n */\nunits.fp.precision = function (precision) {\n    const _f = function (s, e) {\n        const d = Math.abs((e - s) / _f.resolution);\n        if (utils.isNegligible(d - Math.floor(d))) {\n            return Math.floor(d);\n        } else {\n            return Math.ceil(d);\n        }\n    };\n    _f.resolution = precision;\n    return _f;\n};\n","import {event} from 'd3-selection';\nimport {nest} from 'd3-collection';\n//import {groups} from 'd3-array';\n\n// d3v6 has changed the arguments for event handlers.\n// We are creating a wrapper which detects if the first argument is an event, which indicated d3@v6\n// Otherwise we assume lower versions of d3.\n// The underlying handler will always receive bound datum as the first argument and the event as the second argument.\n// It is possible that any of these can actually be undefined (or null).\nexport function adaptHandler (handler) {\n    //const event = undefined\n    return function (a, b) {\n        if (a && a.target) {\n            // d3@v6 - b is __data__, a is the event\n            handler.call(this, b, a);\n        } else {\n            // older d3 - a is __data__, event from global d3.event\n            handler.call(this, a, event);\n        }\n    }\n}\n\nfunction _d3v5Nester ({key, sortKeys, sortValues, entries}) {\n    const nester = nest().key(key);\n    if (sortKeys) {\n        nester.sortKeys(sortKeys);\n    }\n    if (sortValues) {\n        nester.sortValues(sortValues);\n    }\n    return nester.entries(entries);\n}\n\nfunction _d3v6Nester ({key, sortKeys, sortValues, entries}) {\n    // Ugly ugly\n    return null\n    /*if (sortValues) {\n        entries = [...entries].sort(sortValues);\n    }\n    let out = groups(entries, key);\n    if (sortKeys) {\n        out = out.sort(sortKeys);\n    }\n\n    // remap to d3@v5 structure\n    return out.map(e => ({\n        key: `${e[0]}`, // d3@v5 always returns key as string\n        values: e[1]\n    }));*/\n}\n\nexport function compatNestHelper ({key, sortKeys, sortValues, entries}) {\n    const groups = undefined\n    if (groups) {\n        // d3@v6\n        return _d3v6Nester({key, sortKeys, sortValues, entries});\n    } else {\n        // older d3\n        return _d3v5Nester({key, sortKeys, sortValues, entries});\n    }\n}\n","import {select} from 'd3-selection';\nimport {dispatch} from 'd3-dispatch';\nimport {ascending} from 'd3-array';\n\nimport {pluck, utils} from '../core/utils';\nimport {instanceOfChart} from '../core/core';\nimport {deregisterChart, redrawAll, registerChart, renderAll} from '../core/chart-registry';\nimport {constants} from '../core/constants';\nimport {events} from '../core/events';\nimport {logger} from '../core/logger';\nimport {printers} from '../core/printers';\nimport {InvalidStateException} from '../core/invalid-state-exception';\nimport {BadArgumentException} from '../core/bad-argument-exception';\nimport {adaptHandler} from '../core/d3compat';\n\nconst _defaultFilterHandler = (dimension, filters) => {\n    if (filters.length === 0) {\n        dimension.filter(null);\n    } else if (filters.length === 1 && !filters[0].isFiltered) {\n        // single value and not a function-based filter\n        dimension.filterExact(filters[0]);\n    } else if (filters.length === 1 && filters[0].filterType === 'RangedFilter') {\n        // single range-based filter\n        dimension.filterRange(filters[0]);\n    } else {\n        dimension.filterFunction(d => {\n            for (let i = 0; i < filters.length; i++) {\n                const filter = filters[i];\n                if (filter.isFiltered) {\n                    if(filter.isFiltered(d)) {\n                        return true;\n                    }\n                } else if (filter <= d && filter >= d) {\n                    return true;\n                }\n            }\n            return false;\n        });\n    }\n    return filters;\n};\n\nconst _defaultHasFilterHandler = (filters, filter) => {\n    if (filter === null || typeof (filter) === 'undefined') {\n        return filters.length > 0;\n    }\n    return filters.some(f => filter <= f && filter >= f);\n};\n\nconst _defaultRemoveFilterHandler = (filters, filter) => {\n    for (let i = 0; i < filters.length; i++) {\n        if (filters[i] <= filter && filters[i] >= filter) {\n            filters.splice(i, 1);\n            break;\n        }\n    }\n    return filters;\n};\n\nconst _defaultAddFilterHandler = (filters, filter) => {\n    filters.push(filter);\n    return filters;\n};\n\nconst _defaultResetFilterHandler = filters => [];\n\n/**\n * `BaseMixin` is an abstract functional object representing a basic `dc` chart object\n * for all chart and widget implementations. Methods from the {@link #BaseMixin BaseMixin} are inherited\n * and available on all chart implementations in the `dc` library.\n * @mixin BaseMixin\n */\nexport class BaseMixin {\n    constructor () {\n        this.__dcFlag__ = utils.uniqueId();\n        this._svgDescription = null\n        this._keyboardAccessible = false;\n\n        this._dimension = undefined;\n        this._group = undefined;\n\n        this._anchor = undefined;\n        this._root = undefined;\n        this._svg = undefined;\n        this._isChild = undefined;\n\n        this._minWidth = 200;\n        this._defaultWidthCalc = element => {\n            const width = element && element.getBoundingClientRect && element.getBoundingClientRect().width;\n            return (width && width > this._minWidth) ? width : this._minWidth;\n        };\n        this._widthCalc = this._defaultWidthCalc;\n\n        this._minHeight = 200;\n        this._defaultHeightCalc = element => {\n            const height = element && element.getBoundingClientRect && element.getBoundingClientRect().height;\n            return (height && height > this._minHeight) ? height : this._minHeight;\n        };\n        this._heightCalc = this._defaultHeightCalc;\n        this._width = undefined;\n        this._height = undefined;\n        this._useViewBoxResizing = false;\n\n        this._keyAccessor = pluck('key');\n        this._valueAccessor = pluck('value');\n        this._label = pluck('key');\n\n        this._ordering = pluck('key');\n\n        this._renderLabel = false;\n\n        this._title = d => `${this.keyAccessor()(d)}: ${this.valueAccessor()(d)}`;\n        this._renderTitle = true;\n        this._controlsUseVisibility = false;\n\n        this._transitionDuration = 750;\n\n        this._transitionDelay = 0;\n\n        this._filterPrinter = printers.filters;\n\n        this._mandatoryAttributesList = ['dimension', 'group'];\n\n        this._chartGroup = constants.DEFAULT_CHART_GROUP;\n\n        this._listeners = dispatch(\n            'preRender',\n            'postRender',\n            'preRedraw',\n            'postRedraw',\n            'filtered',\n            'zoomed',\n            'renderlet',\n            'pretransition');\n\n        this._legend = undefined;\n        this._commitHandler = undefined;\n\n        this._defaultData = group => group.all();\n        this._data = this._defaultData;\n\n        this._filters = [];\n\n        this._filterHandler = _defaultFilterHandler;\n        this._hasFilterHandler = _defaultHasFilterHandler;\n        this._removeFilterHandler = _defaultRemoveFilterHandler;\n        this._addFilterHandler = _defaultAddFilterHandler;\n        this._resetFilterHandler = _defaultResetFilterHandler;\n    }\n\n    /**\n     * Set or get the height attribute of a chart. The height is applied to the SVGElement generated by\n     * the chart when rendered (or re-rendered). If a value is given, then it will be used to calculate\n     * the new height and the chart returned for method chaining.  The value can either be a numeric, a\n     * function, or falsy. If no value is specified then the value of the current height attribute will\n     * be returned.\n     *\n     * By default, without an explicit height being given, the chart will select the width of its\n     * anchor element. If that isn't possible it defaults to 200 (provided by the\n     * {@link BaseMixin#minHeight minHeight} property). Setting the value falsy will return\n     * the chart to the default behavior.\n     * @see {@link BaseMixin#minHeight minHeight}\n     * @example\n     * // Default height\n     * chart.height(function (element) {\n     *     var height = element && element.getBoundingClientRect && element.getBoundingClientRect().height;\n     *     return (height && height > chart.minHeight()) ? height : chart.minHeight();\n     * });\n     *\n     * chart.height(250); // Set the chart's height to 250px;\n     * chart.height(function(anchor) { return doSomethingWith(anchor); }); // set the chart's height with a function\n     * chart.height(null); // reset the height to the default auto calculation\n     * @param {Number|Function} [height]\n     * @returns {Number|BaseMixin}\n     */\n    height (height) {\n        if (!arguments.length) {\n            if (!utils.isNumber(this._height)) {\n                // only calculate once\n                this._height = this._heightCalc(this._root.node());\n            }\n            return this._height;\n        }\n        this._heightCalc = height ? (typeof height === 'function' ? height : utils.constant(height)) : this._defaultHeightCalc;\n        this._height = undefined;\n        return this;\n    }\n\n    /**\n     * Set or get the width attribute of a chart.\n     * @see {@link BaseMixin#height height}\n     * @see {@link BaseMixin#minWidth minWidth}\n     * @example\n     * // Default width\n     * chart.width(function (element) {\n     *     var width = element && element.getBoundingClientRect && element.getBoundingClientRect().width;\n     *     return (width && width > chart.minWidth()) ? width : chart.minWidth();\n     * });\n     * @param {Number|Function} [width]\n     * @returns {Number|BaseMixin}\n     */\n    width (width) {\n        if (!arguments.length) {\n            if (!utils.isNumber(this._width)) {\n                // only calculate once\n                this._width = this._widthCalc(this._root.node());\n            }\n            return this._width;\n        }\n        this._widthCalc = width ? (typeof width === 'function' ? width : utils.constant(width)) : this._defaultWidthCalc;\n        this._width = undefined;\n        return this;\n    }\n\n    /**\n     * Set or get the minimum width attribute of a chart. This only has effect when used with the default\n     * {@link BaseMixin#width width} function.\n     * @see {@link BaseMixin#width width}\n     * @param {Number} [minWidth=200]\n     * @returns {Number|BaseMixin}\n     */\n    minWidth (minWidth) {\n        if (!arguments.length) {\n            return this._minWidth;\n        }\n        this._minWidth = minWidth;\n        return this;\n    }\n\n    /**\n     * Set or get the minimum height attribute of a chart. This only has effect when used with the default\n     * {@link BaseMixin#height height} function.\n     * @see {@link BaseMixin#height height}\n     * @param {Number} [minHeight=200]\n     * @returns {Number|BaseMixin}\n     */\n    minHeight (minHeight) {\n        if (!arguments.length) {\n            return this._minHeight;\n        }\n        this._minHeight = minHeight;\n        return this;\n    }\n\n    /**\n     * Turn on/off using the SVG\n     * {@link https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/viewBox `viewBox` attribute}.\n     * When enabled, `viewBox` will be set on the svg root element instead of `width` and `height`.\n     * Requires that the chart aspect ratio be defined using chart.width(w) and chart.height(h).\n     *\n     * This will maintain the aspect ratio while enabling the chart to resize responsively to the\n     * space given to the chart using CSS. For example, the chart can use `width: 100%; height:\n     * 100%` or absolute positioning to resize to its parent div.\n     *\n     * Since the text will be sized as if the chart is drawn according to the width and height, and\n     * will be resized if the chart is any other size, you need to set the chart width and height so\n     * that the text looks good. In practice, 600x400 seems to work pretty well for most charts.\n     *\n     * You can see examples of this resizing strategy in the [Chart Resizing\n     * Examples](http://dc-js.github.io/dc.js/resizing/); just add `?resize=viewbox` to any of the\n     * one-chart examples to enable `useViewBoxResizing`.\n     * @param {Boolean} [useViewBoxResizing=false]\n     * @returns {Boolean|BaseMixin}\n     */\n    useViewBoxResizing (useViewBoxResizing) {\n        if (!arguments.length) {\n            return this._useViewBoxResizing;\n        }\n        this._useViewBoxResizing = useViewBoxResizing;\n        return this;\n    }\n\n    /**\n     * **mandatory**\n     *\n     * Set or get the dimension attribute of a chart. In `dc`, a dimension can be any valid\n     * {@link https://github.com/crossfilter/crossfilter/wiki/API-Reference#dimension crossfilter dimension}\n     *\n     * If a value is given, then it will be used as the new dimension. If no value is specified then\n     * the current dimension will be returned.\n     * @see {@link https://github.com/crossfilter/crossfilter/wiki/API-Reference#dimension crossfilter.dimension}\n     * @example\n     * var index = crossfilter([]);\n     * var dimension = index.dimension(pluck('key'));\n     * chart.dimension(dimension);\n     * @param {crossfilter.dimension} [dimension]\n     * @returns {crossfilter.dimension|BaseMixin}\n     */\n    dimension (dimension) {\n        if (!arguments.length) {\n            return this._dimension;\n        }\n        this._dimension = dimension;\n        this.expireCache();\n        return this;\n    }\n\n    /**\n     * Set the data callback or retrieve the chart's data set. The data callback is passed the chart's\n     * group and by default will return\n     * {@link https://github.com/crossfilter/crossfilter/wiki/API-Reference#group_all group.all}.\n     * This behavior may be modified to, for instance, return only the top 5 groups.\n     * @example\n     * // Default data function\n     * chart.data(function (group) { return group.all(); });\n     *\n     * chart.data(function (group) { return group.top(5); });\n     * @param {Function} [callback]\n     * @returns {*|BaseMixin}\n     */\n    data (callback) {\n        if (!arguments.length) {\n            return this._data(this._group);\n        }\n        this._data = typeof callback === 'function' ? callback : utils.constant(callback);\n        this.expireCache();\n        return this;\n    }\n\n    /**\n     * **mandatory**\n     *\n     * Set or get the group attribute of a chart. In `dc` a group is a\n     * {@link https://github.com/crossfilter/crossfilter/wiki/API-Reference#group-map-reduce crossfilter group}.\n     * Usually the group should be created from the particular dimension associated with the same chart. If a value is\n     * given, then it will be used as the new group.\n     *\n     * If no value specified then the current group will be returned.\n     * If `name` is specified then it will be used to generate legend label.\n     * @see {@link https://github.com/crossfilter/crossfilter/wiki/API-Reference#group-map-reduce crossfilter.group}\n     * @example\n     * var index = crossfilter([]);\n     * var dimension = index.dimension(pluck('key'));\n     * chart.dimension(dimension);\n     * chart.group(dimension.group().reduceSum());\n     * @param {crossfilter.group} [group]\n     * @param {String} [name]\n     * @returns {crossfilter.group|BaseMixin}\n     */\n    group (group, name) {\n        if (!arguments.length) {\n            return this._group;\n        }\n        this._group = group;\n        this._groupName = name;\n        this.expireCache();\n        return this;\n    }\n\n    /**\n     * Get or set an accessor to order ordinal dimensions.  The chart uses\n     * {@link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/sort Array.sort}\n     * to sort elements; this accessor returns the value to order on.\n     * @example\n     * // Default ordering accessor\n     * _chart.ordering(pluck('key'));\n     * @param {Function} [orderFunction]\n     * @returns {Function|BaseMixin}\n     */\n    ordering (orderFunction) {\n        if (!arguments.length) {\n            return this._ordering;\n        }\n        this._ordering = orderFunction;\n        this.expireCache();\n        return this;\n    }\n\n    _computeOrderedGroups (data) {\n        // clone the array before sorting, otherwise Array.sort sorts in-place\n        return Array.from(data).sort((a, b) => ascending(this._ordering(a), this._ordering(b)));\n    }\n\n    /**\n     * Clear all filters associated with this chart. The same effect can be achieved by calling\n     * {@link BaseMixin#filter chart.filter(null)}.\n     * @returns {BaseMixin}\n     */\n    filterAll () {\n        return this.filter(null);\n    }\n\n    /**\n     * Execute d3 single selection in the chart's scope using the given selector and return the d3\n     * selection.\n     *\n     * This function is **not chainable** since it does not return a chart instance; however the d3\n     * selection result can be chained to d3 function calls.\n     * @see {@link https://github.com/d3/d3-selection/blob/master/README.md#select d3.select}\n     * @example\n     * // Has the same effect as d3.select('#chart-id').select(selector)\n     * chart.select(selector)\n     * @param {String} sel CSS selector string\n     * @returns {d3.selection}\n     */\n    select (sel) {\n        return this._root.select(sel);\n    }\n\n    /**\n     * Execute in scope d3 selectAll using the given selector and return d3 selection result.\n     *\n     * This function is **not chainable** since it does not return a chart instance; however the d3\n     * selection result can be chained to d3 function calls.\n     * @see {@link https://github.com/d3/d3-selection/blob/master/README.md#selectAll d3.selectAll}\n     * @example\n     * // Has the same effect as d3.select('#chart-id').selectAll(selector)\n     * chart.selectAll(selector)\n     * @param {String} sel CSS selector string\n     * @returns {d3.selection}\n     */\n    selectAll (sel) {\n        return this._root ? this._root.selectAll(sel) : null;\n    }\n\n    /**\n     * Set the root SVGElement to either be an existing chart's root; or any valid [d3 single\n     * selector](https://github.com/d3/d3-selection/blob/master/README.md#selecting-elements) specifying a dom\n     * block element such as a div; or a dom element or d3 selection. Optionally registers the chart\n     * within the chartGroup. This class is called internally on chart initialization, but be called\n     * again to relocate the chart. However, it will orphan any previously created SVGElements.\n     * @param {anchorChart|anchorSelector|anchorNode} [parent]\n     * @param {String} [chartGroup]\n     * @returns {String|node|d3.selection|BaseMixin}\n     */\n    anchor (parent, chartGroup) {\n        if (!arguments.length) {\n            return this._anchor;\n        }\n        if (instanceOfChart(parent)) {\n            this._anchor = parent.anchor();\n            if (this._anchor.children) { // is _anchor a div?\n                this._anchor = `#${parent.anchorName()}`;\n            }\n            this._root = parent.root();\n            this._isChild = true;\n        } else if (parent) {\n            if (parent.select && parent.classed) { // detect d3 selection\n                this._anchor = parent.node();\n            } else {\n                this._anchor = parent;\n            }\n            this._root = select(this._anchor);\n            this._root.classed(constants.CHART_CLASS, true);\n            registerChart(this, chartGroup);\n            this._isChild = false;\n        } else {\n            throw new BadArgumentException('parent must be defined');\n        }\n        this._chartGroup = chartGroup;\n        return this;\n    }\n\n    /**\n     * Returns the DOM id for the chart's anchored location.\n     * @returns {String}\n     */\n    anchorName () {\n        const a = this.anchor();\n        if (a && a.id) {\n            return a.id;\n        }\n        if (a && a.replace) {\n            return a.replace('#', '');\n        }\n        return `dc-chart${this.chartID()}`;\n    }\n\n    /**\n     * Returns the root element where a chart resides. Usually it will be the parent div element where\n     * the SVGElement was created. You can also pass in a new root element however this is usually handled by\n     * dc internally. Resetting the root element on a chart outside of dc internals may have\n     * unexpected consequences.\n     * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement HTMLElement}\n     * @param {HTMLElement} [rootElement]\n     * @returns {HTMLElement|BaseMixin}\n     */\n    root (rootElement) {\n        if (!arguments.length) {\n            return this._root;\n        }\n        this._root = rootElement;\n        return this;\n    }\n\n    /**\n     * Returns the top SVGElement for this specific chart. You can also pass in a new SVGElement,\n     * however this is usually handled by dc internally. Resetting the SVGElement on a chart outside\n     * of dc internals may have unexpected consequences.\n     * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/SVGElement SVGElement}\n     * @param {SVGElement|d3.selection} [svgElement]\n     * @returns {SVGElement|d3.selection|BaseMixin}\n     */\n    svg (svgElement) {\n        if (!arguments.length) {\n            return this._svg;\n        }\n        this._svg = svgElement;\n        return this;\n    }\n\n    /**\n     * Remove the chart's SVGElements from the dom and recreate the container SVGElement.\n     * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/SVGElement SVGElement}\n     * @returns {SVGElement}\n     */\n    resetSvg () {\n        this.select('svg').remove();\n        return this.generateSvg();\n    }\n\n    sizeSvg () {\n        if (this._svg) {\n            if (!this._useViewBoxResizing) {\n                this._svg\n                    .attr('width', this.width())\n                    .attr('height', this.height());\n            } else if (!this._svg.attr('viewBox')) {\n                this._svg\n                    .attr('viewBox', `0 0 ${this.width()} ${this.height()}`);\n            }\n        }\n    }\n\n    generateSvg () {\n        this._svg = this.root().append('svg');\n    \n        if (this._svgDescription || this._keyboardAccessible) {\n\n            this._svg.append('desc')\n                .attr('id', `desc-id-${this.__dcFlag__}`)\n                .html(`${this.svgDescription()}`);\n\n            this._svg\n                .attr('tabindex', '0')\n                .attr('role', 'img')\n                .attr('aria-labelledby', `desc-id-${this.__dcFlag__}`);\n        }\n\n        this.sizeSvg();\n        return this._svg;\n    }\n\n    /**\n     * Set or get description text for the entire SVG graphic. If set, will create a `<desc>` element as the first\n     * child of the SVG with the description text and also make the SVG focusable from keyboard.\n     * @param {String} [description]\n     * @returns {String|BaseMixin}\n     */\n    svgDescription (description) {\n        if (!arguments.length) {\n            return this._svgDescription || this.constructor.name;\n        }\n\n        this._svgDescription = description;\n        return this;\n    }\n\n    /**\n     * If set, interactive chart elements like individual bars in a bar chart or symbols in a scatter plot\n     * will be focusable from keyboard and on pressing Enter or Space will behave as if clicked on.\n     * \n     * If `svgDescription` has not been explicitly set, will also set SVG description text to the class\n     * constructor name, like BarChart or HeatMap, and make the entire SVG focusable.\n     * @param {Boolean} [keyboardAccessible=false]\n     * @returns {Boolean|BarChart}\n     */\n    keyboardAccessible (keyboardAccessible) {\n        if (!arguments.length) {\n            return this._keyboardAccessible;\n        }\n        this._keyboardAccessible = keyboardAccessible;\n        return this;\n    }\n\n    /**\n     * Set or get the filter printer function. The filter printer function is used to generate human\n     * friendly text for filter value(s) associated with the chart instance. The text will get shown\n     * in the `.filter element; see {@link BaseMixin#turnOnControls turnOnControls}.\n     *\n     * By default dc charts use a default filter printer {@link printers.filters printers.filters}\n     * that provides simple printing support for both single value and ranged filters.\n     * @example\n     * // for a chart with an ordinal brush, print the filters in upper case\n     * chart.filterPrinter(function(filters) {\n     *   return filters.map(function(f) { return f.toUpperCase(); }).join(', ');\n     * });\n     * // for a chart with a range brush, print the filter as start and extent\n     * chart.filterPrinter(function(filters) {\n     *   return 'start ' + utils.printSingleValue(filters[0][0]) +\n     *     ' extent ' + utils.printSingleValue(filters[0][1] - filters[0][0]);\n     * });\n     * @param {Function} [filterPrinterFunction=printers.filters]\n     * @returns {Function|BaseMixin}\n     */\n    filterPrinter (filterPrinterFunction) {\n        if (!arguments.length) {\n            return this._filterPrinter;\n        }\n        this._filterPrinter = filterPrinterFunction;\n        return this;\n    }\n\n    /**\n     * If set, use the `visibility` attribute instead of the `display` attribute for showing/hiding\n     * chart reset and filter controls, for less disruption to the layout.\n     * @param {Boolean} [controlsUseVisibility=false]\n     * @returns {Boolean|BaseMixin}\n     */\n    controlsUseVisibility (controlsUseVisibility) {\n        if (!arguments.length) {\n            return this._controlsUseVisibility;\n        }\n        this._controlsUseVisibility = controlsUseVisibility;\n        return this;\n    }\n\n    /**\n     * Turn on optional control elements within the root element. dc currently supports the\n     * following html control elements.\n     * * root.selectAll('.reset') - elements are turned on if the chart has an active filter. This type\n     * of control element is usually used to store a reset link to allow user to reset filter on a\n     * certain chart. This element will be turned off automatically if the filter is cleared.\n     * * root.selectAll('.filter') elements are turned on if the chart has an active filter. The text\n     * content of this element is then replaced with the current filter value using the filter printer\n     * function. This type of element will be turned off automatically if the filter is cleared.\n     * @returns {BaseMixin}\n     */\n    turnOnControls () {\n        if (this._root) {\n            const attribute = this.controlsUseVisibility() ? 'visibility' : 'display';\n            this.selectAll('.reset').style(attribute, null);\n            this.selectAll('.filter').text(this._filterPrinter(this.filters())).style(attribute, null);\n        }\n        return this;\n    }\n\n    /**\n     * Turn off optional control elements within the root element.\n     * @see {@link BaseMixin#turnOnControls turnOnControls}\n     * @returns {BaseMixin}\n     */\n    turnOffControls () {\n        if (this._root) {\n            const attribute = this.controlsUseVisibility() ? 'visibility' : 'display';\n            const value = this.controlsUseVisibility() ? 'hidden' : 'none';\n            this.selectAll('.reset').style(attribute, value);\n            this.selectAll('.filter').style(attribute, value).text(this.filter());\n        }\n        return this;\n    }\n\n    /**\n     * Set or get the animation transition duration (in milliseconds) for this chart instance.\n     * @param {Number} [duration=750]\n     * @returns {Number|BaseMixin}\n     */\n    transitionDuration (duration) {\n        if (!arguments.length) {\n            return this._transitionDuration;\n        }\n        this._transitionDuration = duration;\n        return this;\n    }\n\n    /**\n     * Set or get the animation transition delay (in milliseconds) for this chart instance.\n     * @param {Number} [delay=0]\n     * @returns {Number|BaseMixin}\n     */\n    transitionDelay (delay) {\n        if (!arguments.length) {\n            return this._transitionDelay;\n        }\n        this._transitionDelay = delay;\n        return this;\n    }\n\n    _mandatoryAttributes (_) {\n        if (!arguments.length) {\n            return this._mandatoryAttributesList;\n        }\n        this._mandatoryAttributesList = _;\n        return this;\n    }\n\n    checkForMandatoryAttributes (a) {\n        if (!this[a] || !this[a]()) {\n            throw new InvalidStateException(`Mandatory attribute chart.${a} is missing on chart[#${this.anchorName()}]`);\n        }\n    }\n\n    /**\n     * Invoking this method will force the chart to re-render everything from scratch. Generally it\n     * should only be used to render the chart for the first time on the page or if you want to make\n     * sure everything is redrawn from scratch instead of relying on the default incremental redrawing\n     * behaviour.\n     * @returns {BaseMixin}\n     */\n    render () {\n        this._height = this._width = undefined; // force recalculate\n        this._listeners.call('preRender', this, this);\n\n        if (this._mandatoryAttributesList) {\n            this._mandatoryAttributesList.forEach(e => this.checkForMandatoryAttributes(e));\n        }\n\n        const result = this._doRender();\n\n        if (this._legend) {\n            this._legend.render();\n        }\n\n        this._activateRenderlets('postRender');\n\n        return result;\n    }\n\n    _makeKeyboardAccessible (onClickFunction, ...onClickArgs) {\n        // called from each chart module's render and redraw methods\n        const tabElements = this._svg\n            .selectAll('.dc-tabbable')\n            .attr('tabindex', 0);\n                \n        if (onClickFunction) {\n            tabElements.on('keydown', adaptHandler((d, event) => {\n                // trigger only if d is an object undestood by KeyAccessor()\n                if (event.keyCode === 13 && typeof d === 'object') {\n                    onClickFunction.call(this, d, ...onClickArgs)\n                } \n                // special case for space key press - prevent scrolling\n                if (event.keyCode === 32 && typeof d === 'object') {\n                    onClickFunction.call(this, d, ...onClickArgs)\n                    event.preventDefault();                \n                }\n            \n            }));\n        }\n    }\n\n    _activateRenderlets (event) {\n        this._listeners.call('pretransition', this, this);\n        if (this.transitionDuration() > 0 && this._svg) {\n            this._svg.transition().duration(this.transitionDuration()).delay(this.transitionDelay())\n                .on('end', () => {\n                    this._listeners.call('renderlet', this, this);\n                    if (event) {\n                        this._listeners.call(event, this, this);\n                    }\n                });\n        } else {\n            this._listeners.call('renderlet', this, this);\n            if (event) {\n                this._listeners.call(event, this, this);\n            }\n        }\n    }\n\n    /**\n     * Calling redraw will cause the chart to re-render data changes incrementally. If there is no\n     * change in the underlying data dimension then calling this method will have no effect on the\n     * chart. Most chart interaction in dc will automatically trigger this method through internal\n     * events (in particular {@link redrawAll redrawAll}); therefore, you only need to\n     * manually invoke this function if data is manipulated outside of dc's control (for example if\n     * data is loaded in the background using\n     * {@link https://github.com/crossfilter/crossfilter/wiki/API-Reference#crossfilter_add crossfilter.add}).\n     * @returns {BaseMixin}\n     */\n    redraw () {\n        this.sizeSvg();\n        this._listeners.call('preRedraw', this, this);\n\n        const result = this._doRedraw();\n\n        if (this._legend) {\n            this._legend.render();\n        }\n\n        this._activateRenderlets('postRedraw');\n\n        return result;\n    }\n\n    /**\n     * Gets/sets the commit handler. If the chart has a commit handler, the handler will be called when\n     * the chart's filters have changed, in order to send the filter data asynchronously to a server.\n     *\n     * Unlike other functions in dc.js, the commit handler is asynchronous. It takes two arguments:\n     * a flag indicating whether this is a render (true) or a redraw (false), and a callback to be\n     * triggered once the commit is done. The callback has the standard node.js continuation signature\n     * with error first and result second.\n     * @param {Function} commitHandler\n     * @returns {BaseMixin}\n     */\n    commitHandler (commitHandler) {\n        if (!arguments.length) {\n            return this._commitHandler;\n        }\n        this._commitHandler = commitHandler;\n        return this;\n    }\n\n    /**\n     * Redraws all charts in the same group as this chart, typically in reaction to a filter\n     * change. If the chart has a {@link BaseMixin.commitFilter commitHandler}, it will\n     * be executed and waited for.\n     * @returns {BaseMixin}\n     */\n    redrawGroup () {\n        if (this._commitHandler) {\n            this._commitHandler(false, (error, result) => {\n                if (error) {\n                    console.log(error);\n                } else {\n                    redrawAll(this.chartGroup());\n                }\n            });\n        } else {\n            redrawAll(this.chartGroup());\n        }\n        return this;\n    }\n\n    /**\n     * Renders all charts in the same group as this chart. If the chart has a\n     * {@link BaseMixin.commitFilter commitHandler}, it will be executed and waited for\n     * @returns {BaseMixin}\n     */\n    renderGroup () {\n        if (this._commitHandler) {\n            this._commitHandler(false, (error, result) => {\n                if (error) {\n                    console.log(error);\n                } else {\n                    renderAll(this.chartGroup());\n                }\n            });\n        } else {\n            renderAll(this.chartGroup());\n        }\n        return this;\n    }\n\n    _invokeFilteredListener (f) {\n        if (f !== undefined) {\n            this._listeners.call('filtered', this, this, f);\n        }\n    }\n\n    _invokeZoomedListener () {\n        this._listeners.call('zoomed', this, this);\n    }\n\n    /**\n     * Set or get the has-filter handler. The has-filter handler is a function that checks to see if\n     * the chart's current filters (first argument) include a specific filter (second argument).  Using a custom has-filter handler allows\n     * you to change the way filters are checked for and replaced.\n     * @example\n     * // default has-filter handler\n     * chart.hasFilterHandler(function (filters, filter) {\n     *     if (filter === null || typeof(filter) === 'undefined') {\n     *         return filters.length > 0;\n     *     }\n     *     return filters.some(function (f) {\n     *         return filter <= f && filter >= f;\n     *     });\n     * });\n     *\n     * // custom filter handler (no-op)\n     * chart.hasFilterHandler(function(filters, filter) {\n     *     return false;\n     * });\n     * @param {Function} [hasFilterHandler]\n     * @returns {Function|BaseMixin}\n     */\n    hasFilterHandler (hasFilterHandler) {\n        if (!arguments.length) {\n            return this._hasFilterHandler;\n        }\n        this._hasFilterHandler = hasFilterHandler;\n        return this;\n    }\n\n    /**\n     * Check whether any active filter or a specific filter is associated with particular chart instance.\n     * This function is **not chainable**.\n     * @see {@link BaseMixin#hasFilterHandler hasFilterHandler}\n     * @param {*} [filter]\n     * @returns {Boolean}\n     */\n    hasFilter (filter) {\n        return this._hasFilterHandler(this._filters, filter);\n    }\n\n    /**\n     * Set or get the remove filter handler. The remove filter handler is a function that removes a\n     * filter from the chart's current filters. Using a custom remove filter handler allows you to\n     * change how filters are removed or perform additional work when removing a filter, e.g. when\n     * using a filter server other than crossfilter.\n     *\n     * The handler should return a new or modified array as the result.\n     * @example\n     * // default remove filter handler\n     * chart.removeFilterHandler(function (filters, filter) {\n     *     for (var i = 0; i < filters.length; i++) {\n     *         if (filters[i] <= filter && filters[i] >= filter) {\n     *             filters.splice(i, 1);\n     *             break;\n     *         }\n     *     }\n     *     return filters;\n     * });\n     *\n     * // custom filter handler (no-op)\n     * chart.removeFilterHandler(function(filters, filter) {\n     *     return filters;\n     * });\n     * @param {Function} [removeFilterHandler]\n     * @returns {Function|BaseMixin}\n     */\n    removeFilterHandler (removeFilterHandler) {\n        if (!arguments.length) {\n            return this._removeFilterHandler;\n        }\n        this._removeFilterHandler = removeFilterHandler;\n        return this;\n    }\n\n    /**\n     * Set or get the add filter handler. The add filter handler is a function that adds a filter to\n     * the chart's filter list. Using a custom add filter handler allows you to change the way filters\n     * are added or perform additional work when adding a filter, e.g. when using a filter server other\n     * than crossfilter.\n     *\n     * The handler should return a new or modified array as the result.\n     * @example\n     * // default add filter handler\n     * chart.addFilterHandler(function (filters, filter) {\n     *     filters.push(filter);\n     *     return filters;\n     * });\n     *\n     * // custom filter handler (no-op)\n     * chart.addFilterHandler(function(filters, filter) {\n     *     return filters;\n     * });\n     * @param {Function} [addFilterHandler]\n     * @returns {Function|BaseMixin}\n     */\n    addFilterHandler (addFilterHandler) {\n        if (!arguments.length) {\n            return this._addFilterHandler;\n        }\n        this._addFilterHandler = addFilterHandler;\n        return this;\n    }\n\n    /**\n     * Set or get the reset filter handler. The reset filter handler is a function that resets the\n     * chart's filter list by returning a new list. Using a custom reset filter handler allows you to\n     * change the way filters are reset, or perform additional work when resetting the filters,\n     * e.g. when using a filter server other than crossfilter.\n     *\n     * The handler should return a new or modified array as the result.\n     * @example\n     * // default remove filter handler\n     * function (filters) {\n     *     return [];\n     * }\n     *\n     * // custom filter handler (no-op)\n     * chart.resetFilterHandler(function(filters) {\n     *     return filters;\n     * });\n     * @param {Function} [resetFilterHandler]\n     * @returns {BaseMixin}\n     */\n    resetFilterHandler (resetFilterHandler) {\n        if (!arguments.length) {\n            return this._resetFilterHandler;\n        }\n        this._resetFilterHandler = resetFilterHandler;\n        return this;\n    }\n\n    applyFilters (filters) {\n        if (this.dimension() && this.dimension().filter) {\n            const fs = this._filterHandler(this.dimension(), filters);\n            if (fs) {\n                filters = fs;\n            }\n        }\n        return filters;\n    }\n\n    /**\n     * Replace the chart filter. This is equivalent to calling `chart.filter(null).filter(filter)`\n     * but more efficient because the filter is only applied once.\n     *\n     * @param {*} [filter]\n     * @returns {BaseMixin}\n     */\n    replaceFilter (filter) {\n        this._filters = this._resetFilterHandler(this._filters);\n        this.filter(filter);\n        return this;\n    }\n\n    /**\n     * Filter the chart by the given parameter, or return the current filter if no input parameter\n     * is given.\n     *\n     * The filter parameter can take one of these forms:\n     * * A single value: the value will be toggled (added if it is not present in the current\n     * filters, removed if it is present)\n     * * An array containing a single array of values (`[[value,value,value]]`): each value is\n     * toggled\n     * * When appropriate for the chart, a {@link filters dc filter object} such as\n     *   * {@link filters.RangedFilter `filters.RangedFilter`} for the\n     * {@link CoordinateGridMixin CoordinateGridMixin} charts\n     *   * {@link filters.TwoDimensionalFilter `filters.TwoDimensionalFilter`} for the\n     * {@link HeatMap heat map}\n     *   * {@link filters.RangedTwoDimensionalFilter `filters.RangedTwoDimensionalFilter`}\n     * for the {@link ScatterPlot scatter plot}\n     * * `null`: the filter will be reset using the\n     * {@link BaseMixin#resetFilterHandler resetFilterHandler}\n     *\n     * Note that this is always a toggle (even when it doesn't make sense for the filter type). If\n     * you wish to replace the current filter, either call `chart.filter(null)` first - or it's more\n     * efficient to call {@link BaseMixin#replaceFilter `chart.replaceFilter(filter)`} instead.\n     *\n     * Each toggle is executed by checking if the value is already present using the\n     * {@link BaseMixin#hasFilterHandler hasFilterHandler}; if it is not present, it is added\n     * using the {@link BaseMixin#addFilterHandler addFilterHandler}; if it is already present,\n     * it is removed using the {@link BaseMixin#removeFilterHandler removeFilterHandler}.\n     *\n     * Once the filters array has been updated, the filters are applied to the\n     * crossfilter dimension, using the {@link BaseMixin#filterHandler filterHandler}.\n     *\n     * Once you have set the filters, call {@link BaseMixin#redrawGroup `chart.redrawGroup()`}\n     * (or {@link redrawAll `redrawAll()`}) to redraw the chart's group.\n     * @see {@link BaseMixin#addFilterHandler addFilterHandler}\n     * @see {@link BaseMixin#removeFilterHandler removeFilterHandler}\n     * @see {@link BaseMixin#resetFilterHandler resetFilterHandler}\n     * @see {@link BaseMixin#filterHandler filterHandler}\n     * @example\n     * // filter by a single string\n     * chart.filter('Sunday');\n     * // filter by a single age\n     * chart.filter(18);\n     * // filter by a set of states\n     * chart.filter([['MA', 'TX', 'ND', 'WA']]);\n     * // filter by range -- note the use of filters.RangedFilter, which is different\n     * // from the syntax for filtering a crossfilter dimension directly, dimension.filter([15,20])\n     * chart.filter(filters.RangedFilter(15,20));\n     * @param {*} [filter]\n     * @returns {BaseMixin}\n     */\n    filter (filter) {\n        if (!arguments.length) {\n            return this._filters.length > 0 ? this._filters[0] : null;\n        }\n        let filters = this._filters;\n        if (filter instanceof Array && filter[0] instanceof Array && !filter.isFiltered) {\n            // toggle each filter\n            filter[0].forEach(f => {\n                if (this._hasFilterHandler(filters, f)) {\n                    filters = this._removeFilterHandler(filters, f);\n                } else {\n                    filters = this._addFilterHandler(filters, f);\n                }\n            });\n        } else if (filter === null) {\n            filters = this._resetFilterHandler(filters);\n        } else {\n            if (this._hasFilterHandler(filters, filter)) {\n                filters = this._removeFilterHandler(filters, filter);\n            } else {\n                filters = this._addFilterHandler(filters, filter);\n            }\n        }\n        this._filters = this.applyFilters(filters);\n        this._invokeFilteredListener(filter);\n\n        if (this._root !== null && this.hasFilter()) {\n            this.turnOnControls();\n        } else {\n            this.turnOffControls();\n        }\n\n        return this;\n    }\n\n    /**\n     * Returns all current filters. This method does not perform defensive cloning of the internal\n     * filter array before returning, therefore any modification of the returned array will effect the\n     * chart's internal filter storage.\n     * @returns {Array<*>}\n     */\n    filters () {\n        return this._filters;\n    }\n\n    highlightSelected (e) {\n        select(e).classed(constants.SELECTED_CLASS, true);\n        select(e).classed(constants.DESELECTED_CLASS, false);\n    }\n\n    fadeDeselected (e) {\n        select(e).classed(constants.SELECTED_CLASS, false);\n        select(e).classed(constants.DESELECTED_CLASS, true);\n    }\n\n    resetHighlight (e) {\n        select(e).classed(constants.SELECTED_CLASS, false);\n        select(e).classed(constants.DESELECTED_CLASS, false);\n    }\n\n    /**\n     * This function is passed to d3 as the onClick handler for each chart. The default behavior is to\n     * filter on the clicked datum (passed to the callback) and redraw the chart group.\n     *\n     * This function can be replaced in order to change the click behavior (but first look at\n     * @example\n     * var oldHandler = chart.onClick;\n     * chart.onClick = function(datum) {\n     *   // use datum.\n     * @param {*} datum\n     * @return {undefined}\n     */\n    onClick (datum) {\n        const filter = this.keyAccessor()(datum);\n        events.trigger(() => {\n            this.filter(filter);\n            this.redrawGroup();\n        });\n    }\n\n    /**\n     * Set or get the filter handler. The filter handler is a function that performs the filter action\n     * on a specific dimension. Using a custom filter handler allows you to perform additional logic\n     * before or after filtering.\n     * @see {@link https://github.com/crossfilter/crossfilter/wiki/API-Reference#dimension_filter crossfilter.dimension.filter}\n     * @example\n     * // the default filter handler handles all possible cases for the charts in dc.js\n     * // you can replace it with something more specialized for your own chart\n     * chart.filterHandler(function (dimension, filters) {\n     *     if (filters.length === 0) {\n     *         // the empty case (no filtering)\n     *         dimension.filter(null);\n     *     } else if (filters.length === 1 && !filters[0].isFiltered) {\n     *         // single value and not a function-based filter\n     *         dimension.filterExact(filters[0]);\n     *     } else if (filters.length === 1 && filters[0].filterType === 'RangedFilter') {\n     *         // single range-based filter\n     *         dimension.filterRange(filters[0]);\n     *     } else {\n     *         // an array of values, or an array of filter objects\n     *         dimension.filterFunction(function (d) {\n     *             for (var i = 0; i < filters.length; i++) {\n     *                 var filter = filters[i];\n     *                 if (filter.isFiltered && filter.isFiltered(d)) {\n     *                     return true;\n     *                 } else if (filter <= d && filter >= d) {\n     *                     return true;\n     *                 }\n     *             }\n     *             return false;\n     *         });\n     *     }\n     *     return filters;\n     * });\n     *\n     * // custom filter handler\n     * chart.filterHandler(function(dimension, filter){\n     *     var newFilter = filter + 10;\n     *     dimension.filter(newFilter);\n     *     return newFilter; // set the actual filter value to the new value\n     * });\n     * @param {Function} [filterHandler]\n     * @returns {Function|BaseMixin}\n     */\n    filterHandler (filterHandler) {\n        if (!arguments.length) {\n            return this._filterHandler;\n        }\n        this._filterHandler = filterHandler;\n        return this;\n    }\n\n    // abstract function stub\n    _doRender () {\n        // do nothing in base, should be overridden by sub-function\n        return this;\n    }\n\n    _doRedraw () {\n        // do nothing in base, should be overridden by sub-function\n        return this;\n    }\n\n    legendables () {\n        // do nothing in base, should be overridden by sub-function\n        return [];\n    }\n\n    legendHighlight () {\n        // do nothing in base, should be overridden by sub-function\n    }\n\n    legendReset () {\n        // do nothing in base, should be overridden by sub-function\n    }\n\n    legendToggle () {\n        // do nothing in base, should be overriden by sub-function\n    }\n\n    isLegendableHidden () {\n        // do nothing in base, should be overridden by sub-function\n        return false;\n    }\n\n    /**\n     * Set or get the key accessor function. The key accessor function is used to retrieve the key\n     * value from the crossfilter group. Key values are used differently in different charts, for\n     * example keys correspond to slices in a pie chart and x axis positions in a grid coordinate chart.\n     * @example\n     * // default key accessor\n     * chart.keyAccessor(function(d) { return d.key; });\n     * // custom key accessor for a multi-value crossfilter reduction\n     * chart.keyAccessor(function(p) { return p.value.absGain; });\n     * @param {Function} [keyAccessor]\n     * @returns {Function|BaseMixin}\n     */\n    keyAccessor (keyAccessor) {\n        if (!arguments.length) {\n            return this._keyAccessor;\n        }\n        this._keyAccessor = keyAccessor;\n        return this;\n    }\n\n    /**\n     * Set or get the value accessor function. The value accessor function is used to retrieve the\n     * value from the crossfilter group. Group values are used differently in different charts, for\n     * example values correspond to slice sizes in a pie chart and y axis positions in a grid\n     * coordinate chart.\n     * @example\n     * // default value accessor\n     * chart.valueAccessor(function(d) { return d.value; });\n     * // custom value accessor for a multi-value crossfilter reduction\n     * chart.valueAccessor(function(p) { return p.value.percentageGain; });\n     * @param {Function} [valueAccessor]\n     * @returns {Function|BaseMixin}\n     */\n    valueAccessor (valueAccessor) {\n        if (!arguments.length) {\n            return this._valueAccessor;\n        }\n        this._valueAccessor = valueAccessor;\n        return this;\n    }\n\n    /**\n     * Set or get the label function. The chart class will use this function to render labels for each\n     * child element in the chart, e.g. slices in a pie chart or bubbles in a bubble chart. Not every\n     * chart supports the label function, for example line chart does not use this function\n     * at all. By default, enables labels; pass false for the second parameter if this is not desired.\n     * @example\n     * // default label function just return the key\n     * chart.label(function(d) { return d.key; });\n     * // label function has access to the standard d3 data binding and can get quite complicated\n     * chart.label(function(d) { return d.data.key + '(' + Math.floor(d.data.value / all.value() * 100) + '%)'; });\n     * @param {Function} [labelFunction]\n     * @param {Boolean} [enableLabels=true]\n     * @returns {Function|BaseMixin}\n     */\n    label (labelFunction, enableLabels) {\n        if (!arguments.length) {\n            return this._label;\n        }\n        this._label = labelFunction;\n        if ((enableLabels === undefined) || enableLabels) {\n            this._renderLabel = true;\n        }\n        return this;\n    }\n\n    /**\n     * Turn on/off label rendering\n     * @param {Boolean} [renderLabel=false]\n     * @returns {Boolean|BaseMixin}\n     */\n    renderLabel (renderLabel) {\n        if (!arguments.length) {\n            return this._renderLabel;\n        }\n        this._renderLabel = renderLabel;\n        return this;\n    }\n\n    /**\n     * Set or get the title function. The chart class will use this function to render the SVGElement title\n     * (usually interpreted by browser as tooltips) for each child element in the chart, e.g. a slice\n     * in a pie chart or a bubble in a bubble chart. Almost every chart supports the title function;\n     * however in grid coordinate charts you need to turn off the brush in order to see titles, because\n     * otherwise the brush layer will block tooltip triggering.\n     * @example\n     * // default title function shows \"key: value\"\n     * chart.title(function(d) { return d.key + ': ' + d.value; });\n     * // title function has access to the standard d3 data binding and can get quite complicated\n     * chart.title(function(p) {\n     *    return p.key.getFullYear()\n     *        + '\\n'\n     *        + 'Index Gain: ' + numberFormat(p.value.absGain) + '\\n'\n     *        + 'Index Gain in Percentage: ' + numberFormat(p.value.percentageGain) + '%\\n'\n     *        + 'Fluctuation / Index Ratio: ' + numberFormat(p.value.fluctuationPercentage) + '%';\n     * });\n     * @param {Function} [titleFunction]\n     * @returns {Function|BaseMixin}\n     */\n    title (titleFunction) {\n        if (!arguments.length) {\n            return this._title;\n        }\n        this._title = titleFunction;\n        return this;\n    }\n\n    /**\n     * Turn on/off title rendering, or return the state of the render title flag if no arguments are\n     * given.\n     * @param {Boolean} [renderTitle=true]\n     * @returns {Boolean|BaseMixin}\n     */\n    renderTitle (renderTitle) {\n        if (!arguments.length) {\n            return this._renderTitle;\n        }\n        this._renderTitle = renderTitle;\n        return this;\n    }\n\n    /**\n     * Get or set the chart group to which this chart belongs. Chart groups are rendered or redrawn\n     * together since it is expected they share the same underlying crossfilter data set.\n     * @param {String} [chartGroup]\n     * @returns {String|BaseMixin}\n     */\n    chartGroup (chartGroup) {\n        if (!arguments.length) {\n            return this._chartGroup;\n        }\n        if (!this._isChild) {\n            deregisterChart(this, this._chartGroup);\n        }\n        this._chartGroup = chartGroup;\n        if (!this._isChild) {\n            registerChart(this, this._chartGroup);\n        }\n        return this;\n    }\n\n    /**\n     * Expire the internal chart cache. dc charts cache some data internally on a per chart basis to\n     * speed up rendering and avoid unnecessary calculation; however it might be useful to clear the\n     * cache if you have changed state which will affect rendering.  For example, if you invoke\n     * {@link https://github.com/crossfilter/crossfilter/wiki/API-Reference#crossfilter_add crossfilter.add}\n     * function or reset group or dimension after rendering, it is a good idea to\n     * clear the cache to make sure charts are rendered properly.\n     * @returns {BaseMixin}\n     */\n    expireCache () {\n        // do nothing in base, should be overridden by sub-function\n        return this;\n    }\n\n    /**\n     * Attach a Legend widget to this chart. The legend widget will automatically draw legend labels\n     * based on the color setting and names associated with each group.\n     * @example\n     * chart.legend(new Legend().x(400).y(10).itemHeight(13).gap(5))\n     * @param {Legend} [legend]\n     * @returns {Legend|BaseMixin}\n     */\n    legend (legend) {\n        if (!arguments.length) {\n            return this._legend;\n        }\n        this._legend = legend;\n        this._legend.parent(this);\n        return this;\n    }\n\n    /**\n     * Returns the internal numeric ID of the chart.\n     * @returns {String}\n     */\n    chartID () {\n        return this.__dcFlag__;\n    }\n\n    /**\n     * Set chart options using a configuration object. Each key in the object will cause the method of\n     * the same name to be called with the value to set that attribute for the chart.\n     * @example\n     * chart.options({dimension: myDimension, group: myGroup});\n     * @param {{}} opts\n     * @returns {BaseMixin}\n     */\n    options (opts) {\n        const applyOptions = [\n            'anchor',\n            'group',\n            'xAxisLabel',\n            'yAxisLabel',\n            'stack',\n            'title',\n            'point',\n            'getColor',\n            'overlayGeoJson'\n        ];\n\n        for (const o in opts) {\n            if (typeof (this[o]) === 'function') {\n                if (opts[o] instanceof Array && applyOptions.indexOf(o) !== -1) {\n                    this[o].apply(this, opts[o]);\n                } else {\n                    this[o].call(this, opts[o]);\n                }\n            } else {\n                logger.debug(`Not a valid option setter name: ${o}`);\n            }\n        }\n        return this;\n    }\n\n    /**\n     * All dc chart instance supports the following listeners.\n     * Supports the following events:\n     * * `renderlet` - This listener function will be invoked after transitions after redraw and render. Replaces the\n     * deprecated {@link BaseMixin#renderlet renderlet} method.\n     * * `pretransition` - Like `.on('renderlet', ...)` but the event is fired before transitions start.\n     * * `preRender` - This listener function will be invoked before chart rendering.\n     * * `postRender` - This listener function will be invoked after chart finish rendering including\n     * all renderlets' logic.\n     * * `preRedraw` - This listener function will be invoked before chart redrawing.\n     * * `postRedraw` - This listener function will be invoked after chart finish redrawing\n     * including all renderlets' logic.\n     * * `filtered` - This listener function will be invoked after a filter is applied, added or removed.\n     * * `zoomed` - This listener function will be invoked after a zoom is triggered.\n     * @see {@link https://github.com/d3/d3-dispatch/blob/master/README.md#dispatch_on d3.dispatch.on}\n     * @example\n     * .on('renderlet', function(chart, filter){...})\n     * .on('pretransition', function(chart, filter){...})\n     * .on('preRender', function(chart){...})\n     * .on('postRender', function(chart){...})\n     * .on('preRedraw', function(chart){...})\n     * .on('postRedraw', function(chart){...})\n     * .on('filtered', function(chart, filter){...})\n     * .on('zoomed', function(chart, filter){...})\n     * @param {String} event\n     * @param {Function} listener\n     * @returns {BaseMixin}\n     */\n    on (event, listener) {\n        this._listeners.on(event, listener);\n        return this;\n    }\n\n    /**\n     * A renderlet is similar to an event listener on rendering event. Multiple renderlets can be added\n     * to an individual chart.  Each time a chart is rerendered or redrawn the renderlets are invoked\n     * right after the chart finishes its transitions, giving you a way to modify the SVGElements.\n     * Renderlet functions take the chart instance as the only input parameter and you can\n     * use the dc API or use raw d3 to achieve pretty much any effect.\n     *\n     * Use {@link BaseMixin#on on} with a 'renderlet' prefix.\n     * Generates a random key for the renderlet, which makes it hard to remove.\n     * @deprecated chart.renderlet has been deprecated. Please use chart.on(\"renderlet.<renderletKey>\", renderletFunction)\n     * @example\n     * // do this instead of .renderlet(function(chart) { ... })\n     * chart.on(\"renderlet\", function(chart){\n     *     // mix of dc API and d3 manipulation\n     *     chart.select('g.y').style('display', 'none');\n     *     // its a closure so you can also access other chart variable available in the closure scope\n     *     moveChart.filter(chart.filter());\n     * });\n     * @param {Function} renderletFunction\n     * @returns {BaseMixin}\n     */\n    renderlet (renderletFunction) {\n        logger.warnOnce('chart.renderlet has been deprecated. Please use chart.on(\"renderlet.<renderletKey>\", renderletFunction)');\n        this.on(`renderlet.${utils.uniqueId()}`, renderletFunction);\n        return this;\n    }\n}\n\nexport const baseMixin = () => new BaseMixin();\n","import {scaleLinear, scaleOrdinal, scaleQuantize} from 'd3-scale';\nimport {interpolateHcl} from 'd3-interpolate';\nimport {max, min} from 'd3-array';\n\nimport {config} from '../core/config';\nimport {utils} from '../core/utils';\n\n/**\n * The Color Mixin is an abstract chart functional class providing universal coloring support\n * as a mix-in for any concrete chart implementation.\n * @mixin ColorMixin\n * @param {Object} Base\n * @returns {ColorMixin}\n */\nexport const ColorMixin = Base => class extends Base {\n    constructor () {\n        super();\n\n        this._colors = scaleOrdinal(config.defaultColors());\n\n        this._colorAccessor = d => this.keyAccessor()(d);\n        this._colorCalculator = undefined;\n\n        {\n            const chart = this;\n            // ES6: this method is called very differently from stack-mixin and derived charts\n            // Removing and placing it as a member method is tricky\n\n            /**\n                 * Get the color for the datum d and counter i. This is used internally by charts to retrieve a color.\n                 * @method getColor\n                 * @memberof ColorMixin\n                 * @instance\n                 * @param {*} d\n                 * @param {Number} [i]\n                 * @returns {String}\n                 */\n            chart.getColor = function (d, i) {\n                return chart._colorCalculator ?\n                    chart._colorCalculator.call(this, d, i) :\n                    chart._colors(chart._colorAccessor.call(this, d, i));\n            };\n        }\n    }\n\n    /**\n         * Set the domain by determining the min and max values as retrieved by\n         * {@link ColorMixin#colorAccessor .colorAccessor} over the chart's dataset.\n         * @memberof ColorMixin\n         * @instance\n         * @returns {ColorMixin}\n         */\n    calculateColorDomain () {\n        const newDomain = [min(this.data(), this.colorAccessor()),\n                           max(this.data(), this.colorAccessor())];\n        this._colors.domain(newDomain);\n        return this;\n    }\n\n    /**\n         * Retrieve current color scale or set a new color scale. This methods accepts any function that\n         * operates like a d3 scale.\n         * @memberof ColorMixin\n         * @instance\n         * @see {@link https://github.com/d3/d3-scale/blob/master/README.md d3.scale}\n         * @example\n         * // alternate categorical scale\n         * chart.colors(d3.scale.category20b());\n         * // ordinal scale\n         * chart.colors(d3.scaleOrdinal().range(['red','green','blue']));\n         * // convenience method, the same as above\n         * chart.ordinalColors(['red','green','blue']);\n         * // set a linear scale\n         * chart.linearColors([\"#4575b4\", \"#ffffbf\", \"#a50026\"]);\n         * @param {d3.scale} [colorScale=d3.scaleOrdinal(d3.schemeCategory20c)]\n         * @returns {d3.scale|ColorMixin}\n         */\n    colors (colorScale) {\n        if (!arguments.length) {\n            return this._colors;\n        }\n        if (colorScale instanceof Array) {\n            this._colors = scaleQuantize().range(colorScale); // deprecated legacy support, note: this fails for ordinal domains\n        } else {\n            this._colors = typeof colorScale === 'function' ? colorScale : utils.constant(colorScale);\n        }\n        return this;\n    }\n\n    /**\n         * Convenience method to set the color scale to\n         * {@link https://github.com/d3/d3-scale/blob/master/README.md#ordinal-scales d3.scaleOrdinal} with\n         * range `r`.\n         * @memberof ColorMixin\n         * @instance\n         * @param {Array<String>} r\n         * @returns {ColorMixin}\n         */\n    ordinalColors (r) {\n        return this.colors(scaleOrdinal().range(r));\n    }\n\n    /**\n         * Convenience method to set the color scale to an Hcl interpolated linear scale with range `r`.\n         * @memberof ColorMixin\n         * @instance\n         * @param {Array<Number>} r\n         * @returns {ColorMixin}\n         */\n    linearColors (r) {\n        return this.colors(scaleLinear()\n                .range(r)\n                .interpolate(interpolateHcl));\n    }\n\n    /**\n         * Set or the get color accessor function. This function will be used to map a data point in a\n         * crossfilter group to a color value on the color scale. The default function uses the key\n         * accessor.\n         * @memberof ColorMixin\n         * @instance\n         * @example\n         * // default index based color accessor\n         * .colorAccessor(function (d, i){return i;})\n         * // color accessor for a multi-value crossfilter reduction\n         * .colorAccessor(function (d){return d.value.absGain;})\n         * @param {Function} [colorAccessor]\n         * @returns {Function|ColorMixin}\n         */\n    colorAccessor (colorAccessor) {\n        if (!arguments.length) {\n            return this._colorAccessor;\n        }\n        this._colorAccessor = colorAccessor;\n        return this;\n    }\n\n    /**\n         * Set or get the current domain for the color mapping function. The domain must be supplied as an\n         * array.\n         *\n         * Note: previously this method accepted a callback function. Instead you may use a custom scale\n         * set by {@link ColorMixin#colors .colors}.\n         * @memberof ColorMixin\n         * @instance\n         * @param {Array<String>} [domain]\n         * @returns {Array<String>|ColorMixin}\n         */\n    colorDomain (domain) {\n        if (!arguments.length) {\n            return this._colors.domain();\n        }\n        this._colors.domain(domain);\n        return this;\n    }\n\n    /**\n         * Overrides the color selection algorithm, replacing it with a simple function.\n         *\n         * Normally colors will be determined by calling the `colorAccessor` to get a value, and then passing that\n         * value through the `colorScale`.\n         *\n         * But sometimes it is difficult to get a color scale to produce the desired effect. The `colorCalculator`\n         * takes the datum and index and returns a color directly.\n         * @memberof ColorMixin\n         * @instance\n         * @param {*} [colorCalculator]\n         * @returns {Function|ColorMixin}\n         */\n    colorCalculator (colorCalculator) {\n        if (!arguments.length) {\n            return this._colorCalculator || this.getColor;\n        }\n        this._colorCalculator = colorCalculator;\n        return this;\n    }\n};\n","import { ascending, descending, min, max } from 'd3-array';\nimport { scaleLinear } from 'd3-scale';\n\nimport {ColorMixin} from './color-mixin';\nimport {transition} from '../core/core';\nimport {events} from '../core/events';\nimport {adaptHandler} from '../core/d3compat';\n\n/**\n * This Mixin provides reusable functionalities for any chart that needs to visualize data using bubbles.\n * @mixin BubbleMixin\n * @mixes ColorMixin\n * @param {Object} Base\n * @returns {BubbleMixin}\n */\nexport const BubbleMixin = Base => class extends ColorMixin(Base) {\n    constructor () {\n        super();\n\n        this._maxBubbleRelativeSize = 0.3;\n        this._minRadiusWithLabel = 10;\n        this._sortBubbleSize = false;\n        this._elasticRadius = false;\n        this._excludeElasticZero = true;\n\n        // These cane be used by derived classes as well, so member status\n        this.BUBBLE_NODE_CLASS = 'node';\n        this.BUBBLE_CLASS = 'bubble';\n        this.MIN_RADIUS = 10;\n\n        this.renderLabel(true);\n\n        this.data(group => {\n            const data = group.all();\n\n            if (this._keyboardAccessible) {\n                // sort based on the x value (key)\n                data.sort((a, b) => ascending(this.keyAccessor()(a), this.keyAccessor()(b)));\n            }\n\n            if (this._sortBubbleSize) {\n                // sort descending so smaller bubbles are on top\n                const radiusAccessor = this.radiusValueAccessor();\n                data.sort((a, b) => descending(radiusAccessor(a), radiusAccessor(b)));\n            }\n            return data;\n        });\n\n        this._r = scaleLinear().domain([0, 100]);\n    }\n\n    _rValueAccessor (d) {\n        return d.r;\n    }\n\n    /**\n         * Get or set the bubble radius scale. By default the bubble chart uses\n         * {@link https://github.com/d3/d3-scale/blob/master/README.md#scaleLinear d3.scaleLinear().domain([0, 100])}\n         * as its radius scale.\n         * @memberof BubbleMixin\n         * @instance\n         * @see {@link https://github.com/d3/d3-scale/blob/master/README.md d3.scale}\n         * @param {d3.scale} [bubbleRadiusScale=d3.scaleLinear().domain([0, 100])]\n         * @returns {d3.scale|BubbleMixin}\n         */\n    r (bubbleRadiusScale) {\n        if (!arguments.length) {\n            return this._r;\n        }\n        this._r = bubbleRadiusScale;\n        return this;\n    }\n\n    /**\n         * Turn on or off the elastic bubble radius feature, or return the value of the flag. If this\n         * feature is turned on, then bubble radii will be automatically rescaled to fit the chart better.\n         * @memberof BubbleMixin\n         * @instance\n         * @param {Boolean} [elasticRadius=false]\n         * @returns {Boolean|BubbleChart}\n         */\n    elasticRadius (elasticRadius) {\n        if (!arguments.length) {\n            return this._elasticRadius;\n        }\n        this._elasticRadius = elasticRadius;\n        return this;\n    }\n\n    calculateRadiusDomain () {\n        if (this._elasticRadius) {\n            this.r().domain([this.rMin(), this.rMax()]);\n        }\n    }\n\n    /**\n         * Get or set the radius value accessor function. If set, the radius value accessor function will\n         * be used to retrieve a data value for each bubble. The data retrieved then will be mapped using\n         * the r scale to the actual bubble radius. This allows you to encode a data dimension using bubble\n         * size.\n         * @memberof BubbleMixin\n         * @instance\n         * @param {Function} [radiusValueAccessor]\n         * @returns {Function|BubbleMixin}\n         */\n    radiusValueAccessor (radiusValueAccessor) {\n        if (!arguments.length) {\n            return this._rValueAccessor;\n        }\n        this._rValueAccessor = radiusValueAccessor;\n        return this;\n    }\n\n    rMin () {\n        let values = this.data().map(this.radiusValueAccessor());\n        if(this._excludeElasticZero) {\n            values = values.filter(value => value > 0);\n        }\n        return min(values);\n    }\n\n    rMax () {\n        return max(this.data(), e => this.radiusValueAccessor()(e));\n    }\n\n    bubbleR (d) {\n        const value = this.radiusValueAccessor()(d);\n        let r = this.r()(value);\n        if (isNaN(r) || value <= 0) {\n            r = 0;\n        }\n        return r;\n    }\n\n    _labelFunction (d) {\n        return this.label()(d);\n    }\n\n    _shouldLabel (d) {\n        return (this.bubbleR(d) > this._minRadiusWithLabel);\n    }\n\n    _labelOpacity (d) {\n        return this._shouldLabel(d) ? 1 : 0;\n    }\n\n    _labelPointerEvent (d) {\n        return this._shouldLabel(d) ? 'all' : 'none';\n    }\n\n    _doRenderLabel (bubbleGEnter) {\n        if (this.renderLabel()) {\n            let label = bubbleGEnter.select('text');\n\n            if (label.empty()) {\n                label = bubbleGEnter.append('text')\n                        .attr('text-anchor', 'middle')\n                        .attr('dy', '.3em')\n                        .on('click', adaptHandler(d => this.onClick(d)));\n            }\n\n            label\n                    .attr('opacity', 0)\n                    .attr('pointer-events', d => this._labelPointerEvent(d))\n                    .text(d => this._labelFunction(d));\n            transition(label, this.transitionDuration(), this.transitionDelay())\n                    .attr('opacity', d => this._labelOpacity(d));\n        }\n    }\n\n    doUpdateLabels (bubbleGEnter) {\n        if (this.renderLabel()) {\n            const labels = bubbleGEnter.select('text')\n                    .attr('pointer-events', d => this._labelPointerEvent(d))\n                    .text(d => this._labelFunction(d));\n            transition(labels, this.transitionDuration(), this.transitionDelay())\n                    .attr('opacity', d => this._labelOpacity(d));\n        }\n    }\n\n    _titleFunction (d) {\n        return this.title()(d);\n    }\n\n    _doRenderTitles (g) {\n        if (this.renderTitle()) {\n            const title = g.select('title');\n\n            if (title.empty()) {\n                g.append('title').text(d => this._titleFunction(d));\n            }\n        }\n    }\n\n    doUpdateTitles (g) {\n        if (this.renderTitle()) {\n            g.select('title').text(d => this._titleFunction(d));\n        }\n    }\n\n    /**\n         * Turn on or off the bubble sorting feature, or return the value of the flag. If enabled,\n         * bubbles will be sorted by their radius, with smaller bubbles in front.\n         * @memberof BubbleChart\n         * @instance\n         * @param {Boolean} [sortBubbleSize=false]\n         * @returns {Boolean|BubbleChart}\n         */\n    sortBubbleSize (sortBubbleSize) {\n        if (!arguments.length) {\n            return this._sortBubbleSize;\n        }\n        this._sortBubbleSize = sortBubbleSize;\n        return this;\n    }\n\n    /**\n         * Get or set the minimum radius. This will be used to initialize the radius scale's range.\n         * @memberof BubbleMixin\n         * @instance\n         * @param {Number} [radius=10]\n         * @returns {Number|BubbleMixin}\n         */\n    minRadius (radius) {\n        if (!arguments.length) {\n            return this.MIN_RADIUS;\n        }\n        this.MIN_RADIUS = radius;\n        return this;\n    }\n\n    /**\n         * Get or set the minimum radius for label rendering. If a bubble's radius is less than this value\n         * then no label will be rendered.\n         * @memberof BubbleMixin\n         * @instance\n         * @param {Number} [radius=10]\n         * @returns {Number|BubbleMixin}\n         */\n\n    minRadiusWithLabel (radius) {\n        if (!arguments.length) {\n            return this._minRadiusWithLabel;\n        }\n        this._minRadiusWithLabel = radius;\n        return this;\n    }\n\n    /**\n         * Get or set the maximum relative size of a bubble to the length of x axis. This value is useful\n         * when the difference in radius between bubbles is too great.\n         * @memberof BubbleMixin\n         * @instance\n         * @param {Number} [relativeSize=0.3]\n         * @returns {Number|BubbleMixin}\n         */\n    maxBubbleRelativeSize (relativeSize) {\n        if (!arguments.length) {\n            return this._maxBubbleRelativeSize;\n        }\n        this._maxBubbleRelativeSize = relativeSize;\n        return this;\n    }\n\n    /**\n     * Should the chart exclude zero when calculating elastic bubble radius?\n     * @memberof BubbleMixin\n     * @instance\n     * @param  {Boolean} [excludeZero=true]\n     * @returns {Boolean|BubbleMixin}\n     */\n    excludeElasticZero (excludeZero) {\n        if (!arguments.length) {\n            return this._excludeElasticZero;\n        }\n        this._excludeElasticZero = excludeZero;\n        return this;\n    }\n\n    fadeDeselectedArea (selection) {\n        if (this.hasFilter()) {\n            const chart = this;\n            this.selectAll(`g.${chart.BUBBLE_NODE_CLASS}`).each(function (d) {\n                if (chart.isSelectedNode(d)) {\n                    chart.highlightSelected(this);\n                } else {\n                    chart.fadeDeselected(this);\n                }\n            });\n        } else {\n            const chart = this;\n            this.selectAll(`g.${chart.BUBBLE_NODE_CLASS}`).each(function () {\n                chart.resetHighlight(this);\n            });\n        }\n    }\n\n    isSelectedNode (d) {\n        return this.hasFilter(d.key);\n    }\n\n    onClick (d) {\n        const filter = d.key;\n        events.trigger(() => {\n            this.filter(filter);\n            this.redrawGroup();\n        });\n    }\n};\n","import {sum} from 'd3-array';\n\n/**\n * Cap is a mixin that groups small data elements below a _cap_ into an *others* grouping for both the\n * Row and Pie Charts.\n *\n * The top ordered elements in the group up to the cap amount will be kept in the chart, and the rest\n * will be replaced with an *others* element, with value equal to the sum of the replaced values. The\n * keys of the elements below the cap limit are recorded in order to filter by those keys when the\n * others* element is clicked.\n * @mixin CapMixin\n * @param {Object} Base\n * @returns {CapMixin}\n */\nexport const CapMixin = Base => class extends Base {\n    constructor () {\n        super();\n\n        this._cap = Infinity;\n        this._takeFront = true;\n        this._othersLabel = 'Others';\n\n        this._othersGrouper = (topItems, restItems) => {\n            const restItemsSum = sum(restItems, this.valueAccessor()),\n                restKeys = restItems.map(this.keyAccessor());\n            if (restItemsSum > 0) {\n                return topItems.concat([{\n                    others: restKeys,\n                    key: this.othersLabel(),\n                    value: restItemsSum\n                }]);\n            }\n            return topItems;\n        };\n\n        // emulate old group.top(N) ordering\n        this.ordering(kv => -kv.value);\n\n        // return N \"top\" groups, where N is the cap, sorted by baseMixin.ordering\n        // whether top means front or back depends on takeFront\n        this.data(group => {\n            if (this._cap === Infinity) {\n                return this._computeOrderedGroups(group.all());\n            } else {\n                let items = group.all(), rest;\n                items = this._computeOrderedGroups(items); // sort by baseMixin.ordering\n\n                if (this._cap) {\n                    if (this._takeFront) {\n                        rest = items.slice(this._cap);\n                        items = items.slice(0, this._cap);\n                    } else {\n                        const start = Math.max(0, items.length - this._cap);\n                        rest = items.slice(0, start);\n                        items = items.slice(start);\n                    }\n                }\n\n                if (this._othersGrouper) {\n                    return this._othersGrouper(items, rest);\n                }\n                return items;\n            }\n        });\n    }\n\n    cappedKeyAccessor (d, i) {\n        if (d.others) {\n            return d.key;\n        }\n        return this.keyAccessor()(d, i);\n    }\n\n    cappedValueAccessor (d, i) {\n        if (d.others) {\n            return d.value;\n        }\n        return this.valueAccessor()(d, i);\n    }\n\n    /**\n         * Get or set the count of elements to that will be included in the cap. If there is an\n         * {@link CapMixin#othersGrouper othersGrouper}, any further elements will be combined in an\n         * extra element with its name determined by {@link CapMixin#othersLabel othersLabel}.\n         *\n         * As of dc.js 2.1 and onward, the capped charts use\n         * {@link https://github.com/crossfilter/crossfilter/wiki/API-Reference#group_all group.all()}\n         * and {@link BaseMixin#ordering BaseMixin.ordering()} to determine the order of\n         * elements. Then `cap` and {@link CapMixin#takeFront takeFront} determine how many elements\n         * to keep, from which end of the resulting array.\n         *\n         * **Migration note:** Up through dc.js 2.0.*, capping used\n         * {@link https://github.com/crossfilter/crossfilter/wiki/API-Reference#group_top group.top(N)},\n         * which selects the largest items according to\n         * {@link https://github.com/crossfilter/crossfilter/wiki/API-Reference#group_order group.order()}.\n         * The chart then sorted the items according to {@link BaseMixin#ordering baseMixin.ordering()}.\n         * So the two values essentially had to agree, but if the `group.order()` was incorrect (it's\n         * easy to forget about), the wrong rows or slices would be displayed, in the correct order.\n         *\n         * If your chart previously relied on `group.order()`, use `chart.ordering()` instead. As of\n         * 2.1.5, the ordering defaults to sorting from greatest to least like `group.top(N)` did.\n         *\n         * If you want to cap by one ordering but sort by another, you can still do this by\n         * specifying your own {@link BaseMixin#data `.data()`} callback. For details, see the example\n         * {@link https://dc-js.github.io/dc.js/examples/cap-and-sort-differently.html Cap and Sort Differently}.\n         * @memberof CapMixin\n         * @instance\n         * @param {Number} [count=Infinity]\n         * @returns {Number|CapMixin}\n         */\n    cap (count) {\n        if (!arguments.length) {\n            return this._cap;\n        }\n        this._cap = count;\n        return this;\n    }\n\n    /**\n         * Get or set the direction of capping. If set, the chart takes the first\n         * {@link CapMixin#cap cap} elements from the sorted array of elements; otherwise\n         * it takes the last `cap` elements.\n         * @memberof CapMixin\n         * @instance\n         * @param {Boolean} [takeFront=true]\n         * @returns {Boolean|CapMixin}\n         */\n    takeFront (takeFront) {\n        if (!arguments.length) {\n            return this._takeFront;\n        }\n        this._takeFront = takeFront;\n        return this;\n    }\n\n    /**\n         * Get or set the label for *Others* slice when slices cap is specified.\n         * @memberof CapMixin\n         * @instance\n         * @param {String} [label=\"Others\"]\n         * @returns {String|CapMixin}\n         */\n    othersLabel (label) {\n        if (!arguments.length) {\n            return this._othersLabel;\n        }\n        this._othersLabel = label;\n        return this;\n    }\n\n    /**\n         * Get or set the grouper function that will perform the insertion of data for the *Others* slice\n         * if the slices cap is specified. If set to a falsy value, no others will be added.\n         *\n         * The grouper function takes an array of included (\"top\") items, and an array of the rest of\n         * the items. By default the grouper function computes the sum of the rest.\n         * @memberof CapMixin\n         * @instance\n         * @example\n         * // Do not show others\n         * chart.othersGrouper(null);\n         * // Default others grouper\n         * chart.othersGrouper(function (topItems, restItems) {\n         *     var restItemsSum = d3.sum(restItems, _chart.valueAccessor()),\n         *         restKeys = restItems.map(_chart.keyAccessor());\n         *     if (restItemsSum > 0) {\n         *         return topItems.concat([{\n         *             others: restKeys,\n         *             key: _chart.othersLabel(),\n         *             value: restItemsSum\n         *         }]);\n         *     }\n         *     return topItems;\n         * });\n         * @param {Function} [grouperFunction]\n         * @returns {Function|CapMixin}\n         */\n    othersGrouper (grouperFunction) {\n        if (!arguments.length) {\n            return this._othersGrouper;\n        }\n        this._othersGrouper = grouperFunction;\n        return this;\n    }\n\n    onClick (d) {\n        if (d.others) {\n            this.filter([d.others]);\n        }\n        super.onClick(d);\n    }\n};\n","import {BaseMixin} from './base-mixin';\n\n/**\n * Margin is a mixin that provides margin utility functions for both the Row Chart and Coordinate Grid\n * Charts.\n * @mixin MarginMixin\n * @param {Object} Base\n * @returns {MarginMixin}\n */\nexport class MarginMixin extends BaseMixin {\n    constructor () {\n        super();\n\n        this._margin = {top: 10, right: 50, bottom: 30, left: 30};\n    }\n\n    /**\n     * Get or set the margins for a particular coordinate grid chart instance. The margins is stored as\n     * an associative Javascript array.\n     * @memberof MarginMixin\n     * @instance\n     * @example\n     * var leftMargin = chart.margins().left; // 30 by default\n     * chart.margins().left = 50;\n     * leftMargin = chart.margins().left; // now 50\n     * @param {{top: Number, right: Number, left: Number, bottom: Number}} [margins={top: 10, right: 50, bottom: 30, left: 30}]\n     * @returns {{top: Number, right: Number, left: Number, bottom: Number}|MarginMixin}\n     */\n    margins (margins) {\n        if (!arguments.length) {\n            return this._margin;\n        }\n        this._margin = margins;\n        return this;\n    }\n\n    /**\n     * Effective width of the chart excluding margins (in pixels).\n     *\n     * @returns {number}\n     */\n    effectiveWidth () {\n        return this.width() - this.margins().left - this.margins().right;\n    }\n\n    /**\n     * Effective height of the chart excluding margins (in pixels).\n     *\n     * @returns {number}\n     */\n    effectiveHeight () {\n        return this.height() - this.margins().top - this.margins().bottom;\n    }\n}\n","import {schemeCategory10} from 'd3-scale-chromatic';\nimport {timeDay} from 'd3-time';\nimport {max, min} from 'd3-array';\nimport {scaleBand, scaleLinear, scaleOrdinal} from 'd3-scale';\nimport {axisBottom, axisLeft, axisRight} from 'd3-axis';\nimport {zoom, zoomIdentity} from 'd3-zoom';\nimport {brushX} from 'd3-brush';\n\nimport {ColorMixin} from './color-mixin';\nimport {MarginMixin} from './margin-mixin';\nimport {optionalTransition, transition} from '../core/core';\nimport {units} from '../core/units';\nimport {constants} from '../core/constants';\nimport {utils} from '../core/utils';\nimport {adaptHandler} from '../core/d3compat';\nimport {logger} from '../core/logger';\nimport {filters} from '../core/filters';\nimport {events} from '../core/events';\n\nconst GRID_LINE_CLASS = 'grid-line';\nconst HORIZONTAL_CLASS = 'horizontal';\nconst VERTICAL_CLASS = 'vertical';\nconst Y_AXIS_LABEL_CLASS = 'y-axis-label';\nconst X_AXIS_LABEL_CLASS = 'x-axis-label';\nconst CUSTOM_BRUSH_HANDLE_CLASS = 'custom-brush-handle';\nconst DEFAULT_AXIS_LABEL_PADDING = 12;\n\n/**\n * Coordinate Grid is an abstract base chart designed to support a number of coordinate grid based\n * concrete chart types, e.g. bar chart, line chart, and bubble chart.\n * @mixin CoordinateGridMixin\n * @mixes ColorMixin\n * @mixes MarginMixin\n */\nexport class CoordinateGridMixin extends ColorMixin(MarginMixin) {\n    constructor () {\n        super();\n\n        this.colors(scaleOrdinal(schemeCategory10));\n        this._mandatoryAttributes().push('x');\n        this._parent = undefined;\n        this._g = undefined;\n        this._chartBodyG = undefined;\n\n        this._x = undefined;\n        this._origX = undefined; // Will hold original scale in case of zoom\n        this._xOriginalDomain = undefined;\n        this._xAxis = axisBottom();\n        this._xUnits = units.integers;\n        this._xAxisPadding = 0;\n        this._xAxisPaddingUnit = timeDay;\n        this._xElasticity = false;\n        this._xAxisLabel = undefined;\n        this._xAxisLabelPadding = 0;\n        this._lastXDomain = undefined;\n\n        this._y = undefined;\n        this._yAxis = null;\n        this._yAxisPadding = 0;\n        this._yElasticity = false;\n        this._yAxisLabel = undefined;\n        this._yAxisLabelPadding = 0;\n\n        this._brush = brushX();\n\n        this._gBrush = undefined;\n        this._brushOn = true;\n        this._parentBrushOn = false;\n        this._round = undefined;\n        this._ignoreBrushEvents = false; // ignore when carrying out programmatic brush operations\n\n        this._renderHorizontalGridLine = false;\n        this._renderVerticalGridLine = false;\n\n        this._resizing = false;\n        this._unitCount = undefined;\n\n        this._zoomScale = [1, Infinity];\n        this._zoomOutRestrict = true;\n\n        this._zoom = zoom().on('zoom', adaptHandler((d, evt) => this._onZoom(evt)));\n        this._nullZoom = zoom().on('zoom', null);\n        this._hasBeenMouseZoomable = false;\n        this._ignoreZoomEvents = false; // ignore when carrying out programmatic zoom operations\n\n        this._rangeChart = undefined;\n        this._focusChart = undefined;\n\n        this._mouseZoomable = false;\n        this._clipPadding = 0;\n\n        this._fOuterRangeBandPadding = 0.5;\n        this._fRangeBandPadding = 0;\n\n        this._useRightYAxis = false;\n    }\n\n    /**\n     * When changing the domain of the x or y scale, it is necessary to tell the chart to recalculate\n     * and redraw the axes. (`.rescale()` is called automatically when the x or y scale is replaced\n     * with {@link CoordinateGridMixin+x .x()} or {@link CoordinateGridMixin#y .y()}, and has\n     * no effect on elastic scales.)\n     * @returns {CoordinateGridMixin}\n     */\n    rescale () {\n        this._unitCount = undefined;\n        this._resizing = true;\n        return this;\n    }\n\n    resizing (resizing) {\n        if (!arguments.length) {\n            return this._resizing;\n        }\n        this._resizing = resizing;\n        return this;\n    }\n\n    /**\n     * Get or set the range selection chart associated with this instance. Setting the range selection\n     * chart using this function will automatically update its selection brush when the current chart\n     * zooms in. In return the given range chart will also automatically attach this chart as its focus\n     * chart hence zoom in when range brush updates.\n     *\n     * Usually the range and focus charts will share a dimension. The range chart will set the zoom\n     * boundaries for the focus chart, so its dimension values must be compatible with the domain of\n     * the focus chart.\n     *\n     * See the [Nasdaq 100 Index](http://dc-js.github.com/dc.js/) example for this effect in action.\n     * @param {CoordinateGridMixin} [rangeChart]\n     * @returns {CoordinateGridMixin}\n     */\n    rangeChart (rangeChart) {\n        if (!arguments.length) {\n            return this._rangeChart;\n        }\n        this._rangeChart = rangeChart;\n        this._rangeChart.focusChart(this);\n        return this;\n    }\n\n    /**\n     * Get or set the scale extent for mouse zooms.\n     * @param {Array<Number|Date>} [extent=[1, Infinity]]\n     * @returns {Array<Number|Date>|CoordinateGridMixin}\n     */\n    zoomScale (extent) {\n        if (!arguments.length) {\n            return this._zoomScale;\n        }\n        this._zoomScale = extent;\n        return this;\n    }\n\n    /**\n     * Get or set the zoom restriction for the chart. If true limits the zoom to origional domain of the chart.\n     * @param {Boolean} [zoomOutRestrict=true]\n     * @returns {Boolean|CoordinateGridMixin}\n     */\n    zoomOutRestrict (zoomOutRestrict) {\n        if (!arguments.length) {\n            return this._zoomOutRestrict;\n        }\n        this._zoomOutRestrict = zoomOutRestrict;\n        return this;\n    }\n\n    _generateG (parent) {\n        if (parent === undefined) {\n            this._parent = this.svg();\n        } else {\n            this._parent = parent;\n        }\n\n        const href = window.location.href.split('#')[0];\n\n        this._g = this._parent.append('g');\n\n        this._chartBodyG = this._g.append('g').attr('class', 'chart-body')\n            .attr('transform', `translate(${this.margins().left}, ${this.margins().top})`)\n            .attr('clip-path', `url(${href}#${this._getClipPathId()})`);\n\n        return this._g;\n    }\n\n    /**\n     * Get or set the root g element. This method is usually used to retrieve the g element in order to\n     * overlay custom svg drawing programatically. **Caution**: The root g element is usually generated\n     * by dc.js internals, and resetting it might produce unpredictable result.\n     * @param {SVGElement} [gElement]\n     * @returns {SVGElement|CoordinateGridMixin}\n     */\n    g (gElement) {\n        if (!arguments.length) {\n            return this._g;\n        }\n        this._g = gElement;\n        return this;\n    }\n\n    /**\n     * Set or get mouse zoom capability flag (default: false). When turned on the chart will be\n     * zoomable using the mouse wheel. If the range selector chart is attached zooming will also update\n     * the range selection brush on the associated range selector chart.\n     * @param {Boolean} [mouseZoomable=false]\n     * @returns {Boolean|CoordinateGridMixin}\n     */\n    mouseZoomable (mouseZoomable) {\n        if (!arguments.length) {\n            return this._mouseZoomable;\n        }\n        this._mouseZoomable = mouseZoomable;\n        return this;\n    }\n\n    /**\n     * Retrieve the svg group for the chart body.\n     * @param {SVGElement} [chartBodyG]\n     * @returns {SVGElement}\n     */\n    chartBodyG (chartBodyG) {\n        if (!arguments.length) {\n            return this._chartBodyG;\n        }\n        this._chartBodyG = chartBodyG;\n        return this;\n    }\n\n    /**\n     * **mandatory**\n     *\n     * Get or set the x scale. The x scale can be any d3\n     * {@link https://github.com/d3/d3-scale/blob/master/README.md d3.scale} or\n     * {@link https://github.com/d3/d3-scale/blob/master/README.md#ordinal-scales ordinal scale}\n     * @see {@link https://github.com/d3/d3-scale/blob/master/README.md d3.scale}\n     * @example\n     * // set x to a linear scale\n     * chart.x(d3.scaleLinear().domain([-2500, 2500]))\n     * // set x to a time scale to generate histogram\n     * chart.x(d3.scaleTime().domain([new Date(1985, 0, 1), new Date(2012, 11, 31)]))\n     * @param {d3.scale} [xScale]\n     * @returns {d3.scale|CoordinateGridMixin}\n     */\n    x (xScale) {\n        if (!arguments.length) {\n            return this._x;\n        }\n        this._x = xScale;\n        this._xOriginalDomain = this._x.domain();\n        this.rescale();\n        return this;\n    }\n\n    xOriginalDomain () {\n        return this._xOriginalDomain;\n    }\n\n    /**\n     * Set or get the xUnits function. The coordinate grid chart uses the xUnits function to calculate\n     * the number of data projections on the x axis such as the number of bars for a bar chart or the\n     * number of dots for a line chart.\n     *\n     * This function is expected to return a Javascript array of all data points on the x axis, or\n     * the number of points on the axis. d3 time range functions [d3.timeDays, d3.timeMonths, and\n     * d3.timeYears](https://github.com/d3/d3-time/blob/master/README.md#intervals) are all valid\n     * xUnits functions.\n     *\n     * dc.js also provides a few units function, see the {@link units Units Namespace} for\n     * a list of built-in units functions.\n     *\n     * Note that as of dc.js 3.0, `units.ordinal` is not a real function, because it is not\n     * possible to define this function compliant with the d3 range functions. It was already a\n     * magic value which caused charts to behave differently, and now it is completely so.\n     * @example\n     * // set x units to count days\n     * chart.xUnits(d3.timeDays);\n     * // set x units to count months\n     * chart.xUnits(d3.timeMonths);\n     *\n     * // A custom xUnits function can be used as long as it follows the following interface:\n     * // units in integer\n     * function(start, end) {\n     *      // simply calculates how many integers in the domain\n     *      return Math.abs(end - start);\n     * }\n     *\n     * // fixed units\n     * function(start, end) {\n     *      // be aware using fixed units will disable the focus/zoom ability on the chart\n     *      return 1000;\n     * }\n     * @param {Function} [xUnits=units.integers]\n     * @returns {Function|CoordinateGridMixin}\n     */\n    xUnits (xUnits) {\n        if (!arguments.length) {\n            return this._xUnits;\n        }\n        this._xUnits = xUnits;\n        return this;\n    }\n\n    /**\n     * Set or get the x axis used by a particular coordinate grid chart instance. This function is most\n     * useful when x axis customization is required. The x axis in dc.js is an instance of a\n     * {@link https://github.com/d3/d3-axis/blob/master/README.md#axisBottom d3 bottom axis object};\n     * therefore it supports any valid d3 axisBottom manipulation.\n     *\n     * **Caution**: The x axis is usually generated internally by dc; resetting it may cause\n     * unexpected results. Note also that when used as a getter, this function is not chainable:\n     * it returns the axis, not the chart,\n     * {@link https://github.com/dc-js/dc.js/wiki/FAQ#why-does-everything-break-after-a-call-to-xaxis-or-yaxis\n         * so attempting to call chart functions after calling `.xAxis()` will fail}.\n     * @see {@link https://github.com/d3/d3-axis/blob/master/README.md#axisBottom d3.axisBottom}\n     * @example\n     * // customize x axis tick format\n     * chart.xAxis().tickFormat(function(v) {return v + '%';});\n     * // customize x axis tick values\n     * chart.xAxis().tickValues([0, 100, 200, 300]);\n     * @param {d3.axis} [xAxis=d3.axisBottom()]\n     * @returns {d3.axis|CoordinateGridMixin}\n     */\n    xAxis (xAxis) {\n        if (!arguments.length) {\n            return this._xAxis;\n        }\n        this._xAxis = xAxis;\n        return this;\n    }\n\n    /**\n     * Turn on/off elastic x axis behavior. If x axis elasticity is turned on, then the grid chart will\n     * attempt to recalculate the x axis range whenever a redraw event is triggered.\n     * @param {Boolean} [elasticX=false]\n     * @returns {Boolean|CoordinateGridMixin}\n     */\n    elasticX (elasticX) {\n        if (!arguments.length) {\n            return this._xElasticity;\n        }\n        this._xElasticity = elasticX;\n        return this;\n    }\n\n    /**\n     * Set or get x axis padding for the elastic x axis. The padding will be added to both end of the x\n     * axis if elasticX is turned on; otherwise it is ignored.\n     *\n     * Padding can be an integer or percentage in string (e.g. '10%'). Padding can be applied to\n     * number or date x axes.  When padding a date axis, an integer represents number of units being padded\n     * and a percentage string will be treated the same as an integer. The unit will be determined by the\n     * xAxisPaddingUnit variable.\n     * @param {Number|String} [padding=0]\n     * @returns {Number|String|CoordinateGridMixin}\n     */\n    xAxisPadding (padding) {\n        if (!arguments.length) {\n            return this._xAxisPadding;\n        }\n        this._xAxisPadding = padding;\n        return this;\n    }\n\n    /**\n     * Set or get x axis padding unit for the elastic x axis. The padding unit will determine which unit to\n     * use when applying xAxis padding if elasticX is turned on and if x-axis uses a time dimension;\n     * otherwise it is ignored.\n     *\n     * The padding unit should be a\n     * [d3 time interval](https://github.com/d3/d3-time/blob/master/README.md#self._interval).\n     * For backward compatibility with dc.js 2.0, it can also be the name of a d3 time interval\n     * ('day', 'hour', etc). Available arguments are the\n     * [d3 time intervals](https://github.com/d3/d3-time/blob/master/README.md#intervals d3.timeInterval).\n     * @param {String} [unit=d3.timeDay]\n     * @returns {String|CoordinateGridMixin}\n     */\n    xAxisPaddingUnit (unit) {\n        if (!arguments.length) {\n            return this._xAxisPaddingUnit;\n        }\n        this._xAxisPaddingUnit = unit;\n        return this;\n    }\n\n    /**\n     * Returns the number of units displayed on the x axis. If the x axis is ordinal (`xUnits` is\n     * `units.ordinal`), this is the number of items in the domain of the x scale. Otherwise, the\n     * x unit count is calculated using the {@link CoordinateGridMixin#xUnits xUnits} function.\n     * @returns {Number}\n     */\n    xUnitCount () {\n        if (this._unitCount === undefined) {\n            if (this.isOrdinal()) {\n                // In this case it number of items in domain\n                this._unitCount = this.x().domain().length;\n            } else {\n                this._unitCount = this.xUnits()(this.x().domain()[0], this.x().domain()[1]);\n\n                // Sometimes xUnits() may return an array while sometimes directly the count\n                if (this._unitCount instanceof Array) {\n                    this._unitCount = this._unitCount.length;\n                }\n            }\n        }\n\n        return this._unitCount;\n    }\n\n    /**\n     * Gets or sets whether the chart should be drawn with a right axis instead of a left axis. When\n     * used with a chart in a composite chart, allows both left and right Y axes to be shown on a\n     * chart.\n     * @param {Boolean} [useRightYAxis=false]\n     * @returns {Boolean|CoordinateGridMixin}\n     */\n    useRightYAxis (useRightYAxis) {\n        if (!arguments.length) {\n            return this._useRightYAxis;\n        }\n\n        // We need to warn if value is changing after self._yAxis was created\n        if (this._useRightYAxis !== useRightYAxis && this._yAxis) {\n            logger.warn('Value of useRightYAxis has been altered, after yAxis was created. ' +\n                'You might get unexpected yAxis behavior. ' +\n                'Make calls to useRightYAxis sooner in your chart creation process.');\n        }\n\n        this._useRightYAxis = useRightYAxis;\n        return this;\n    }\n\n    /**\n     * Returns true if the chart is using ordinal xUnits ({@link units.ordinal units.ordinal}, or false\n     * otherwise. Most charts behave differently with ordinal data and use the result of this method to\n     * trigger the appropriate logic.\n     * @returns {Boolean}\n     */\n    isOrdinal () {\n        return this.xUnits() === units.ordinal;\n    }\n\n    _useOuterPadding () {\n        return true;\n    }\n\n    _ordinalXDomain () {\n        const groups = this._computeOrderedGroups(this.data());\n        return groups.map(this.keyAccessor());\n    }\n\n    _prepareXAxis (g, render) {\n        if (!this.isOrdinal()) {\n            if (this.elasticX()) {\n                this._x.domain([this.xAxisMin(), this.xAxisMax()]);\n            }\n        } else { // self._chart.isOrdinal()\n            // D3v4 - Ordinal charts would need scaleBand\n            // bandwidth is a method in scaleBand\n            // (https://github.com/d3/d3-scale/blob/master/README.md#scaleBand)\n            if (!this._x.bandwidth) {\n                // If self._x is not a scaleBand create a new scale and\n                // copy the original domain to the new scale\n                logger.warn('For compatibility with d3v4+, dc.js d3.0 ordinal bar/line/bubble charts need ' +\n                    'd3.scaleBand() for the x scale, instead of d3.scaleOrdinal(). ' +\n                    'Replacing .x() with a d3.scaleBand with the same domain - ' +\n                    'make the same change in your code to avoid this warning!');\n                this._x = scaleBand().domain(this._x.domain());\n            }\n\n            if (this.elasticX() || this._x.domain().length === 0) {\n                this._x.domain(this._ordinalXDomain());\n            }\n        }\n\n        // has the domain changed?\n        const xdom = this._x.domain();\n        if (render || !utils.arraysEqual(this._lastXDomain, xdom)) {\n            this.rescale();\n        }\n        this._lastXDomain = xdom;\n\n        // please can't we always use rangeBands for bar charts?\n        if (this.isOrdinal()) {\n            this._x.range([0, this.xAxisLength()])\n                .paddingInner(this._fRangeBandPadding)\n                .paddingOuter(this._useOuterPadding() ? this._fOuterRangeBandPadding : 0);\n        } else {\n            this._x.range([0, this.xAxisLength()]);\n        }\n\n        this._xAxis = this._xAxis.scale(this.x());\n\n        this._renderVerticalGridLines(g);\n    }\n\n    renderXAxis (g) {\n        let axisXG = g.select('g.x');\n\n        if (axisXG.empty()) {\n            axisXG = g.append('g')\n                .attr('class', 'axis x')\n                .attr('transform', `translate(${this.margins().left},${this._xAxisY()})`);\n        }\n\n        let axisXLab = g.select(`text.${X_AXIS_LABEL_CLASS}`);\n        if (axisXLab.empty() && this.xAxisLabel()) {\n            axisXLab = g.append('text')\n                .attr('class', X_AXIS_LABEL_CLASS)\n                .attr('transform', `translate(${this.margins().left + this.xAxisLength() / 2},${ \n                    this.height() - this._xAxisLabelPadding})`)\n                .attr('text-anchor', 'middle');\n        }\n        if (this.xAxisLabel() && axisXLab.text() !== this.xAxisLabel()) {\n            axisXLab.text(this.xAxisLabel());\n        }\n\n        transition(axisXG, this.transitionDuration(), this.transitionDelay())\n            .attr('transform', `translate(${this.margins().left},${this._xAxisY()})`)\n            .call(this._xAxis);\n        transition(axisXLab, this.transitionDuration(), this.transitionDelay())\n            .attr('transform', `translate(${this.margins().left + this.xAxisLength() / 2},${ \n                this.height() - this._xAxisLabelPadding})`);\n    }\n\n    _renderVerticalGridLines (g) {\n        let gridLineG = g.select(`g.${VERTICAL_CLASS}`);\n\n        if (this._renderVerticalGridLine) {\n            if (gridLineG.empty()) {\n                gridLineG = g.insert('g', ':first-child')\n                    .attr('class', `${GRID_LINE_CLASS} ${VERTICAL_CLASS}`)\n                    .attr('transform', `translate(${this.margins().left},${this.margins().top})`);\n            }\n\n            const ticks = this._xAxis.tickValues() ? this._xAxis.tickValues() :\n                (typeof this._x.ticks === 'function' ? this._x.ticks.apply(this._x, this._xAxis.tickArguments()) : this._x.domain());\n\n            const lines = gridLineG.selectAll('line')\n                .data(ticks);\n\n            // enter\n            const linesGEnter = lines.enter()\n                .append('line')\n                .attr('x1', d => this._x(d))\n                .attr('y1', this._xAxisY() - this.margins().top)\n                .attr('x2', d => this._x(d))\n                .attr('y2', 0)\n                .attr('opacity', 0);\n            transition(linesGEnter, this.transitionDuration(), this.transitionDelay())\n                .attr('opacity', 0.5);\n\n            // update\n            transition(lines, this.transitionDuration(), this.transitionDelay())\n                .attr('x1', d => this._x(d))\n                .attr('y1', this._xAxisY() - this.margins().top)\n                .attr('x2', d => this._x(d))\n                .attr('y2', 0);\n\n            // exit\n            lines.exit().remove();\n        } else {\n            gridLineG.selectAll('line').remove();\n        }\n    }\n\n    _xAxisY () {\n        return (this.height() - this.margins().bottom);\n    }\n\n    xAxisLength () {\n        return this.effectiveWidth();\n    }\n\n    /**\n     * Set or get the x axis label. If setting the label, you may optionally include additional padding to\n     * the margin to make room for the label. By default the padded is set to 12 to accomodate the text height.\n     * @param {String} [labelText]\n     * @param {Number} [padding=12]\n     * @returns {String}\n     */\n    xAxisLabel (labelText, padding) {\n        if (!arguments.length) {\n            return this._xAxisLabel;\n        }\n        this._xAxisLabel = labelText;\n        this.margins().bottom -= this._xAxisLabelPadding;\n        this._xAxisLabelPadding = (padding === undefined) ? DEFAULT_AXIS_LABEL_PADDING : padding;\n        this.margins().bottom += this._xAxisLabelPadding;\n        return this;\n    }\n\n    _createYAxis () {\n        return this._useRightYAxis ? axisRight() : axisLeft();\n    }\n\n    _prepareYAxis (g) {\n        if (this._y === undefined || this.elasticY()) {\n            if (this._y === undefined) {\n                this._y = scaleLinear();\n            }\n            const _min = this.yAxisMin() || 0;\n            const _max = this.yAxisMax() || 0;\n            this._y.domain([_min, _max]).rangeRound([this.yAxisHeight(), 0]);\n        }\n\n        this._y.range([this.yAxisHeight(), 0]);\n\n        if (!this._yAxis) {\n            this._yAxis = this._createYAxis();\n        }\n\n        this._yAxis.scale(this._y);\n\n        this._renderHorizontalGridLinesForAxis(g, this._y, this._yAxis);\n    }\n\n    renderYAxisLabel (axisClass, text, rotation, labelXPosition) {\n        labelXPosition = labelXPosition || this._yAxisLabelPadding;\n\n        let axisYLab = this.g().select(`text.${Y_AXIS_LABEL_CLASS}.${axisClass}-label`);\n        const labelYPosition = (this.margins().top + this.yAxisHeight() / 2);\n        if (axisYLab.empty() && text) {\n            axisYLab = this.g().append('text')\n                .attr('transform', `translate(${labelXPosition},${labelYPosition}),rotate(${rotation})`)\n                .attr('class', `${Y_AXIS_LABEL_CLASS} ${axisClass}-label`)\n                .attr('text-anchor', 'middle')\n                .text(text);\n        }\n        if (text && axisYLab.text() !== text) {\n            axisYLab.text(text);\n        }\n        transition(axisYLab, this.transitionDuration(), this.transitionDelay())\n            .attr('transform', `translate(${labelXPosition},${labelYPosition}),rotate(${rotation})`);\n    }\n\n    renderYAxisAt (axisClass, axis, position) {\n        let axisYG = this.g().select(`g.${axisClass}`);\n        if (axisYG.empty()) {\n            axisYG = this.g().append('g')\n                .attr('class', `axis ${axisClass}`)\n                .attr('transform', `translate(${position},${this.margins().top})`);\n        }\n\n        transition(axisYG, this.transitionDuration(), this.transitionDelay())\n            .attr('transform', `translate(${position},${this.margins().top})`)\n            .call(axis);\n    }\n\n    renderYAxis () {\n        const axisPosition = this._useRightYAxis ? (this.width() - this.margins().right) : this._yAxisX();\n        this.renderYAxisAt('y', this._yAxis, axisPosition);\n        const labelPosition = this._useRightYAxis ? (this.width() - this._yAxisLabelPadding) : this._yAxisLabelPadding;\n        const rotation = this._useRightYAxis ? 90 : -90;\n        this.renderYAxisLabel('y', this.yAxisLabel(), rotation, labelPosition);\n    }\n\n    _renderHorizontalGridLinesForAxis (g, scale, axis) {\n        let gridLineG = g.select(`g.${HORIZONTAL_CLASS}`);\n\n        if (this._renderHorizontalGridLine) {\n            // see https://github.com/d3/d3-axis/blob/master/src/axis.js#L48\n            const ticks = axis.tickValues() ? axis.tickValues() :\n                (scale.ticks ? scale.ticks.apply(scale, axis.tickArguments()) : scale.domain());\n\n            if (gridLineG.empty()) {\n                gridLineG = g.insert('g', ':first-child')\n                    .attr('class', `${GRID_LINE_CLASS} ${HORIZONTAL_CLASS}`)\n                    .attr('transform', `translate(${this.margins().left},${this.margins().top})`);\n            }\n\n            const lines = gridLineG.selectAll('line')\n                .data(ticks);\n\n            // enter\n            const linesGEnter = lines.enter()\n                .append('line')\n                .attr('x1', 1)\n                .attr('y1', d => scale(d))\n                .attr('x2', this.xAxisLength())\n                .attr('y2', d => scale(d))\n                .attr('opacity', 0);\n            transition(linesGEnter, this.transitionDuration(), this.transitionDelay())\n                .attr('opacity', 0.5);\n\n            // update\n            transition(lines, this.transitionDuration(), this.transitionDelay())\n                .attr('x1', 1)\n                .attr('y1', d => scale(d))\n                .attr('x2', this.xAxisLength())\n                .attr('y2', d => scale(d));\n\n            // exit\n            lines.exit().remove();\n        } else {\n            gridLineG.selectAll('line').remove();\n        }\n    }\n\n    _yAxisX () {\n        return this.useRightYAxis() ? this.width() - this.margins().right : this.margins().left;\n    }\n\n    /**\n     * Set or get the y axis label. If setting the label, you may optionally include additional padding\n     * to the margin to make room for the label. By default the padding is set to 12 to accommodate the\n     * text height.\n     * @param {String} [labelText]\n     * @param {Number} [padding=12]\n     * @returns {String|CoordinateGridMixin}\n     */\n    yAxisLabel (labelText, padding) {\n        if (!arguments.length) {\n            return this._yAxisLabel;\n        }\n        this._yAxisLabel = labelText;\n        this.margins().left -= this._yAxisLabelPadding;\n        this._yAxisLabelPadding = (padding === undefined) ? DEFAULT_AXIS_LABEL_PADDING : padding;\n        this.margins().left += this._yAxisLabelPadding;\n        return this;\n    }\n\n    /**\n     * Get or set the y scale. The y scale is typically automatically determined by the chart implementation.\n     * @see {@link https://github.com/d3/d3-scale/blob/master/README.md d3.scale}\n     * @param {d3.scale} [yScale]\n     * @returns {d3.scale|CoordinateGridMixin}\n     */\n    y (yScale) {\n        if (!arguments.length) {\n            return this._y;\n        }\n        this._y = yScale;\n        this.rescale();\n        return this;\n    }\n\n    /**\n     * Set or get the y axis used by the coordinate grid chart instance. This function is most useful\n     * when y axis customization is required. Depending on `useRightYAxis` the y axis in dc.js is an instance of\n     * either [d3.axisLeft](https://github.com/d3/d3-axis/blob/master/README.md#axisLeft) or\n     * [d3.axisRight](https://github.com/d3/d3-axis/blob/master/README.md#axisRight); therefore it supports any\n     * valid d3 axis manipulation.\n     *\n     * **Caution**: The y axis is usually generated internally by dc; resetting it may cause\n     * unexpected results.  Note also that when used as a getter, this function is not chainable: it\n     * returns the axis, not the chart,\n     * {@link https://github.com/dc-js/dc.js/wiki/FAQ#why-does-everything-break-after-a-call-to-xaxis-or-yaxis\n         * so attempting to call chart functions after calling `.yAxis()` will fail}.\n     * In addition, depending on whether you are going to use the axis on left or right\n     * you need to appropriately pass [d3.axisLeft](https://github.com/d3/d3-axis/blob/master/README.md#axisLeft)\n     * or [d3.axisRight](https://github.com/d3/d3-axis/blob/master/README.md#axisRight)\n     * @see {@link https://github.com/d3/d3-axis/blob/master/README.md d3.axis}\n     * @example\n     * // customize y axis tick format\n     * chart.yAxis().tickFormat(function(v) {return v + '%';});\n     * // customize y axis tick values\n     * chart.yAxis().tickValues([0, 100, 200, 300]);\n     * @param {d3.axisLeft|d3.axisRight} [yAxis]\n     * @returns {d3.axisLeft|d3.axisRight|CoordinateGridMixin}\n     */\n    yAxis (yAxis) {\n        if (!arguments.length) {\n            if (!this._yAxis) {\n                this._yAxis = this._createYAxis();\n            }\n            return this._yAxis;\n        }\n        this._yAxis = yAxis;\n        return this;\n    }\n\n    /**\n     * Turn on/off elastic y axis behavior. If y axis elasticity is turned on, then the grid chart will\n     * attempt to recalculate the y axis range whenever a redraw event is triggered.\n     * @param {Boolean} [elasticY=false]\n     * @returns {Boolean|CoordinateGridMixin}\n     */\n    elasticY (elasticY) {\n        if (!arguments.length) {\n            return this._yElasticity;\n        }\n        this._yElasticity = elasticY;\n        return this;\n    }\n\n    /**\n     * Turn on/off horizontal grid lines.\n     * @param {Boolean} [renderHorizontalGridLines=false]\n     * @returns {Boolean|CoordinateGridMixin}\n     */\n    renderHorizontalGridLines (renderHorizontalGridLines) {\n        if (!arguments.length) {\n            return this._renderHorizontalGridLine;\n        }\n        this._renderHorizontalGridLine = renderHorizontalGridLines;\n        return this;\n    }\n\n    /**\n     * Turn on/off vertical grid lines.\n     * @param {Boolean} [renderVerticalGridLines=false]\n     * @returns {Boolean|CoordinateGridMixin}\n     */\n    renderVerticalGridLines (renderVerticalGridLines) {\n        if (!arguments.length) {\n            return this._renderVerticalGridLine;\n        }\n        this._renderVerticalGridLine = renderVerticalGridLines;\n        return this;\n    }\n\n    /**\n     * Calculates the minimum x value to display in the chart. Includes xAxisPadding if set.\n     * @returns {*}\n     */\n    xAxisMin () {\n        const m = min(this.data(), e => this.keyAccessor()(e));\n        return utils.subtract(m, this._xAxisPadding, this._xAxisPaddingUnit);\n    }\n\n    /**\n     * Calculates the maximum x value to display in the chart. Includes xAxisPadding if set.\n     * @returns {*}\n     */\n    xAxisMax () {\n        const m = max(this.data(), e => this.keyAccessor()(e));\n        return utils.add(m, this._xAxisPadding, this._xAxisPaddingUnit);\n    }\n\n    /**\n     * Calculates the minimum y value to display in the chart. Includes yAxisPadding if set.\n     * @returns {*}\n     */\n    yAxisMin () {\n        const m = min(this.data(), e => this.valueAccessor()(e));\n        return utils.subtract(m, this._yAxisPadding);\n    }\n\n    /**\n     * Calculates the maximum y value to display in the chart. Includes yAxisPadding if set.\n     * @returns {*}\n     */\n    yAxisMax () {\n        const m = max(this.data(), e => this.valueAccessor()(e));\n        return utils.add(m, this._yAxisPadding);\n    }\n\n    /**\n     * Set or get y axis padding for the elastic y axis. The padding will be added to the top and\n     * bottom of the y axis if elasticY is turned on; otherwise it is ignored.\n     *\n     * Padding can be an integer or percentage in string (e.g. '10%'). Padding can be applied to\n     * number or date axes. When padding a date axis, an integer represents number of days being padded\n     * and a percentage string will be treated the same as an integer.\n     * @param {Number|String} [padding=0]\n     * @returns {Number|CoordinateGridMixin}\n     */\n    yAxisPadding (padding) {\n        if (!arguments.length) {\n            return this._yAxisPadding;\n        }\n        this._yAxisPadding = padding;\n        return this;\n    }\n\n    yAxisHeight () {\n        return this.effectiveHeight();\n    }\n\n    /**\n     * Set or get the rounding function used to quantize the selection when brushing is enabled.\n     * @example\n     * // set x unit round to by month, this will make sure range selection brush will\n     * // select whole months\n     * chart.round(d3.timeMonth.round);\n     * @param {Function} [round]\n     * @returns {Function|CoordinateGridMixin}\n     */\n    round (round) {\n        if (!arguments.length) {\n            return this._round;\n        }\n        this._round = round;\n        return this;\n    }\n\n    _rangeBandPadding (_) {\n        if (!arguments.length) {\n            return this._fRangeBandPadding;\n        }\n        this._fRangeBandPadding = _;\n        return this;\n    }\n\n    _outerRangeBandPadding (_) {\n        if (!arguments.length) {\n            return this._fOuterRangeBandPadding;\n        }\n        this._fOuterRangeBandPadding = _;\n        return this;\n    }\n\n    filter (_) {\n        if (!arguments.length) {\n            return super.filter();\n        }\n\n        super.filter(_);\n\n        this.redrawBrush(_, false);\n\n        return this;\n    }\n\n    /**\n     * Get or set the brush. Brush must be an instance of d3 brushes\n     * https://github.com/d3/d3-brush/blob/master/README.md\n     * You will use this only if you are writing a new chart type that supports brushing.\n     *\n     * **Caution**: dc creates and manages brushes internally. Go through and understand the source code\n     * if you want to pass a new brush object. Even if you are only using the getter,\n     * the brush object may not behave the way you expect.\n     *\n     * @param {d3.brush} [_]\n     * @returns {d3.brush|CoordinateGridMixin}\n     */\n    brush (_) {\n        if (!arguments.length) {\n            return this._brush;\n        }\n        this._brush = _;\n        return this;\n    }\n\n    renderBrush (g, doTransition) {\n        if (this._brushOn) {\n            this._brush.on('start brush end', adaptHandler((d, evt) => this._brushing(evt)));\n\n            // To retrieve selection we need self._gBrush\n            this._gBrush = g.append('g')\n                .attr('class', 'brush')\n                .attr('transform', `translate(${this.margins().left},${this.margins().top})`);\n\n            this.setBrushExtents();\n\n            this.createBrushHandlePaths(this._gBrush, doTransition);\n\n            this.redrawBrush(this.filter(), doTransition);\n        }\n    }\n\n    createBrushHandlePaths (gBrush) {\n        let brushHandles = gBrush.selectAll(`path.${CUSTOM_BRUSH_HANDLE_CLASS}`).data([{type: 'w'}, {type: 'e'}]);\n\n        brushHandles = brushHandles\n            .enter()\n            .append('path')\n            .attr('class', CUSTOM_BRUSH_HANDLE_CLASS)\n            .merge(brushHandles);\n\n        brushHandles\n            .attr('d', d => this.resizeHandlePath(d));\n    }\n\n    extendBrush (brushSelection) {\n        if (brushSelection && this.round()) {\n            brushSelection[0] = this.round()(brushSelection[0]);\n            brushSelection[1] = this.round()(brushSelection[1]);\n        }\n        return brushSelection;\n    }\n\n    brushIsEmpty (brushSelection) {\n        return !brushSelection || brushSelection[1] <= brushSelection[0];\n    }\n\n    _brushing (evt) {\n        if (this._ignoreBrushEvents) {\n            return;\n        }\n\n        let brushSelection = evt.selection;\n        if (brushSelection) {\n            brushSelection = brushSelection.map(this.x().invert);\n        }\n\n        brushSelection = this.extendBrush(brushSelection);\n\n        this.redrawBrush(brushSelection, false);\n\n        const rangedFilter = this.brushIsEmpty(brushSelection) ? null : filters.RangedFilter(brushSelection[0], brushSelection[1]);\n\n        events.trigger(() => {\n            this.applyBrushSelection(rangedFilter);\n        }, constants.EVENT_DELAY);\n    }\n\n    // This can be overridden in a derived chart. For example Composite chart overrides it\n    applyBrushSelection (rangedFilter) {\n        this.replaceFilter(rangedFilter);\n        this.redrawGroup();\n    }\n\n    _withoutBrushEvents (closure) {\n        const oldValue = this._ignoreBrushEvents;\n        this._ignoreBrushEvents = true;\n\n        try {\n            closure();\n        } finally {\n            this._ignoreBrushEvents = oldValue;\n        }\n    }\n\n    setBrushExtents (doTransition) {\n        this._withoutBrushEvents(() => {\n            // Set boundaries of the brush, must set it before applying to self._gBrush\n            this._brush.extent([[0, 0], [this.effectiveWidth(), this.effectiveHeight()]]);\n        });\n\n        this._gBrush\n            .call(this._brush);\n    }\n\n    redrawBrush (brushSelection, doTransition) {\n        if (this._brushOn && this._gBrush) {\n            if (this._resizing) {\n                this.setBrushExtents(doTransition);\n            }\n\n            if (!brushSelection) {\n                this._withoutBrushEvents(() => {\n                    this._gBrush\n                        .call(this._brush.move, null);\n                })\n\n                this._gBrush.selectAll(`path.${CUSTOM_BRUSH_HANDLE_CLASS}`)\n                    .attr('display', 'none');\n            } else {\n                const scaledSelection = [this._x(brushSelection[0]), this._x(brushSelection[1])];\n\n                const gBrush =\n                    optionalTransition(doTransition, this.transitionDuration(), this.transitionDelay())(this._gBrush);\n\n                this._withoutBrushEvents(() => {\n                    gBrush\n                        .call(this._brush.move, scaledSelection);\n                });\n\n                gBrush.selectAll(`path.${CUSTOM_BRUSH_HANDLE_CLASS}`)\n                    .attr('display', null)\n                    .attr('transform', (d, i) => `translate(${this._x(brushSelection[i])}, 0)`)\n                    .attr('d', d => this.resizeHandlePath(d));\n            }\n        }\n        this.fadeDeselectedArea(brushSelection);\n    }\n\n    fadeDeselectedArea (brushSelection) {\n        // do nothing, sub-chart should override this function\n    }\n\n    // borrowed from Crossfilter example\n    resizeHandlePath (d) {\n        d = d.type;\n        const e = +(d === 'e'), x = e ? 1 : -1, y = this.effectiveHeight() / 3;\n        return `M${0.5 * x},${y \n        }A6,6 0 0 ${e} ${6.5 * x},${y + 6 \n        }V${2 * y - 6 \n        }A6,6 0 0 ${e} ${0.5 * x},${2 * y \n        }Z` +\n            `M${2.5 * x},${y + 8 \n            }V${2 * y - 8 \n            }M${4.5 * x},${y + 8 \n            }V${2 * y - 8}`;\n    }\n\n    _getClipPathId () {\n        return `${this.anchorName().replace(/[ .#=\\[\\]\"]/g, '-')}-clip`;\n    }\n\n    /**\n     * Get or set the padding in pixels for the clip path. Once set padding will be applied evenly to\n     * the top, left, right, and bottom when the clip path is generated. If set to zero, the clip area\n     * will be exactly the chart body area minus the margins.\n     * @param {Number} [padding=5]\n     * @returns {Number|CoordinateGridMixin}\n     */\n    clipPadding (padding) {\n        if (!arguments.length) {\n            return this._clipPadding;\n        }\n        this._clipPadding = padding;\n        return this;\n    }\n\n    _generateClipPath () {\n        const defs = utils.appendOrSelect(this._parent, 'defs');\n        // cannot select <clippath> elements; bug in WebKit, must select by id\n        // https://groups.google.com/forum/#!topic/d3-js/6EpAzQ2gU9I\n        const id = this._getClipPathId();\n        const chartBodyClip = utils.appendOrSelect(defs, `#${id}`, 'clipPath').attr('id', id);\n\n        const padding = this._clipPadding * 2;\n\n        utils.appendOrSelect(chartBodyClip, 'rect')\n            .attr('width', this.xAxisLength() + padding)\n            .attr('height', this.yAxisHeight() + padding)\n            .attr('transform', `translate(-${this._clipPadding}, -${this._clipPadding})`);\n    }\n\n    _preprocessData () {\n    }\n\n    _doRender () {\n        this.resetSvg();\n\n        this._preprocessData();\n\n        this._generateG();\n        this._generateClipPath();\n\n        this._drawChart(true);\n\n        this._configureMouseZoom();\n\n        return this;\n    }\n\n    _doRedraw () {\n        this._preprocessData();\n\n        this._drawChart(false);\n        this._generateClipPath();\n\n        return this;\n    }\n\n    _drawChart (render) {\n        if (this.isOrdinal()) {\n            this._brushOn = false;\n        }\n\n        this._prepareXAxis(this.g(), render);\n        this._prepareYAxis(this.g());\n\n        this.plotData();\n\n        if (this.elasticX() || this._resizing || render) {\n            this.renderXAxis(this.g());\n        }\n\n        if (this.elasticY() || this._resizing || render) {\n            this.renderYAxis(this.g());\n        }\n\n        if (render) {\n            this.renderBrush(this.g(), false);\n        } else {\n            // Animate the brush only while resizing\n            this.redrawBrush(this.filter(), this._resizing);\n        }\n        this.fadeDeselectedArea(this.filter());\n        this.resizing(false);\n    }\n\n    _configureMouseZoom () {\n        // Save a copy of original x scale\n        this._origX = this._x.copy();\n\n        if (this._mouseZoomable) {\n            this._enableMouseZoom();\n        } else if (this._hasBeenMouseZoomable) {\n            this._disableMouseZoom();\n        }\n    }\n\n    _enableMouseZoom () {\n        this._hasBeenMouseZoomable = true;\n\n        const extent = [[0, 0], [this.effectiveWidth(), this.effectiveHeight()]];\n\n        this._zoom\n            .scaleExtent(this._zoomScale)\n            .extent(extent)\n            .duration(this.transitionDuration());\n\n        if (this._zoomOutRestrict) {\n            // Ensure minimum zoomScale is at least 1\n            const zoomScaleMin = Math.max(this._zoomScale[0], 1);\n            this._zoom\n                .translateExtent(extent)\n                .scaleExtent([zoomScaleMin, this._zoomScale[1]]);\n        }\n\n        this.root().call(this._zoom);\n\n        // Tell D3 zoom our current zoom/pan status\n        this._updateD3zoomTransform();\n    }\n\n    _disableMouseZoom () {\n        this.root().call(this._nullZoom);\n    }\n\n    _zoomHandler (newDomain, noRaiseEvents) {\n        let domFilter;\n\n        if (this._hasRangeSelected(newDomain)) {\n            this.x().domain(newDomain);\n            domFilter = filters.RangedFilter(newDomain[0], newDomain[1]);\n        } else {\n            this.x().domain(this._xOriginalDomain);\n            domFilter = null;\n        }\n\n        this.replaceFilter(domFilter);\n        this.rescale();\n        this.redraw();\n\n        if (!noRaiseEvents) {\n            if (this._rangeChart && !utils.arraysEqual(this.filter(), this._rangeChart.filter())) {\n                events.trigger(() => {\n                    this._rangeChart.replaceFilter(domFilter);\n                    this._rangeChart.redraw();\n                });\n            }\n\n            this._invokeZoomedListener();\n            events.trigger(() => {\n                this.redrawGroup();\n            }, constants.EVENT_DELAY);\n        }\n    }\n\n    // event.transform.rescaleX(self._origX).domain() should give back newDomain\n    _domainToZoomTransform (newDomain, origDomain, xScale) {\n        const k = (origDomain[1] - origDomain[0]) / (newDomain[1] - newDomain[0]);\n        const xt = -1 * xScale(newDomain[0]);\n\n        return zoomIdentity.scale(k).translate(xt, 0);\n    }\n\n    // If we changing zoom status (for example by calling focus), tell D3 zoom about it\n    _updateD3zoomTransform () {\n        if (this._zoom) {\n            this._withoutZoomEvents(() => {\n                this._zoom.transform(this.root(), this._domainToZoomTransform(this.x().domain(), this._xOriginalDomain, this._origX));\n            });\n        }\n    }\n\n    _withoutZoomEvents (closure) {\n        const oldValue = this._ignoreZoomEvents;\n        this._ignoreZoomEvents = true;\n\n        try {\n            closure();\n        } finally {\n            this._ignoreZoomEvents = oldValue;\n        }\n    }\n\n    _onZoom (evt) {\n        // ignore zoom events if it was caused by a programmatic change\n        if (this._ignoreZoomEvents) {\n            return;\n        }\n\n        const newDomain = evt.transform.rescaleX(this._origX).domain();\n        this.focus(newDomain, false);\n    }\n\n    _checkExtents (ext, outerLimits) {\n        if (!ext || ext.length !== 2 || !outerLimits || outerLimits.length !== 2) {\n            return ext;\n        }\n\n        if (ext[0] > outerLimits[1] || ext[1] < outerLimits[0]) {\n            console.warn('Could not intersect extents, will reset');\n        }\n        // Math.max does not work (as the values may be dates as well)\n        return [ext[0] > outerLimits[0] ? ext[0] : outerLimits[0], ext[1] < outerLimits[1] ? ext[1] : outerLimits[1]];\n    }\n\n    /**\n     * Zoom this chart to focus on the given range. The given range should be an array containing only\n     * 2 elements (`[start, end]`) defining a range in the x domain. If the range is not given or set\n     * to null, then the zoom will be reset. _For focus to work elasticX has to be turned off;\n     * otherwise focus will be ignored.\n     *\n     * To avoid ping-pong volley of events between a pair of range and focus charts please set\n     * `noRaiseEvents` to `true`. In that case it will update this chart but will not fire `zoom` event\n     * and not try to update back the associated range chart.\n     * If you are calling it manually - typically you will leave it to `false` (the default).\n     *\n     * @example\n     * chart.on('renderlet', function(chart) {\n     *     // smooth the rendering through event throttling\n     *     events.trigger(function(){\n     *          // focus some other chart to the range selected by user on this chart\n     *          someOtherChart.focus(chart.filter());\n     *     });\n     * })\n     * @param {Array<Number>} [range]\n     * @param {Boolean} [noRaiseEvents = false]\n     * @return {undefined}\n     */\n    focus (range, noRaiseEvents) {\n        if (this._zoomOutRestrict) {\n            // ensure range is within self._xOriginalDomain\n            range = this._checkExtents(range, this._xOriginalDomain);\n\n            // If it has an associated range chart ensure range is within domain of that rangeChart\n            if (this._rangeChart) {\n                range = this._checkExtents(range, this._rangeChart.x().domain());\n            }\n        }\n\n        this._zoomHandler(range, noRaiseEvents);\n        this._updateD3zoomTransform();\n    }\n\n    refocused () {\n        return !utils.arraysEqual(this.x().domain(), this._xOriginalDomain);\n    }\n\n    focusChart (c) {\n        if (!arguments.length) {\n            return this._focusChart;\n        }\n        this._focusChart = c;\n        this.on('filtered.dcjs-range-chart', chart => {\n            if (!chart.filter()) {\n                events.trigger(() => {\n                    this._focusChart.x().domain(this._focusChart.xOriginalDomain(), true);\n                });\n            } else if (!utils.arraysEqual(chart.filter(), this._focusChart.filter())) {\n                events.trigger(() => {\n                    this._focusChart.focus(chart.filter(), true);\n                });\n            }\n        });\n        return this;\n    }\n\n    /**\n     * Turn on/off the brush-based range filter. When brushing is on then user can drag the mouse\n     * across a chart with a quantitative scale to perform range filtering based on the extent of the\n     * brush, or click on the bars of an ordinal bar chart or slices of a pie chart to filter and\n     * un-filter them. However turning on the brush filter will disable other interactive elements on\n     * the chart such as highlighting, tool tips, and reference lines. Zooming will still be possible\n     * if enabled, but only via scrolling (panning will be disabled.)\n     * @param {Boolean} [brushOn=true]\n     * @returns {Boolean|CoordinateGridMixin}\n     */\n    brushOn (brushOn) {\n        if (!arguments.length) {\n            return this._brushOn;\n        }\n        this._brushOn = brushOn;\n        return this;\n    }\n\n    /**\n     * This will be internally used by composite chart onto children. Please go not invoke directly.\n     *\n     * @protected\n     * @param {Boolean} [brushOn=false]\n     * @returns {Boolean|CoordinateGridMixin}\n     */\n    parentBrushOn (brushOn) {\n        if (!arguments.length) {\n            return this._parentBrushOn;\n        }\n        this._parentBrushOn = brushOn;\n        return this;\n    }\n\n    // Get the SVG rendered brush\n    gBrush () {\n        return this._gBrush;\n    }\n\n    _hasRangeSelected (range) {\n        return range instanceof Array && range.length > 1;\n    }\n}\n","// https://github.com/d3/d3-plugins/blob/master/box/box.js\n// * Original source March 22, 2013\n// * Enhancements integrated on May 13, 2018 for dc.js library only\n\n// https://github.com/d3/d3-plugins/blob/master/LICENSE\n// Copyright (c) 2012-2015, Michael Bostock\n// All rights reserved.\n\n// Redistribution and use in source and binary forms, with or without\n// modification, are permitted provided that the following conditions are met:\n//\n// * Redistributions of source code must retain the above copyright notice, this\n//   list of conditions and the following disclaimer.\n//\n// * Redistributions in binary form must reproduce the above copyright notice,\n//   this list of conditions and the following disclaimer in the documentation\n//   and/or other materials provided with the distribution.\n//\n// * The name Michael Bostock may not be used to endorse or promote products\n//   derived from this software without specific prior written permission.\n//\n// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\n// AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n// IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n// DISCLAIMED. IN NO EVENT SHALL MICHAEL BOSTOCK BE LIABLE FOR ANY DIRECT,\n// INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,\n// BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n// DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY\n// OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,\n// EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n/*eslint complexity: 0*/\n\n// Inspired by http://informationandvisualization.de/blog/box-plot\n\nimport {ascending, quantile, range} from 'd3-array';\nimport {select} from 'd3-selection';\nimport {scaleLinear} from 'd3-scale';\nimport {timerFlush} from 'd3-timer';\n\nimport {utils} from '../core/utils';\n\nexport const d3Box = function () {\n    let width = 1;\n    let height = 1;\n    let duration = 0;\n    const delay = 0;\n    let domain = null;\n    let value = Number;\n    let whiskers = boxWhiskers;\n    let quartiles = boxQuartiles;\n    let tickFormat = null;\n\n    // Enhanced attributes\n    let renderDataPoints = false;\n    const dataRadius = 3;\n    let dataOpacity = 0.3;\n    let dataWidthPortion = 0.8;\n    let renderTitle = false;\n    let showOutliers = true;\n    let boldOutlier = false;\n\n\n    // For each small multiple…\n    function box (g) {\n        g.each(function (data, index) {\n            data = data.map(value).sort(ascending);\n            const _g = select(this);\n            const n = data.length;\n            let min;\n            let max;\n\n            // Leave if there are no items.\n            if (n === 0) {return;}\n\n            // Compute quartiles. Must return exactly 3 elements.\n            const quartileData = data.quartiles = quartiles(data);\n\n            // Compute whiskers. Must return exactly 2 elements, or null.\n            const whiskerIndices = whiskers && whiskers.call(this, data, index),\n                whiskerData = whiskerIndices && whiskerIndices.map(_i => data[_i]);\n\n            // Compute outliers. If no whiskers are specified, all data are 'outliers'.\n            // We compute the outliers as indices, so that we can join across transitions!\n            const outlierIndices = whiskerIndices ?\n                range(0, whiskerIndices[0]).concat(range(whiskerIndices[1] + 1, n)) : range(n);\n\n            // Determine the maximum value based on if outliers are shown\n            if (showOutliers) {\n                min = data[0];\n                max = data[n - 1];\n            } else {\n                min = data[whiskerIndices[0]];\n                max = data[whiskerIndices[1]];\n            }\n            const pointIndices = range(whiskerIndices[0], whiskerIndices[1] + 1);\n\n            // Compute the new x-scale.\n            const x1 = scaleLinear()\n                .domain(domain && domain.call(this, data, index) || [min, max])\n                .range([height, 0]);\n\n            // Retrieve the old x-scale, if this is an update.\n            const x0 = this.__chart__ || scaleLinear()\n                .domain([0, Infinity])\n                .range(x1.range());\n\n            // Stash the new scale.\n            this.__chart__ = x1;\n\n            // Note: the box, median, and box tick elements are fixed in number,\n            // so we only have to handle enter and update. In contrast, the outliers\n            // and other elements are variable, so we need to exit them! Variable\n            // elements also fade in and out.\n\n            // Update center line: the vertical line spanning the whiskers.\n            const center = _g.selectAll('line.center')\n                .data(whiskerData ? [whiskerData] : []);\n\n            center.enter().insert('line', 'rect')\n                .attr('class', 'center')\n                .attr('x1', width / 2)\n                .attr('y1', d => x0(d[0]))\n                .attr('x2', width / 2)\n                .attr('y2', d => x0(d[1]))\n                .style('opacity', 1e-6)\n                .transition()\n                .duration(duration)\n                .delay(delay)\n                .style('opacity', 1)\n                .attr('y1', d => x1(d[0]))\n                .attr('y2', d => x1(d[1]));\n\n            center.transition()\n                .duration(duration)\n                .delay(delay)\n                .style('opacity', 1)\n                .attr('x1', width / 2)\n                .attr('x2', width / 2)\n                .attr('y1', d => x1(d[0]))\n                .attr('y2', d => x1(d[1]));\n\n            center.exit().transition()\n                .duration(duration)\n                .delay(delay)\n                .style('opacity', 1e-6)\n                .attr('y1', d => x1(d[0]))\n                .attr('y2', d => x1(d[1]))\n                .remove();\n\n            // Update innerquartile box.\n            const _box = _g.selectAll('rect.box')\n                .data([quartileData]);\n\n            _box.enter().append('rect')\n                .attr('class', 'box')\n                .attr('x', 0)\n                .attr('y', d => x0(d[2]))\n                .attr('width', width)\n                .attr('height', d => x0(d[0]) - x0(d[2]))\n                .style('fill-opacity', (renderDataPoints) ? 0.1 : 1)\n                .transition()\n                .duration(duration)\n                .delay(delay)\n                .attr('y', d => x1(d[2]))\n                .attr('height', d => x1(d[0]) - x1(d[2]));\n\n            _box.transition()\n                .duration(duration)\n                .delay(delay)\n                .attr('width', width)\n                .attr('y', d => x1(d[2]))\n                .attr('height', d => x1(d[0]) - x1(d[2]));\n\n            // Update median line.\n            const medianLine = _g.selectAll('line.median')\n                .data([quartileData[1]]);\n\n            medianLine.enter().append('line')\n                .attr('class', 'median')\n                .attr('x1', 0)\n                .attr('y1', x0)\n                .attr('x2', width)\n                .attr('y2', x0)\n                .transition()\n                .duration(duration)\n                .delay(delay)\n                .attr('y1', x1)\n                .attr('y2', x1);\n\n            medianLine.transition()\n                .duration(duration)\n                .delay(delay)\n                .attr('x1', 0)\n                .attr('x2', width)\n                .attr('y1', x1)\n                .attr('y2', x1);\n\n            // Update whiskers.\n            const whisker = _g.selectAll('line.whisker')\n                .data(whiskerData || []);\n\n            whisker.enter().insert('line', 'circle, text')\n                .attr('class', 'whisker')\n                .attr('x1', 0)\n                .attr('y1', x0)\n                .attr('x2', width)\n                .attr('y2', x0)\n                .style('opacity', 1e-6)\n                .transition()\n                .duration(duration)\n                .delay(delay)\n                .attr('y1', x1)\n                .attr('y2', x1)\n                .style('opacity', 1);\n\n            whisker.transition()\n                .duration(duration)\n                .delay(delay)\n                .attr('x1', 0)\n                .attr('x2', width)\n                .attr('y1', x1)\n                .attr('y2', x1)\n                .style('opacity', 1);\n\n            whisker.exit().transition()\n                .duration(duration)\n                .delay(delay)\n                .attr('y1', x1)\n                .attr('y2', x1)\n                .style('opacity', 1e-6)\n                .remove();\n\n            // Update outliers.\n            if (showOutliers) {\n                const outlierClass = boldOutlier ? 'outlierBold' : 'outlier';\n                const outlierSize = boldOutlier ? 3 : 5;\n                const outlierX = boldOutlier ?\n                    function () {\n                        return Math.floor(Math.random() *\n                            (width * dataWidthPortion) +\n                            1 + ((width - (width * dataWidthPortion)) / 2));\n                    } :\n                    function () {\n                        return width / 2;\n                    };\n\n                const outlier = _g.selectAll(`circle.${outlierClass}`)\n                    .data(outlierIndices, Number);\n\n                outlier.enter().insert('circle', 'text')\n                    .attr('class', outlierClass)\n                    .attr('r', outlierSize)\n                    .attr('cx', outlierX)\n                    .attr('cy', i => x0(data[i]))\n                    .style('opacity', 1e-6)\n                    .transition()\n                    .duration(duration)\n                    .delay(delay)\n                    .attr('cy', i => x1(data[i]))\n                    .style('opacity', 0.6);\n\n                if (renderTitle) {\n                    outlier.selectAll('title').remove();\n                    outlier.append('title').text(i => data[i]);\n                }\n\n                outlier.transition()\n                    .duration(duration)\n                    .delay(delay)\n                    .attr('cx', outlierX)\n                    .attr('cy', i => x1(data[i]))\n                    .style('opacity', 0.6);\n\n                outlier.exit().transition()\n                    .duration(duration)\n                    .delay(delay)\n                    .attr('cy', 0) //function (i) { return x1(d[i]); })\n                    .style('opacity', 1e-6)\n                    .remove();\n            }\n\n            // Update Values\n            if (renderDataPoints) {\n                const point = _g.selectAll('circle.data')\n                    .data(pointIndices);\n\n                point.enter().insert('circle', 'text')\n                    .attr('class', 'data')\n                    .attr('r', dataRadius)\n                    .attr('cx', () => Math.floor(Math.random() *\n                            (width * dataWidthPortion) +\n                            1 + ((width - (width * dataWidthPortion)) / 2)))\n                    .attr('cy', i => x0(data[i]))\n                    .style('opacity', 1e-6)\n                    .transition()\n                    .duration(duration)\n                    .delay(delay)\n                    .attr('cy', i => x1(data[i]))\n                    .style('opacity', dataOpacity);\n\n                if (renderTitle) {\n                    point.selectAll('title').remove();\n                    point.append('title').text(i => data[i]);\n                }\n\n                point.transition()\n                    .duration(duration)\n                    .delay(delay)\n                    .attr('cx', () => Math.floor(Math.random() *\n                            (width * dataWidthPortion) +\n                            1 + ((width - (width * dataWidthPortion)) / 2)))\n                    .attr('cy', i => x1(data[i]))\n                    .style('opacity', dataOpacity);\n\n                point.exit().transition()\n                    .duration(duration)\n                    .delay(delay)\n                    .attr('cy', 0)\n                    .style('opacity', 1e-6)\n                    .remove();\n            }\n\n            // Compute the tick format.\n            const format = tickFormat || x1.tickFormat(8);\n\n            // Update box ticks.\n            const boxTick = _g.selectAll('text.box')\n                .data(quartileData);\n\n            boxTick.enter().append('text')\n                .attr('class', 'box')\n                .attr('dy', '.3em')\n                .attr('dx', (d, i) => i & 1 ? 6 : -6)\n                .attr('x', (d, i) => i & 1 ? width : 0)\n                .attr('y', x0)\n                .attr('text-anchor', (d, i) => i & 1 ? 'start' : 'end')\n                .text(format)\n                .transition()\n                .duration(duration)\n                .delay(delay)\n                .attr('y', x1);\n\n            boxTick.transition()\n                .duration(duration)\n                .delay(delay)\n                .text(format)\n                .attr('x', (d, i) => i & 1 ? width : 0)\n                .attr('y', x1);\n\n            // Update whisker ticks. These are handled separately from the box\n            // ticks because they may or may not exist, and we want don't want\n            // to join box ticks pre-transition with whisker ticks post-.\n            const whiskerTick = _g.selectAll('text.whisker')\n                .data(whiskerData || []);\n\n            whiskerTick.enter().append('text')\n                .attr('class', 'whisker')\n                .attr('dy', '.3em')\n                .attr('dx', 6)\n                .attr('x', width)\n                .attr('y', x0)\n                .text(format)\n                .style('opacity', 1e-6)\n                .transition()\n                .duration(duration)\n                .delay(delay)\n                .attr('y', x1)\n                .style('opacity', 1);\n\n            whiskerTick.transition()\n                .duration(duration)\n                .delay(delay)\n                .text(format)\n                .attr('x', width)\n                .attr('y', x1)\n                .style('opacity', 1);\n\n            whiskerTick.exit().transition()\n                .duration(duration)\n                .delay(delay)\n                .attr('y', x1)\n                .style('opacity', 1e-6)\n                .remove();\n\n            // Remove temporary quartiles element from within data array.\n            delete data.quartiles;\n        });\n        timerFlush();\n    }\n\n    box.width = function (x) {\n        if (!arguments.length) {\n            return width;\n        }\n        width = x;\n        return box;\n    };\n\n    box.height = function (x) {\n        if (!arguments.length) {\n            return height;\n        }\n        height = x;\n        return box;\n    };\n\n    box.tickFormat = function (x) {\n        if (!arguments.length) {\n            return tickFormat;\n        }\n        tickFormat = x;\n        return box;\n    };\n\n    box.showOutliers = function (x) {\n        if (!arguments.length) {\n            return showOutliers;\n        }\n        showOutliers = x;\n        return box;\n    };\n\n    box.boldOutlier = function (x) {\n        if (!arguments.length) {\n            return boldOutlier;\n        }\n        boldOutlier = x;\n        return box;\n    };\n\n    box.renderDataPoints = function (x) {\n        if (!arguments.length) {\n            return renderDataPoints;\n        }\n        renderDataPoints = x;\n        return box;\n    };\n\n    box.renderTitle = function (x) {\n        if (!arguments.length) {\n            return renderTitle;\n        }\n        renderTitle = x;\n        return box;\n    };\n\n    box.dataOpacity = function (x) {\n        if (!arguments.length) {\n            return dataOpacity;\n        }\n        dataOpacity = x;\n        return box;\n    };\n\n    box.dataWidthPortion = function (x) {\n        if (!arguments.length) {\n            return dataWidthPortion;\n        }\n        dataWidthPortion = x;\n        return box;\n    };\n\n    box.duration = function (x) {\n        if (!arguments.length) {\n            return duration;\n        }\n        duration = x;\n        return box;\n    };\n\n    box.domain = function (x) {\n        if (!arguments.length) {\n            return domain;\n        }\n        domain = x === null ? x : typeof x === 'function' ? x : utils.constant(x);\n        return box;\n    };\n\n    box.value = function (x) {\n        if (!arguments.length) {\n            return value;\n        }\n        value = x;\n        return box;\n    };\n\n    box.whiskers = function (x) {\n        if (!arguments.length) {\n            return whiskers;\n        }\n        whiskers = x;\n        return box;\n    };\n\n    box.quartiles = function (x) {\n        if (!arguments.length) {\n            return quartiles;\n        }\n        quartiles = x;\n        return box;\n    };\n\n    return box;\n};\n\nfunction boxWhiskers (d) {\n    return [0, d.length - 1];\n}\n\nfunction boxQuartiles (d) {\n    return [\n        quantile(d, 0.25),\n        quantile(d, 0.5),\n        quantile(d, 0.75)\n    ];\n}\n","import {stack} from 'd3-shape';\nimport {max, min} from 'd3-array';\n\nimport {pluck, utils} from '../core/utils';\nimport {CoordinateGridMixin} from './coordinate-grid-mixin';\n\n/**\n * Stack Mixin is an mixin that provides cross-chart support of stackability using d3.stack.\n * @mixin StackMixin\n * @mixes CoordinateGridMixin\n */\nexport class StackMixin extends CoordinateGridMixin {\n    constructor () {\n        super();\n\n        this._stackLayout = stack();\n\n        this._stack = [];\n        this._titles = {};\n\n        this._hidableStacks = false;\n        this._evadeDomainFilter = false;\n\n        this.data(() => {\n            const layers = this._stack.filter(this._visibility);\n            if (!layers.length) {\n                return [];\n            }\n            layers.forEach((l, i) => this._prepareValues(l, i));\n            const v4data = layers[0].values.map((v, i) => {\n                const col = {x: v.x};\n                layers.forEach(layer => {\n                    col[layer.name] = layer.values[i].y;\n                });\n                return col;\n            });\n            const keys = layers.map(layer => layer.name);\n            const v4result = this.stackLayout().keys(keys)(v4data);\n            v4result.forEach((series, i) => {\n                series.forEach((ys, j) => {\n                    layers[i].values[j].y0 = ys[0];\n                    layers[i].values[j].y1 = ys[1];\n                });\n            });\n            return layers;\n        });\n\n        this.colorAccessor(function (d) {\n            return this.layer || this.name || d.name || d.layer;\n        });\n    }\n\n    _prepareValues (layer, layerIdx) {\n        const valAccessor = layer.accessor || this.valueAccessor();\n        layer.name = String(layer.name || layerIdx);\n        const allValues = layer.group.all().map((d, i) => ({\n            x: this.keyAccessor()(d, i),\n            y: layer.hidden ? null : valAccessor(d, i),\n            data: d,\n            layer: layer.name,\n            hidden: layer.hidden\n        }));\n\n        layer.domainValues = allValues.filter(l => this._domainFilter()(l));\n        layer.values = this.evadeDomainFilter() ? allValues : layer.domainValues;\n    }\n\n    _domainFilter () {\n        if (!this.x()) {\n            return utils.constant(true);\n        }\n        const xDomain = this.x().domain();\n        if (this.isOrdinal()) {\n            // TODO #416\n            //var domainSet = d3.set(xDomain);\n            return () => true //domainSet.has(p.x);\n            ;\n        }\n        if (this.elasticX()) {\n            return () => true;\n        }\n        return p => p.x >= xDomain[0] && p.x <= xDomain[xDomain.length - 1];\n    }\n\n    /**\n     * Stack a new crossfilter group onto this chart with an optional custom value accessor. All stacks\n     * in the same chart will share the same key accessor and therefore the same set of keys.\n     *\n     * For example, in a stacked bar chart, the bars of each stack will be positioned using the same set\n     * of keys on the x axis, while stacked vertically. If name is specified then it will be used to\n     * generate the legend label.\n     * @see {@link https://github.com/crossfilter/crossfilter/wiki/API-Reference#group-map-reduce crossfilter.group}\n     * @example\n     * // stack group using default accessor\n     * chart.stack(valueSumGroup)\n     * // stack group using custom accessor\n     * .stack(avgByDayGroup, function(d){return d.value.avgByDay;});\n     * @param {crossfilter.group} group\n     * @param {String} [name]\n     * @param {Function} [accessor]\n     * @returns {Array<{group: crossfilter.group, name: String, accessor: Function}>|StackMixin}\n     */\n    stack (group, name, accessor) {\n        if (!arguments.length) {\n            return this._stack;\n        }\n\n        if (arguments.length <= 2) {\n            accessor = name;\n        }\n\n        const layer = {group: group};\n        if (typeof name === 'string') {\n            layer.name = name;\n        }\n        if (typeof accessor === 'function') {\n            layer.accessor = accessor;\n        }\n        this._stack.push(layer);\n\n        return this;\n    }\n\n    group (g, n, f) {\n        if (!arguments.length) {\n            return super.group();\n        }\n        this._stack = [];\n        this._titles = {};\n        this.stack(g, n);\n        if (f) {\n            this.valueAccessor(f);\n        }\n        return super.group(g, n);\n    }\n\n    /**\n     * Allow named stacks to be hidden or shown by clicking on legend items.\n     * This does not affect the behavior of hideStack or showStack.\n     * @param {Boolean} [hidableStacks=false]\n     * @returns {Boolean|StackMixin}\n     */\n    hidableStacks (hidableStacks) {\n        if (!arguments.length) {\n            return this._hidableStacks;\n        }\n        this._hidableStacks = hidableStacks;\n        return this;\n    }\n\n    _findLayerByName (n) {\n        const i = this._stack.map(pluck('name')).indexOf(n);\n        return this._stack[i];\n    }\n\n    /**\n     * Hide all stacks on the chart with the given name.\n     * The chart must be re-rendered for this change to appear.\n     * @param {String} stackName\n     * @returns {StackMixin}\n     */\n    hideStack (stackName) {\n        const layer = this._findLayerByName(stackName);\n        if (layer) {\n            layer.hidden = true;\n        }\n        return this;\n    }\n\n    /**\n     * Show all stacks on the chart with the given name.\n     * The chart must be re-rendered for this change to appear.\n     * @param {String} stackName\n     * @returns {StackMixin}\n     */\n    showStack (stackName) {\n        const layer = this._findLayerByName(stackName);\n        if (layer) {\n            layer.hidden = false;\n        }\n        return this;\n    }\n\n    getValueAccessorByIndex (index) {\n        return this._stack[index].accessor || this.valueAccessor();\n    }\n\n    yAxisMin () {\n        const m = min(this._flattenStack(), p => (p.y < 0) ? (p.y + p.y0) : p.y0);\n        return utils.subtract(m, this.yAxisPadding());\n    }\n\n    yAxisMax () {\n        const m = max(this._flattenStack(), p => (p.y > 0) ? (p.y + p.y0) : p.y0);\n        return utils.add(m, this.yAxisPadding());\n    }\n\n    _flattenStack () {\n        // A round about way to achieve flatMap\n        // When target browsers support flatMap, just replace map -> flatMap, no concat needed\n        const values = this.data().map(layer => layer.domainValues);\n        return [].concat(...values);\n    }\n\n    xAxisMin () {\n        const m = min(this._flattenStack(), pluck('x'));\n        return utils.subtract(m, this.xAxisPadding(), this.xAxisPaddingUnit());\n    }\n\n    xAxisMax () {\n        const m = max(this._flattenStack(), pluck('x'));\n        return utils.add(m, this.xAxisPadding(), this.xAxisPaddingUnit());\n    }\n\n    /**\n     * Set or get the title function. Chart class will use this function to render svg title (usually interpreted by\n     * browser as tooltips) for each child element in the chart, i.e. a slice in a pie chart or a bubble in a bubble chart.\n     * Almost every chart supports title function however in grid coordinate chart you need to turn off brush in order to\n     * use title otherwise the brush layer will block tooltip trigger.\n     *\n     * If the first argument is a stack name, the title function will get or set the title for that stack. If stackName\n     * is not provided, the first stack is implied.\n     * @example\n     * // set a title function on 'first stack'\n     * chart.title('first stack', function(d) { return d.key + ': ' + d.value; });\n     * // get a title function from 'second stack'\n     * var secondTitleFunction = chart.title('second stack');\n     * @param {String} [stackName]\n     * @param {Function} [titleAccessor]\n     * @returns {String|StackMixin}\n     */\n    title (stackName, titleAccessor) {\n        if (!stackName) {\n            return super.title();\n        }\n\n        if (typeof stackName === 'function') {\n            return super.title(stackName);\n        }\n        if (stackName === this._groupName && typeof titleAccessor === 'function') {\n            return super.title(titleAccessor);\n        }\n\n        if (typeof titleAccessor !== 'function') {\n            return this._titles[stackName] || super.title();\n        }\n\n        this._titles[stackName] = titleAccessor;\n\n        return this;\n    }\n\n    /**\n     * Gets or sets the stack layout algorithm, which computes a baseline for each stack and\n     * propagates it to the next.\n     * @see {@link https://github.com/d3/d3-3.x-api-reference/blob/master/Stack-Layout.md d3.stackD3v3}\n     * @param {Function} [_stack=d3.stackD3v3]\n     * @returns {Function|StackMixin}\n     */\n    stackLayout (_stack) {\n        if (!arguments.length) {\n            return this._stackLayout;\n        }\n        this._stackLayout = _stack;\n        return this;\n    }\n\n    /**\n     * Since dc.js 2.0, there has been {@link https://github.com/dc-js/dc.js/issues/949 an issue}\n     * where points are filtered to the current domain. While this is a useful optimization, it is\n     * incorrectly implemented: the next point outside the domain is required in order to draw lines\n     * that are clipped to the bounds, as well as bars that are partly clipped.\n     *\n     * A fix will be included in dc.js 2.1.x, but a workaround is needed for dc.js 2.0 and until\n     * that fix is published, so set this flag to skip any filtering of points.\n     *\n     * Once the bug is fixed, this flag will have no effect, and it will be deprecated.\n     * @param {Boolean} [evadeDomainFilter=false]\n     * @returns {Boolean|StackMixin}\n     */\n    evadeDomainFilter (evadeDomainFilter) {\n        if (!arguments.length) {\n            return this._evadeDomainFilter;\n        }\n        this._evadeDomainFilter = evadeDomainFilter;\n        return this;\n    }\n\n    _visibility (l) {\n        return !l.hidden;\n    }\n\n    _ordinalXDomain () {\n        const flat = this._flattenStack().map(pluck('data'));\n        const ordered = this._computeOrderedGroups(flat);\n        return ordered.map(this.keyAccessor());\n    }\n\n    legendables () {\n        return this._stack.map((layer, i) => ({\n            chart: this,\n            name: layer.name,\n            hidden: layer.hidden || false,\n            color: this.getColor.call(layer, layer.values, i)\n        }));\n    }\n\n    isLegendableHidden (d) {\n        const layer = this._findLayerByName(d.name);\n        return layer ? layer.hidden : false;\n    }\n\n    legendToggle (d) {\n        if (this._hidableStacks) {\n            if (this.isLegendableHidden(d)) {\n                this.showStack(d.name);\n            } else {\n                this.hideStack(d.name);\n            }\n            //_chart.redraw();\n            this.renderGroup();\n        }\n    }\n}\n","import {select} from 'd3-selection';\n\nimport {StackMixin} from '../base/stack-mixin';\nimport {transition} from '../core/core';\nimport {constants} from '../core/constants';\nimport {logger} from '../core/logger';\nimport {pluck, utils} from '../core/utils';\nimport {adaptHandler} from '../core/d3compat';\n\nconst MIN_BAR_WIDTH = 1;\nconst DEFAULT_GAP_BETWEEN_BARS = 2;\nconst LABEL_PADDING = 3;\n\n/**\n * Concrete bar chart/histogram implementation.\n *\n * Examples:\n * - {@link http://dc-js.github.com/dc.js/ Nasdaq 100 Index}\n * - {@link http://dc-js.github.com/dc.js/crime/index.html Canadian City Crime Stats}\n * @mixes StackMixin\n */\nexport class BarChart extends StackMixin {\n    /**\n     * Create a Bar Chart\n     * @example\n     * // create a bar chart under #chart-container1 element using the default global chart group\n     * var chart1 = new BarChart('#chart-container1');\n     * // create a bar chart under #chart-container2 element using chart group A\n     * var chart2 = new BarChart('#chart-container2', 'chartGroupA');\n     * // create a sub-chart under a composite parent chart\n     * var chart3 = new BarChart(compositeChart);\n     * @param {String|node|d3.selection|CompositeChart} parent - Any valid\n     * {@link https://github.com/d3/d3-selection/blob/master/README.md#select d3 single selector}\n     * specifying a dom block element such as a div; or a dom element or d3 selection.  If the bar\n     * chart is a sub-chart in a {@link CompositeChart Composite Chart} then pass in the parent\n     * composite chart instance instead.\n     * @param {String} [chartGroup] - The name of the chart group this chart instance should be placed in.\n     * Interaction with a chart will only trigger events and redraws within the chart's group.\n     */\n    constructor (parent, chartGroup) {\n        super();\n\n        this._gap = DEFAULT_GAP_BETWEEN_BARS;\n        this._centerBar = false;\n        this._alwaysUseRounding = false;\n\n        this._barWidth = undefined;\n\n        this.label(d => utils.printSingleValue(d.y0 + d.y), false);\n\n        this.anchor(parent, chartGroup);\n    }\n\n    /**\n     * Get or set the outer padding on an ordinal bar chart. This setting has no effect on non-ordinal charts.\n     * Will pad the width by `padding * barWidth` on each side of the chart.\n     * @param {Number} [padding=0.5]\n     * @returns {Number|BarChart}\n     */\n    outerPadding (padding) {\n        if (!arguments.length) {\n            return this._outerRangeBandPadding();\n        }\n        return this._outerRangeBandPadding(padding);\n    }\n\n    rescale () {\n        super.rescale();\n        this._barWidth = undefined;\n        return this;\n    }\n\n    render () {\n        if (this.round() && this._centerBar && !this._alwaysUseRounding) {\n            logger.warn('By default, brush rounding is disabled if bars are centered. ' +\n                'See dc.js bar chart API documentation for details.');\n        }\n\n        return super.render();\n    }\n\n    plotData () {\n        let layers = this.chartBodyG().selectAll('g.stack')\n            .data(this.data());\n\n        this._calculateBarWidth();\n\n        layers = layers\n            .enter()\n            .append('g')\n            .attr('class', (d, i) => `stack _${i}`)\n            .merge(layers);\n\n        const last = layers.size() - 1;\n        {\n            const chart = this;\n            layers.each(function (d, i) {\n                const layer = select(this);\n\n                chart._renderBars(layer, i, d);\n\n                if (chart.renderLabel() && last === i) {\n                    chart._renderLabels(layer, i, d);\n                }\n            });\n        }\n    }\n\n    _barHeight (d) {\n        return utils.safeNumber(Math.abs(this.y()(d.y + d.y0) - this.y()(d.y0)));\n    }\n\n    _labelXPos (d) {\n        let x = this.x()(d.x);\n        if (!this._centerBar) {\n            x += this._barWidth / 2;\n        }\n        if (this.isOrdinal() && this._gap !== undefined) {\n            x += this._gap / 2;\n        }\n        return utils.safeNumber(x);\n    }\n\n    _labelYPos (d) {\n        let y = this.y()(d.y + d.y0);\n\n        if (d.y < 0) {\n            y -= this._barHeight(d);\n        }\n\n        return utils.safeNumber(y - LABEL_PADDING);\n    }\n\n    _renderLabels (layer, layerIndex, data) {\n        const labels = layer.selectAll('text.barLabel')\n            .data(data.values, pluck('x'));\n\n        const labelsEnterUpdate = labels\n            .enter()\n            .append('text')\n            .attr('class', 'barLabel')\n            .attr('text-anchor', 'middle')\n            .attr('x', d => this._labelXPos(d))\n            .attr('y', d => this._labelYPos(d))\n            .merge(labels);\n\n        if (this.isOrdinal()) {\n            labelsEnterUpdate.on('click', adaptHandler(d => this.onClick(d)));\n            labelsEnterUpdate.attr('cursor', 'pointer');\n        }\n\n        transition(labelsEnterUpdate, this.transitionDuration(), this.transitionDelay())\n            .attr('x', d => this._labelXPos(d))\n            .attr('y', d => this._labelYPos(d))\n            .text(d => this.label()(d));\n\n        transition(labels.exit(), this.transitionDuration(), this.transitionDelay())\n            .attr('height', 0)\n            .remove();\n    }\n\n    _barXPos (d) {\n        let x = this.x()(d.x);\n        if (this._centerBar) {\n            x -= this._barWidth / 2;\n        }\n        if (this.isOrdinal() && this._gap !== undefined) {\n            x += this._gap / 2;\n        }\n        return utils.safeNumber(x);\n    }\n\n    _renderBars (layer, layerIndex, data) {\n        const bars = layer.selectAll('rect.bar')\n            .data(data.values, pluck('x'));\n\n        const enter = bars.enter()\n            .append('rect')\n            .attr('class', 'bar')\n            .classed('dc-tabbable', this._keyboardAccessible)\n            .attr('fill', pluck('data', this.getColor))\n            .attr('x', d => this._barXPos(d))\n            .attr('y', this.yAxisHeight())\n            .attr('height', 0);\n\n        const barsEnterUpdate = enter.merge(bars);\n\n        if (this.renderTitle()) {\n            enter.append('title').text(pluck('data', this.title(data.name)));\n        }\n\n        if (this.isOrdinal()) {\n            barsEnterUpdate.on('click', adaptHandler(d => this.onClick(d)));\n        }\n\n        if (this._keyboardAccessible) {\n            this._makeKeyboardAccessible(this.onClick);\n        }\n\n        transition(barsEnterUpdate, this.transitionDuration(), this.transitionDelay())\n            .attr('x', d => this._barXPos(d))\n            .attr('y', d => {\n                let y = this.y()(d.y + d.y0);\n\n                if (d.y < 0) {\n                    y -= this._barHeight(d);\n                }\n\n                return utils.safeNumber(y);\n            })\n            .attr('width', this._barWidth)\n            .attr('height', d => this._barHeight(d))\n            .attr('fill', pluck('data', this.getColor))\n            .select('title').text(pluck('data', this.title(data.name)));\n\n        transition(bars.exit(), this.transitionDuration(), this.transitionDelay())\n            .attr('x', d => this.x()(d.x))\n            .attr('width', this._barWidth * 0.9)\n            .remove();\n    }\n\n    _calculateBarWidth () {\n        if (this._barWidth === undefined) {\n            const numberOfBars = this.xUnitCount();\n\n            // please can't we always use rangeBands for bar charts?\n            if (this.isOrdinal() && this._gap === undefined) {\n                this._barWidth = Math.floor(this.x().bandwidth());\n            } else if (this._gap) {\n                this._barWidth = Math.floor((this.xAxisLength() - (numberOfBars - 1) * this._gap) / numberOfBars);\n            } else {\n                this._barWidth = Math.floor(this.xAxisLength() / (1 + this.barPadding()) / numberOfBars);\n            }\n\n            if (this._barWidth === Infinity || isNaN(this._barWidth) || this._barWidth < MIN_BAR_WIDTH) {\n                this._barWidth = MIN_BAR_WIDTH;\n            }\n        }\n    }\n\n    fadeDeselectedArea (brushSelection) {\n        const bars = this.chartBodyG().selectAll('rect.bar');\n\n        if (this.isOrdinal()) {\n            if (this.hasFilter()) {\n                bars.classed(constants.SELECTED_CLASS, d => this.hasFilter(d.x));\n                bars.classed(constants.DESELECTED_CLASS, d => !this.hasFilter(d.x));\n            } else {\n                bars.classed(constants.SELECTED_CLASS, false);\n                bars.classed(constants.DESELECTED_CLASS, false);\n            }\n        } else if (this.brushOn() || this.parentBrushOn()) {\n            if (!this.brushIsEmpty(brushSelection)) {\n                const start = brushSelection[0];\n                const end = brushSelection[1];\n\n                bars.classed(constants.DESELECTED_CLASS, d => d.x < start || d.x >= end);\n            } else {\n                bars.classed(constants.DESELECTED_CLASS, false);\n            }\n        }\n    }\n\n    /**\n     * Whether the bar chart will render each bar centered around the data position on the x-axis.\n     * @param {Boolean} [centerBar=false]\n     * @returns {Boolean|BarChart}\n     */\n    centerBar (centerBar) {\n        if (!arguments.length) {\n            return this._centerBar;\n        }\n        this._centerBar = centerBar;\n        return this;\n    }\n\n    onClick (d) {\n        super.onClick(d.data);\n    }\n\n    /**\n     * Get or set the spacing between bars as a fraction of bar size. Valid values are between 0-1.\n     * Setting this value will also remove any previously set {@link BarChart#gap gap}. See the\n     * {@link https://github.com/d3/d3-scale/blob/master/README.md#scaleBand d3 docs}\n     * for a visual description of how the padding is applied.\n     * @param {Number} [barPadding=0]\n     * @returns {Number|BarChart}\n     */\n    barPadding (barPadding) {\n        if (!arguments.length) {\n            return this._rangeBandPadding();\n        }\n        this._rangeBandPadding(barPadding);\n        this._gap = undefined;\n        return this;\n    }\n\n    _useOuterPadding () {\n        return this._gap === undefined;\n    }\n\n    /**\n     * Manually set fixed gap (in px) between bars instead of relying on the default auto-generated\n     * gap.  By default the bar chart implementation will calculate and set the gap automatically\n     * based on the number of data points and the length of the x axis.\n     * @param {Number} [gap=2]\n     * @returns {Number|BarChart}\n     */\n    gap (gap) {\n        if (!arguments.length) {\n            return this._gap;\n        }\n        this._gap = gap;\n        return this;\n    }\n\n    extendBrush (brushSelection) {\n        if (brushSelection && this.round() && (!this._centerBar || this._alwaysUseRounding)) {\n            brushSelection[0] = this.round()(brushSelection[0]);\n            brushSelection[1] = this.round()(brushSelection[1]);\n        }\n        return brushSelection;\n    }\n\n    /**\n     * Set or get whether rounding is enabled when bars are centered. If false, using\n     * rounding with centered bars will result in a warning and rounding will be ignored.  This flag\n     * has no effect if bars are not {@link BarChart#centerBar centered}.\n     * When using standard d3.js rounding methods, the brush often doesn't align correctly with\n     * centered bars since the bars are offset.  The rounding function must add an offset to\n     * compensate, such as in the following example.\n     * @example\n     * chart.round(function(n) { return Math.floor(n) + 0.5; });\n     * @param {Boolean} [alwaysUseRounding=false]\n     * @returns {Boolean|BarChart}\n     */\n    alwaysUseRounding (alwaysUseRounding) {\n        if (!arguments.length) {\n            return this._alwaysUseRounding;\n        }\n        this._alwaysUseRounding = alwaysUseRounding;\n        return this;\n    }\n\n    legendHighlight (d) {\n        const colorFilter = (color, inv) => function () {\n            const item = select(this);\n            const match = item.attr('fill') === color;\n            return inv ? !match : match;\n        };\n\n        if (!this.isLegendableHidden(d)) {\n            this.g().selectAll('rect.bar')\n                .classed('highlight', colorFilter(d.color))\n                .classed('fadeout', colorFilter(d.color, true));\n        }\n    }\n\n    legendReset () {\n        this.g().selectAll('rect.bar')\n            .classed('highlight', false)\n            .classed('fadeout', false);\n    }\n\n    xAxisMax () {\n        let max = super.xAxisMax();\n        if ('resolution' in this.xUnits()) {\n            const res = this.xUnits().resolution;\n            max += res;\n        }\n        return max;\n    }\n}\n\nexport const barChart = (parent, chartGroup) => new BarChart(parent, chartGroup);\n","import {scaleBand} from 'd3-scale';\nimport {select} from 'd3-selection';\nimport {min, max} from 'd3-array';\n\nimport {d3Box} from '../base/d3.box'\nimport {CoordinateGridMixin} from '../base/coordinate-grid-mixin';\nimport {transition} from '../core/core';\nimport {units} from '../core/units';\nimport {utils} from '../core/utils';\nimport {adaptHandler} from '../core/d3compat';\n\n// Returns a function to compute the interquartile range.\nfunction defaultWhiskersIQR (k) {\n    return d => {\n        const q1 = d.quartiles[0];\n        const q3 = d.quartiles[2];\n        const iqr = (q3 - q1) * k;\n\n        let i = -1;\n        let j = d.length;\n\n        do {\n            ++i;\n        } while (d[i] < q1 - iqr);\n\n        do {\n            --j;\n        } while (d[j] > q3 + iqr);\n\n        return [i, j];\n    };\n}\n\n/**\n * A box plot is a chart that depicts numerical data via their quartile ranges.\n *\n * Examples:\n * - {@link http://dc-js.github.io/dc.js/examples/boxplot-basic.html Boxplot Basic example}\n * - {@link http://dc-js.github.io/dc.js/examples/boxplot-enhanced.html Boxplot Enhanced example}\n * - {@link http://dc-js.github.io/dc.js/examples/boxplot-render-data.html Boxplot Render Data example}\n * - {@link http://dc-js.github.io/dc.js/examples/boxplot-time.html Boxplot time example}\n * @mixes CoordinateGridMixin\n */\nexport class BoxPlot extends CoordinateGridMixin {\n    /**\n     * Create a Box Plot.\n     *\n     * @example\n     * // create a box plot under #chart-container1 element using the default global chart group\n     * var boxPlot1 = new BoxPlot('#chart-container1');\n     * // create a box plot under #chart-container2 element using chart group A\n     * var boxPlot2 = new BoxPlot('#chart-container2', 'chartGroupA');\n     * @param {String|node|d3.selection} parent - Any valid\n     * {@link https://github.com/d3/d3-selection/blob/master/README.md#select d3 single selector} specifying\n     * a dom block element such as a div; or a dom element or d3 selection.\n     * @param {String} [chartGroup] - The name of the chart group this chart instance should be placed in.\n     * Interaction with a chart will only trigger events and redraws within the chart's group.\n     */\n    constructor (parent, chartGroup) {\n        super();\n\n        this._whiskerIqrFactor = 1.5;\n        this._whiskersIqr = defaultWhiskersIQR;\n        this._whiskers = this._whiskersIqr(this._whiskerIqrFactor);\n\n        this._box = d3Box();\n        this._tickFormat = null;\n        this._renderDataPoints = false;\n        this._dataOpacity = 0.3;\n        this._dataWidthPortion = 0.8;\n        this._showOutliers = true;\n        this._boldOutlier = false;\n\n        // Used in yAxisMin and yAxisMax to add padding in pixel coordinates\n        // so the min and max data points/whiskers are within the chart\n        this._yRangePadding = 8;\n\n        this._boxWidth = (innerChartWidth, xUnits) => {\n            if (this.isOrdinal()) {\n                return this.x().bandwidth();\n            } else {\n                return innerChartWidth / (1 + this.boxPadding()) / xUnits;\n            }\n        };\n\n        // default to ordinal\n        this.x(scaleBand());\n        this.xUnits(units.ordinal);\n\n        // valueAccessor should return an array of values that can be coerced into numbers\n        // or if data is overloaded for a static array of arrays, it should be `Number`.\n        // Empty arrays are not included.\n        this.data(group => group.all().map(d => {\n            d.map = accessor => accessor.call(d, d);\n            return d;\n        }).filter(d => {\n            const values = this.valueAccessor()(d);\n            return values.length !== 0;\n        }));\n\n        this.boxPadding(0.8);\n        this.outerPadding(0.5);\n\n        this.anchor(parent, chartGroup);\n    }\n\n    /**\n     * Get or set the spacing between boxes as a fraction of box size. Valid values are within 0-1.\n     * See the {@link https://github.com/d3/d3-scale/blob/master/README.md#scaleBand d3 docs}\n     * for a visual description of how the padding is applied.\n     * @see {@link https://github.com/d3/d3-scale/blob/master/README.md#scaleBand d3.scaleBand}\n     * @param {Number} [padding=0.8]\n     * @returns {Number|BoxPlot}\n     */\n    boxPadding (padding) {\n        if (!arguments.length) {\n            return this._rangeBandPadding();\n        }\n        return this._rangeBandPadding(padding);\n    }\n\n    /**\n     * Get or set the outer padding on an ordinal box chart. This setting has no effect on non-ordinal charts\n     * or on charts with a custom {@link BoxPlot#boxWidth .boxWidth}. Will pad the width by\n     * `padding * barWidth` on each side of the chart.\n     * @param {Number} [padding=0.5]\n     * @returns {Number|BoxPlot}\n     */\n    outerPadding (padding) {\n        if (!arguments.length) {\n            return this._outerRangeBandPadding();\n        }\n        return this._outerRangeBandPadding(padding);\n    }\n\n    /**\n     * Get or set the numerical width of the boxplot box. The width may also be a function taking as\n     * parameters the chart width excluding the right and left margins, as well as the number of x\n     * units.\n     * @example\n     * // Using numerical parameter\n     * chart.boxWidth(10);\n     * // Using function\n     * chart.boxWidth((innerChartWidth, xUnits) { ... });\n     * @param {Number|Function} [boxWidth=0.5]\n     * @returns {Number|Function|BoxPlot}\n     */\n    boxWidth (boxWidth) {\n        if (!arguments.length) {\n            return this._boxWidth;\n        }\n        this._boxWidth = typeof boxWidth === 'function' ? boxWidth : utils.constant(boxWidth);\n        return this;\n    }\n\n    _boxTransform (d, i) {\n        const xOffset = this.x()(this.keyAccessor()(d, i));\n        return `translate(${xOffset}, 0)`;\n    }\n\n    _preprocessData () {\n        if (this.elasticX()) {\n            this.x().domain([]);\n        }\n    }\n\n    plotData () {\n        this._calculatedBoxWidth = this._boxWidth(this.effectiveWidth(), this.xUnitCount());\n\n        this._box.whiskers(this._whiskers)\n            .width(this._calculatedBoxWidth)\n            .height(this.effectiveHeight())\n            .value(this.valueAccessor())\n            .domain(this.y().domain())\n            .duration(this.transitionDuration())\n            .tickFormat(this._tickFormat)\n            .renderDataPoints(this._renderDataPoints)\n            .dataOpacity(this._dataOpacity)\n            .dataWidthPortion(this._dataWidthPortion)\n            .renderTitle(this.renderTitle())\n            .showOutliers(this._showOutliers)\n            .boldOutlier(this._boldOutlier);\n\n        const boxesG = this.chartBodyG().selectAll('g.box').data(this.data(), this.keyAccessor());\n\n        const boxesGEnterUpdate = this._renderBoxes(boxesG);\n        this._updateBoxes(boxesGEnterUpdate);\n        this._removeBoxes(boxesG);\n\n        this.fadeDeselectedArea(this.filter());\n    }\n\n    _renderBoxes (boxesG) {\n        const boxesGEnter = boxesG.enter().append('g');\n\n        boxesGEnter\n            .attr('class', 'box')\n            .classed('dc-tabbable', this._keyboardAccessible)\n            .attr('transform', (d, i) => this._boxTransform(d, i))\n            .call(this._box)\n            .on('click', adaptHandler(d => {\n                this.filter(this.keyAccessor()(d));\n                this.redrawGroup();\n            }))\n            .selectAll('circle')\n            .classed('dc-tabbable', this._keyboardAccessible);\n\n        if (this._keyboardAccessible) {\n            this._makeKeyboardAccessible(this.onClick);\n        }\n\n        return boxesGEnter.merge(boxesG);\n    }\n\n    _updateBoxes (boxesG) {\n        const chart = this;\n        transition(boxesG, this.transitionDuration(), this.transitionDelay())\n            .attr('transform', (d, i) => this._boxTransform(d, i))\n            .call(this._box)\n            .each(function (d) {\n                const color = chart.getColor(d, 0);\n                select(this).select('rect.box').attr('fill', color);\n                select(this).selectAll('circle.data').attr('fill', color);\n            });\n    }\n\n    _removeBoxes (boxesG) {\n        boxesG.exit().remove().call(this._box);\n    }\n\n    _minDataValue () {\n        return min(this.data(), e => min(this.valueAccessor()(e)));\n    }\n\n    _maxDataValue () {\n        return max(this.data(), e => max(this.valueAccessor()(e)));\n    }\n\n    _yAxisRangeRatio () {\n        return ((this._maxDataValue() - this._minDataValue()) / this.effectiveHeight());\n    }\n\n    onClick (d) {\n        this.filter(this.keyAccessor()(d));\n        this.redrawGroup();\n    }\n\n    fadeDeselectedArea (brushSelection) {\n        const chart = this;\n        if (this.hasFilter()) {\n            if (this.isOrdinal()) {\n                this.g().selectAll('g.box').each(function (d) {\n                    if (chart.isSelectedNode(d)) {\n                        chart.highlightSelected(this);\n                    } else {\n                        chart.fadeDeselected(this);\n                    }\n                });\n            } else {\n                if (!(this.brushOn() || this.parentBrushOn())) {\n                    return;\n                }\n                const start = brushSelection[0];\n                const end = brushSelection[1];\n                this.g().selectAll('g.box').each(function (d) {\n                    const key = chart.keyAccessor()(d);\n                    if (key < start || key >= end) {\n                        chart.fadeDeselected(this);\n                    } else {\n                        chart.highlightSelected(this);\n                    }\n                });\n            }\n        } else {\n            this.g().selectAll('g.box').each(function () {\n                chart.resetHighlight(this);\n            });\n        }\n    }\n\n    isSelectedNode (d) {\n        return this.hasFilter(this.keyAccessor()(d));\n    }\n\n    yAxisMin () {\n        const padding = this._yRangePadding * this._yAxisRangeRatio();\n        return utils.subtract(this._minDataValue() - padding, this.yAxisPadding());\n    }\n\n    yAxisMax () {\n        const padding = this._yRangePadding * this._yAxisRangeRatio();\n        return utils.add(this._maxDataValue() + padding, this.yAxisPadding());\n    }\n\n    /**\n     * Get or set the numerical format of the boxplot median, whiskers and quartile labels. Defaults\n     * to integer formatting.\n     * @example\n     * // format ticks to 2 decimal places\n     * chart.tickFormat(d3.format('.2f'));\n     * @param {Function} [tickFormat]\n     * @returns {Number|Function|BoxPlot}\n     */\n    tickFormat (tickFormat) {\n        if (!arguments.length) {\n            return this._tickFormat;\n        }\n        this._tickFormat = tickFormat;\n        return this;\n    }\n\n    /**\n     * Get or set the amount of padding to add, in pixel coordinates, to the top and\n     * bottom of the chart to accommodate box/whisker labels.\n     * @example\n     * // allow more space for a bigger whisker font\n     * chart.yRangePadding(12);\n     * @param {Function} [yRangePadding = 8]\n     * @returns {Number|Function|BoxPlot}\n     */\n    yRangePadding (yRangePadding) {\n        if (!arguments.length) {\n            return this._yRangePadding;\n        }\n        this._yRangePadding = yRangePadding;\n        return this;\n    }\n\n    /**\n     * Get or set whether individual data points will be rendered.\n     * @example\n     * // Enable rendering of individual data points\n     * chart.renderDataPoints(true);\n     * @param {Boolean} [show=false]\n     * @returns {Boolean|BoxPlot}\n     */\n    renderDataPoints (show) {\n        if (!arguments.length) {\n            return this._renderDataPoints;\n        }\n        this._renderDataPoints = show;\n        return this;\n    }\n\n    /**\n     * Get or set the opacity when rendering data.\n     * @example\n     * // If individual data points are rendered increase the opacity.\n     * chart.dataOpacity(0.7);\n     * @param {Number} [opacity=0.3]\n     * @returns {Number|BoxPlot}\n     */\n    dataOpacity (opacity) {\n        if (!arguments.length) {\n            return this._dataOpacity;\n        }\n        this._dataOpacity = opacity;\n        return this;\n    }\n\n    /**\n     * Get or set the portion of the width of the box to show data points.\n     * @example\n     * // If individual data points are rendered increase the data box.\n     * chart.dataWidthPortion(0.9);\n     * @param {Number} [percentage=0.8]\n     * @returns {Number|BoxPlot}\n     */\n    dataWidthPortion (percentage) {\n        if (!arguments.length) {\n            return this._dataWidthPortion;\n        }\n        this._dataWidthPortion = percentage;\n        return this;\n    }\n\n    /**\n     * Get or set whether outliers will be rendered.\n     * @example\n     * // Disable rendering of outliers\n     * chart.showOutliers(false);\n     * @param {Boolean} [show=true]\n     * @returns {Boolean|BoxPlot}\n     */\n    showOutliers (show) {\n        if (!arguments.length) {\n            return this._showOutliers;\n        }\n        this._showOutliers = show;\n        return this;\n    }\n\n    /**\n     * Get or set whether outliers will be drawn bold.\n     * @example\n     * // If outliers are rendered display as bold\n     * chart.boldOutlier(true);\n     * @param {Boolean} [show=false]\n     * @returns {Boolean|BoxPlot}\n     */\n    boldOutlier (show) {\n        if (!arguments.length) {\n            return this._boldOutlier;\n        }\n        this._boldOutlier = show;\n        return this;\n    }\n}\n\nexport const boxPlot = (parent, chartGroup) => new BoxPlot(parent, chartGroup);\n","import {BubbleMixin} from '../base/bubble-mixin';\nimport {CoordinateGridMixin} from '../base/coordinate-grid-mixin';\nimport {transition} from '../core/core';\nimport {adaptHandler} from '../core/d3compat';\n\n/**\n * A concrete implementation of a general purpose bubble chart that allows data visualization using the\n * following dimensions:\n * - x axis position\n * - y axis position\n * - bubble radius\n * - color\n *\n * Examples:\n * - {@link http://dc-js.github.com/dc.js/ Nasdaq 100 Index}\n * - {@link http://dc-js.github.com/dc.js/vc/index.html US Venture Capital Landscape 2011}\n * @mixes BubbleMixin\n * @mixes CoordinateGridMixin\n */\nexport class BubbleChart extends BubbleMixin(CoordinateGridMixin) {\n    /**\n     * Create a Bubble Chart.\n     *\n     * @example\n     * // create a bubble chart under #chart-container1 element using the default global chart group\n     * var bubbleChart1 = new BubbleChart('#chart-container1');\n     * // create a bubble chart under #chart-container2 element using chart group A\n     * var bubbleChart2 = new BubbleChart('#chart-container2', 'chartGroupA');\n     * @param {String|node|d3.selection} parent - Any valid\n     * {@link https://github.com/d3/d3-selection/blob/master/README.md#select d3 single selector} specifying\n     * a dom block element such as a div; or a dom element or d3 selection.\n     * @param {String} [chartGroup] - The name of the chart group this chart instance should be placed in.\n     * Interaction with a chart will only trigger events and redraws within the chart's group.\n     */\n    constructor (parent, chartGroup) {\n        super();\n\n        this.transitionDuration(750);\n\n        this.transitionDelay(0);\n\n        this.anchor(parent, chartGroup);\n    }\n\n    _bubbleLocator (d) {\n        return `translate(${this._bubbleX(d)},${this._bubbleY(d)})`;\n    }\n\n    plotData () {\n        this.calculateRadiusDomain();\n        this.r().range([this.MIN_RADIUS, this.xAxisLength() * this.maxBubbleRelativeSize()]);\n\n        const data = this.data();\n        let bubbleG = this.chartBodyG().selectAll(`g.${this.BUBBLE_NODE_CLASS}`)\n            .data(data, d => d.key);\n        if (this.sortBubbleSize() || this.keyboardAccessible()) {\n            // update dom order based on sort\n            bubbleG.order();\n        }\n\n        this._removeNodes(bubbleG);\n\n        bubbleG = this._renderNodes(bubbleG);\n\n        this._updateNodes(bubbleG);\n\n        this.fadeDeselectedArea(this.filter());\n    }\n\n    _renderNodes (bubbleG) {\n        const bubbleGEnter = bubbleG.enter().append('g');\n\n        bubbleGEnter\n            .attr('class', this.BUBBLE_NODE_CLASS)\n            .attr('transform', d => this._bubbleLocator(d))\n            .append('circle').attr('class', (d, i) => `${this.BUBBLE_CLASS} _${i}`)\n            .on('click', adaptHandler(d => this.onClick(d)))\n            .classed('dc-tabbable', this._keyboardAccessible)\n            .attr('fill', this.getColor)\n            .attr('r', 0);\n\n        bubbleG = bubbleGEnter.merge(bubbleG);\n\n        transition(bubbleG, this.transitionDuration(), this.transitionDelay())\n            .select(`circle.${this.BUBBLE_CLASS}`)\n            .attr('r', d => this.bubbleR(d))\n            .attr('opacity', d => (this.bubbleR(d) > 0) ? 1 : 0);\n\n        if (this._keyboardAccessible) {\n            this._makeKeyboardAccessible(this.onClick);\n        }\n\n        this._doRenderLabel(bubbleGEnter);\n\n        this._doRenderTitles(bubbleGEnter);\n\n        return bubbleG;\n    }\n\n    _updateNodes (bubbleG) {\n        transition(bubbleG, this.transitionDuration(), this.transitionDelay())\n            .attr('transform', d => this._bubbleLocator(d))\n            .select(`circle.${this.BUBBLE_CLASS}`)\n            .attr('fill', this.getColor)\n            .attr('r', d => this.bubbleR(d))\n            .attr('opacity', d => (this.bubbleR(d) > 0) ? 1 : 0);\n\n        this.doUpdateLabels(bubbleG);\n        this.doUpdateTitles(bubbleG);\n    }\n\n    _removeNodes (bubbleG) {\n        bubbleG.exit().remove();\n    }\n\n    _bubbleX (d) {\n        let x = this.x()(this.keyAccessor()(d));\n        if (isNaN(x) || !isFinite(x)) {\n            x = 0;\n        }\n        return x;\n    }\n\n    _bubbleY (d) {\n        let y = this.y()(this.valueAccessor()(d));\n        if (isNaN(y) || !isFinite(y)) {\n            y = 0;\n        }\n        return y;\n    }\n\n    renderBrush () {\n        // override default x axis brush from parent chart\n    }\n\n    redrawBrush (brushSelection, doTransition) {\n        // override default x axis brush from parent chart\n        this.fadeDeselectedArea(brushSelection);\n    }\n}\n\nexport const bubbleChart = (parent, chartGroup) => new BubbleChart(parent, chartGroup);\n","import {mouse} from 'd3-selection';\n\nimport {BaseMixin} from '../base/base-mixin';\nimport {BubbleMixin} from '../base/bubble-mixin';\nimport {transition} from '../core/core';\nimport {constants} from '../core/constants';\nimport {utils} from '../core/utils';\nimport {adaptHandler} from '../core/d3compat';\n\nconst BUBBLE_OVERLAY_CLASS = 'bubble-overlay';\nconst BUBBLE_NODE_CLASS = 'node';\nconst BUBBLE_CLASS = 'bubble';\n\n/**\n * The bubble overlay chart is quite different from the typical bubble chart. With the bubble overlay\n * chart you can arbitrarily place bubbles on an existing svg or bitmap image, thus changing the\n * typical x and y positioning while retaining the capability to visualize data using bubble radius\n * and coloring.\n *\n * Examples:\n * - {@link http://dc-js.github.com/dc.js/crime/index.html Canadian City Crime Stats}\n * @mixes BubbleMixin\n * @mixes BaseMixin\n */\nexport class BubbleOverlay extends BubbleMixin(BaseMixin) {\n    /**\n     * Create a Bubble Overlay.\n     *\n     * @example\n     * // create a bubble overlay chart on top of the '#chart-container1 svg' element using the default global chart group\n     * var bubbleChart1 = BubbleOverlayChart('#chart-container1').svg(d3.select('#chart-container1 svg'));\n     * // create a bubble overlay chart on top of the '#chart-container2 svg' element using chart group A\n     * var bubbleChart2 = new CompositeChart('#chart-container2', 'chartGroupA').svg(d3.select('#chart-container2 svg'));\n     * @param {String|node|d3.selection} parent - Any valid\n     * {@link https://github.com/d3/d3-selection/blob/master/README.md#select d3 single selector} specifying\n     * a dom block element such as a div; or a dom element or d3 selection.\n     * @param {String} [chartGroup] - The name of the chart group this chart instance should be placed in.\n     * Interaction with a chart will only trigger events and redraws within the chart's group.\n     */\n    constructor (parent, chartGroup) {\n        super();\n\n        /**\n         * **mandatory**\n         *\n         * Set the underlying svg image element. Unlike other dc charts this chart will not generate a svg\n         * element; therefore the bubble overlay chart will not work if this function is not invoked. If the\n         * underlying image is a bitmap, then an empty svg will need to be created on top of the image.\n         * @example\n         * // set up underlying svg element\n         * chart.svg(d3.select('#chart svg'));\n         * @param {SVGElement|d3.selection} [imageElement]\n         * @returns {BubbleOverlay}\n         */\n        this._g = undefined;\n        this._points = [];\n        this._keyboardAccessible = false;\n\n        this.transitionDuration(750);\n\n        this.transitionDelay(0);\n\n        this.radiusValueAccessor(d => d.value);\n\n        this.anchor(parent, chartGroup);\n    }\n\n    /**\n     * **mandatory**\n     *\n     * Set up a data point on the overlay. The name of a data point should match a specific 'key' among\n     * data groups generated using keyAccessor.  If a match is found (point name <-> data group key)\n     * then a bubble will be generated at the position specified by the function. x and y\n     * value specified here are relative to the underlying svg.\n     * @param {String} name\n     * @param {Number} x\n     * @param {Number} y\n     * @returns {BubbleOverlay}\n     */\n    point (name, x, y) {\n        this._points.push({name: name, x: x, y: y});\n        return this;\n    }\n\n    _doRender () {\n        this._g = this._initOverlayG();\n\n        this.r().range([this.MIN_RADIUS, this.width() * this.maxBubbleRelativeSize()]);\n\n        this._initializeBubbles();\n\n        this.fadeDeselectedArea(this.filter());\n\n        return this;\n    }\n\n    _initOverlayG () {\n        this._g = this.select(`g.${BUBBLE_OVERLAY_CLASS}`);\n        if (this._g.empty()) {\n            this._g = this.svg().append('g').attr('class', BUBBLE_OVERLAY_CLASS);\n        }\n        return this._g;\n    }\n\n    _initializeBubbles () {\n        const data = this._mapData();\n        this.calculateRadiusDomain();\n\n        this._points.forEach(point => {\n            const nodeG = this._getNodeG(point, data);\n\n            let circle = nodeG.select(`circle.${BUBBLE_CLASS}`);\n\n            if (circle.empty()) {\n                circle = nodeG.append('circle')\n                    .attr('class', BUBBLE_CLASS)\n                    .classed('dc-tabbable', this._keyboardAccessible)\n                    .attr('r', 0)\n                    .attr('fill', this.getColor)\n                    .on('click', adaptHandler(d => this.onClick(d)));\n            }\n\n            if (this._keyboardAccessible) {\n                this._makeKeyboardAccessible(this.onClick);\n            }\n\n            transition(circle, this.transitionDuration(), this.transitionDelay())\n                .attr('r', d => this.bubbleR(d));\n\n            this._doRenderLabel(nodeG);\n\n            this._doRenderTitles(nodeG);\n        });\n    }\n\n    _mapData () {\n        const data = {};\n        this.data().forEach(datum => {\n            data[this.keyAccessor()(datum)] = datum;\n        });\n        return data;\n    }\n\n    _getNodeG (point, data) {\n        const bubbleNodeClass = `${BUBBLE_NODE_CLASS} ${utils.nameToId(point.name)}`;\n\n        let nodeG = this._g.select(`g.${utils.nameToId(point.name)}`);\n\n        if (nodeG.empty()) {\n            nodeG = this._g.append('g')\n                .attr('class', bubbleNodeClass)\n                .attr('transform', `translate(${point.x},${point.y})`);\n        }\n\n        nodeG.datum(data[point.name]);\n\n        return nodeG;\n    }\n\n    _doRedraw () {\n        this._updateBubbles();\n\n        this.fadeDeselectedArea(this.filter());\n\n        return this;\n    }\n\n    _updateBubbles () {\n        const data = this._mapData();\n        this.calculateRadiusDomain();\n\n        this._points.forEach(point => {\n            const nodeG = this._getNodeG(point, data);\n\n            const circle = nodeG.select(`circle.${BUBBLE_CLASS}`);\n\n            transition(circle, this.transitionDuration(), this.transitionDelay())\n                .attr('r', d => this.bubbleR(d))\n                .attr('fill', this.getColor);\n\n            this.doUpdateLabels(nodeG);\n\n            this.doUpdateTitles(nodeG);\n        });\n    }\n\n    debug (flag) {\n        if (flag) {\n            let debugG = this.select(`g.${constants.DEBUG_GROUP_CLASS}`);\n\n            if (debugG.empty()) {\n                debugG = this.svg()\n                    .append('g')\n                    .attr('class', constants.DEBUG_GROUP_CLASS);\n            }\n\n            const debugText = debugG.append('text')\n                .attr('x', 10)\n                .attr('y', 20);\n\n            debugG\n                .append('rect')\n                .attr('width', this.width())\n                .attr('height', this.height())\n                .on('mousemove', () => {\n                    const position = mouse(debugG.node());\n                    const msg = `${position[0]}, ${position[1]}`;\n                    debugText.text(msg);\n                });\n        } else {\n            this.selectAll('.debug').remove();\n        }\n\n        return this;\n    }\n\n}\n\nexport const bubbleOverlay = (parent, chartGroup) => new BubbleOverlay(parent, chartGroup);\n","import {select} from 'd3-selection';\n\nimport {events} from '../core/events';\nimport {BaseMixin} from '../base/base-mixin';\nimport {utils} from '../core/utils'\nimport {adaptHandler} from '../core/d3compat';\n\nconst GROUP_CSS_CLASS = 'dc-cbox-group';\nconst ITEM_CSS_CLASS = 'dc-cbox-item';\n\n/**\n * The CboxMenu is a simple widget designed to filter a dimension by\n * selecting option(s) from a set of HTML `<input />` elements. The menu can be\n * made into a set of radio buttons (single select) or checkboxes (multiple).\n * @mixes BaseMixin\n */\nexport class CboxMenu extends BaseMixin {\n    /**\n     * Create a Cbox Menu.\n     *\n     * @example\n     * // create a cboxMenu under #cbox-container using the default global chart group\n     * var cbox = new CboxMenu('#cbox-container')\n     *                .dimension(states)\n     *                .group(stateGroup);\n     * // the option text can be set via the title() function\n     * // by default the option text is '`key`: `value`'\n     * cbox.title(function (d){\n     *     return 'STATE: ' + d.key;\n     * })\n     * @param {String|node|d3.selection|CompositeChart} parent - Any valid\n     * [d3 single selector](https://github.com/mbostock/d3/wiki/Selections#selecting-elements) specifying\n     * a dom block element such as a div; or a dom element or d3 selection.\n     * @param {String} [chartGroup] - The name of the chart group this widget should be placed in.\n     * Interaction with the widget will only trigger events and redraws within its group.\n     */\n    constructor (parent, chartGroup) {\n        super();\n\n        this._cbox = undefined;\n        this._promptText = 'Select all';\n        this._multiple = false;\n        this._inputType = 'radio';\n        this._promptValue = null;\n\n        this._uniqueId = utils.uniqueId();\n\n        this.data(group => group.all().filter(this._filterDisplayed));\n\n        // There is an accessor for this attribute, initialized with default value\n        this._filterDisplayed = d => this.valueAccessor()(d) > 0;\n\n        this._order = (a, b) => {\n            if (this.keyAccessor()(a) > this.keyAccessor()(b)) {\n                return 1;\n            }\n            if (this.keyAccessor()(a) < this.keyAccessor()(b)) {\n                return -1;\n            }\n            return 0;\n        };\n\n        this.anchor(parent, chartGroup);\n    }\n\n    _doRender () {\n        return this._doRedraw();\n    }\n\n    _doRedraw () {\n        this.select('ul').remove();\n        this._cbox = this.root()\n            .append('ul')\n            .classed(GROUP_CSS_CLASS, true);\n        this._renderOptions();\n\n        if (this.hasFilter() && this._multiple) {\n            this._cbox.selectAll('input')\n            // adding `false` avoids failing test cases in phantomjs\n                .property('checked', d => d && this.filters().indexOf(String(this.keyAccessor()(d))) >= 0 || false);\n        } else if (this.hasFilter()) {\n            this._cbox.selectAll('input')\n                .property('checked', d => {\n                    if (!d) {\n                        return false;\n                    }\n                    return this.keyAccessor()(d) === this.filter();\n                });\n        }\n        return this;\n    }\n\n    _renderOptions () {\n        let options = this._cbox\n            .selectAll(`li.${ITEM_CSS_CLASS}`)\n            .data(this.data(), d => this.keyAccessor()(d));\n\n        options.exit().remove();\n\n        options = options.enter()\n            .append('li')\n            .classed(ITEM_CSS_CLASS, true)\n            .merge(options);\n\n        options\n            .append('input')\n            .attr('type', this._inputType)\n            .attr('value', d => this.keyAccessor()(d))\n            .attr('name', `domain_${this._uniqueId}`)\n            .attr('id', (d, i) => `input_${this._uniqueId}_${i}`);\n        options\n            .append('label')\n            .attr('for', (d, i) => `input_${this._uniqueId}_${i}`)\n            .text(this.title());\n\n        const chart = this;\n        // 'all' option\n        if (this._multiple) {\n            this._cbox\n                .append('li')\n                .append('input')\n                .attr('type', 'reset')\n                .text(this._promptText)\n                .on('click', adaptHandler(function (d, evt) {\n                    return chart._onChange(d, evt, this);\n                }));\n        } else {\n            const li = this._cbox.append('li');\n            li.append('input')\n                .attr('type', this._inputType)\n                .attr('value', this._promptValue)\n                .attr('name', `domain_${this._uniqueId}`)\n                .attr('id', (d, i) => `input_${this._uniqueId}_all`)\n                .property('checked', true);\n            li.append('label')\n                .attr('for', (d, i) => `input_${this._uniqueId}_all`)\n                .text(this._promptText);\n        }\n\n        this._cbox\n            .selectAll(`li.${ITEM_CSS_CLASS}`)\n            .sort(this._order);\n\n        this._cbox.on('change', adaptHandler(function (d, evt) {\n            return chart._onChange(d, evt, this);\n        }));\n        return options;\n    }\n\n    _onChange (d, evt, element) {\n        let values;\n\n        const target = select(evt.target);\n        let options;\n\n        if (!target.datum()) {\n            values = this._promptValue || null;\n        } else {\n            options = select(element).selectAll('input')\n                .filter(function (o) {\n                    if (o) {\n                        return this.checked;\n                    }\n                });\n            values = options.nodes().map(option => option.value);\n            // check if only prompt option is selected\n            if (!this._multiple && values.length === 1) {\n                values = values[0];\n            }\n        }\n        this.onChange(values);\n    }\n\n    onChange (val) {\n        if (val && this._multiple) {\n            this.replaceFilter([val]);\n        } else if (val) {\n            this.replaceFilter(val);\n        } else {\n            this.filterAll();\n        }\n        events.trigger(() => {\n            this.redrawGroup();\n        });\n    }\n\n    /**\n     * Get or set the function that controls the ordering of option tags in the\n     * cbox menu. By default options are ordered by the group key in ascending\n     * order.\n     * @param {Function} [order]\n     * @returns {Function|CboxMenu}\n     * @example\n     * // order by the group's value\n     * chart.order(function (a,b) {\n     *     return a.value > b.value ? 1 : b.value > a.value ? -1 : 0;\n     * });\n     */\n    order (order) {\n        if (!arguments.length) {\n            return this._order;\n        }\n        this._order = order;\n        return this;\n    }\n\n    /**\n     * Get or set the text displayed in the options used to prompt selection.\n     * @param {String} [promptText='Select all']\n     * @returns {String|CboxMenu}\n     * @example\n     * chart.promptText('All states');\n     */\n    promptText (promptText) {\n        if (!arguments.length) {\n            return this._promptText;\n        }\n        this._promptText = promptText;\n        return this;\n    }\n\n    /**\n     * Get or set the function that filters options prior to display. By default options\n     * with a value of < 1 are not displayed.\n     * @param {function} [filterDisplayed]\n     * @returns {Function|CboxMenu}\n     * @example\n     * // display all options override the `filterDisplayed` function:\n     * chart.filterDisplayed(function () {\n     *     return true;\n     * });\n     */\n    filterDisplayed (filterDisplayed) {\n        if (!arguments.length) {\n            return this._filterDisplayed;\n        }\n        this._filterDisplayed = filterDisplayed;\n        return this;\n    }\n\n    /**\n     * Controls the type of input element. Setting it to true converts\n     * the HTML `input` tags from radio buttons to checkboxes.\n     * @param {boolean} [multiple=false]\n     * @returns {Boolean|CboxMenu}\n     * @example\n     * chart.multiple(true);\n     */\n    multiple (multiple) {\n        if (!arguments.length) {\n            return this._multiple;\n        }\n        this._multiple = multiple;\n        if (this._multiple) {\n            this._inputType = 'checkbox';\n        } else {\n            this._inputType = 'radio';\n        }\n        return this;\n    }\n\n    /**\n     * Controls the default value to be used for\n     * [dimension.filter](https://github.com/crossfilter/crossfilter/wiki/API-Reference#dimension_filter)\n     * when only the prompt value is selected. If `null` (the default), no filtering will occur when\n     * just the prompt is selected.\n     * @param {?*} [promptValue=null]\n     * @returns {*|CboxMenu}\n     */\n    promptValue (promptValue) {\n        if (!arguments.length) {\n            return this._promptValue;\n        }\n        this._promptValue = promptValue;\n\n        return this;\n    }\n}\n\nexport const cboxMenu = (parent, chartGroup) => new CboxMenu(parent, chartGroup);\n","import {min, max} from 'd3-array';\nimport {scaleLinear} from 'd3-scale';\nimport {axisRight} from 'd3-axis';\n\nimport {utils} from '../core/utils';\nimport {CoordinateGridMixin} from '../base/coordinate-grid-mixin';\n\nconst SUB_CHART_CLASS = 'sub';\nconst DEFAULT_RIGHT_Y_AXIS_LABEL_PADDING = 12;\n\n/**\n * Composite charts are a special kind of chart that render multiple charts on the same Coordinate\n * Grid. You can overlay (compose) different bar/line/area charts in a single composite chart to\n * achieve some quite flexible charting effects.\n * @mixes CoordinateGridMixin\n */\nexport class CompositeChart extends CoordinateGridMixin {\n    /**\n     * Create a Composite Chart.\n     * @example\n     * // create a composite chart under #chart-container1 element using the default global chart group\n     * var compositeChart1 = new CompositeChart('#chart-container1');\n     * // create a composite chart under #chart-container2 element using chart group A\n     * var compositeChart2 = new CompositeChart('#chart-container2', 'chartGroupA');\n     * @param {String|node|d3.selection} parent - Any valid\n     * {@link https://github.com/d3/d3-selection/blob/master/README.md#select d3 single selector} specifying\n     * a dom block element such as a div; or a dom element or d3 selection.\n     * @param {String} [chartGroup] - The name of the chart group this chart instance should be placed in.\n     * Interaction with a chart will only trigger events and redraws within the chart's group.\n     */\n    constructor (parent, chartGroup) {\n        super();\n\n        this._children = [];\n\n        this._childOptions = {};\n\n        this._shareColors = false;\n        this._shareTitle = true;\n        this._alignYAxes = false;\n\n        this._rightYAxis = axisRight();\n        this._rightYAxisLabel = 0;\n        this._rightYAxisLabelPadding = DEFAULT_RIGHT_Y_AXIS_LABEL_PADDING;\n        this._rightY = undefined;\n        this._rightAxisGridLines = false;\n\n        this._mandatoryAttributes([]);\n        this.transitionDuration(500);\n        this.transitionDelay(0);\n\n        this.on('filtered.dcjs-composite-chart', chart => {\n            // Propagate the filters onto the children\n            // Notice that on children the call is .replaceFilter and not .filter\n            //   the reason is that _chart.filter() returns the entire current set of filters not just the last added one\n            for (let i = 0; i < this._children.length; ++i) {\n                this._children[i].replaceFilter(this.filter());\n            }\n        });\n\n        this.anchor(parent, chartGroup);\n    }\n\n    _generateG () {\n        const g = super._generateG();\n\n        for (let i = 0; i < this._children.length; ++i) {\n            const child = this._children[i];\n\n            this._generateChildG(child, i);\n\n            if (!child.dimension()) {\n                child.dimension(this.dimension());\n            }\n            if (!child.group()) {\n                child.group(this.group());\n            }\n\n            child.chartGroup(this.chartGroup());\n            child.svg(this.svg());\n            child.xUnits(this.xUnits());\n            child.transitionDuration(this.transitionDuration(), this.transitionDelay());\n            child.parentBrushOn(this.brushOn());\n            child.brushOn(false);\n            child.renderTitle(this.renderTitle());\n            child.elasticX(this.elasticX());\n        }\n\n        return g;\n    }\n\n    rescale () {\n        super.rescale();\n\n        this._children.forEach(child => {\n            child.rescale();\n        });\n\n        return this;\n    }\n\n    resizing (resizing) {\n        if (!arguments.length) {\n            return super.resizing();\n        }\n        super.resizing(resizing);\n\n        this._children.forEach(child => {\n            child.resizing(resizing);\n        });\n\n        return this;\n    }\n\n    _prepareYAxis () {\n        const left = (this._leftYAxisChildren().length !== 0);\n        const right = (this._rightYAxisChildren().length !== 0);\n        const ranges = this._calculateYAxisRanges(left, right);\n\n        if (left) {\n            this._prepareLeftYAxis(ranges);\n        }\n        if (right) {\n            this._prepareRightYAxis(ranges);\n        }\n\n        if (this._leftYAxisChildren().length > 0 && !this._rightAxisGridLines) {\n            this._renderHorizontalGridLinesForAxis(this.g(), this.y(), this.yAxis());\n        } else if (this._rightYAxisChildren().length > 0) {\n            this._renderHorizontalGridLinesForAxis(this.g(), this._rightY, this._rightYAxis);\n        }\n    }\n\n    renderYAxis () {\n        if (this._leftYAxisChildren().length !== 0) {\n            this.renderYAxisAt('y', this.yAxis(), this.margins().left);\n            this.renderYAxisLabel('y', this.yAxisLabel(), -90);\n        }\n\n        if (this._rightYAxisChildren().length !== 0) {\n            this.renderYAxisAt('yr', this.rightYAxis(), this.width() - this.margins().right);\n            this.renderYAxisLabel('yr', this.rightYAxisLabel(), 90, this.width() - this._rightYAxisLabelPadding);\n        }\n    }\n\n    _calculateYAxisRanges (left, right) {\n        let lyAxisMin, lyAxisMax, ryAxisMin, ryAxisMax;\n        let ranges;\n\n        if (left) {\n            lyAxisMin = this._yAxisMin();\n            lyAxisMax = this._yAxisMax();\n        }\n\n        if (right) {\n            ryAxisMin = this._rightYAxisMin();\n            ryAxisMax = this._rightYAxisMax();\n        }\n\n        if (this.alignYAxes() && left && right) {\n            ranges = this._alignYAxisRanges(lyAxisMin, lyAxisMax, ryAxisMin, ryAxisMax);\n        }\n\n        return ranges || {\n            lyAxisMin: lyAxisMin,\n            lyAxisMax: lyAxisMax,\n            ryAxisMin: ryAxisMin,\n            ryAxisMax: ryAxisMax\n        };\n    }\n\n    _alignYAxisRanges (lyAxisMin, lyAxisMax, ryAxisMin, ryAxisMax) {\n        // since the two series will share a zero, each Y is just a multiple\n        // of the other. and the ratio should be the ratio of the ranges of the\n        // input data, so that they come out the same height. so we just min/max\n\n        // note: both ranges already include zero due to the stack mixin (#667)\n        // if #667 changes, we can reconsider whether we want data height or\n        // height from zero to be equal. and it will be possible for the axes\n        // to be aligned but not visible.\n        const extentRatio = (ryAxisMax - ryAxisMin) / (lyAxisMax - lyAxisMin);\n\n        return {\n            lyAxisMin: Math.min(lyAxisMin, ryAxisMin / extentRatio),\n            lyAxisMax: Math.max(lyAxisMax, ryAxisMax / extentRatio),\n            ryAxisMin: Math.min(ryAxisMin, lyAxisMin * extentRatio),\n            ryAxisMax: Math.max(ryAxisMax, lyAxisMax * extentRatio)\n        };\n    }\n\n    _prepareRightYAxis (ranges) {\n        const needDomain = this.rightY() === undefined || this.elasticY(),\n            needRange = needDomain || this.resizing();\n        if (this.rightY() === undefined) {\n            this.rightY(scaleLinear());\n        }\n        if (needDomain) {\n            this.rightY().domain([ranges.ryAxisMin, ranges.ryAxisMax]);\n        }\n        if (needRange) {\n            this.rightY().rangeRound([this.yAxisHeight(), 0]);\n        }\n\n        this.rightY().range([this.yAxisHeight(), 0]);\n        this.rightYAxis(this.rightYAxis().scale(this.rightY()));\n\n        // In D3v4 create a RightAxis\n        // _chart.rightYAxis().orient('right');\n    }\n\n    _prepareLeftYAxis (ranges) {\n        const needDomain = this.y() === undefined || this.elasticY(),\n            needRange = needDomain || this.resizing();\n        if (this.y() === undefined) {\n            this.y(scaleLinear());\n        }\n        if (needDomain) {\n            this.y().domain([ranges.lyAxisMin, ranges.lyAxisMax]);\n        }\n        if (needRange) {\n            this.y().rangeRound([this.yAxisHeight(), 0]);\n        }\n\n        this.y().range([this.yAxisHeight(), 0]);\n        this.yAxis(this.yAxis().scale(this.y()));\n\n        // In D3v4 create a LeftAxis\n        // _chart.yAxis().orient('left');\n    }\n\n    _generateChildG (child, i) {\n        child._generateG(this.g());\n        child.g().attr('class', `${SUB_CHART_CLASS} _${i}`);\n    }\n\n    plotData () {\n        for (let i = 0; i < this._children.length; ++i) {\n            const child = this._children[i];\n\n            if (!child.g()) {\n                this._generateChildG(child, i);\n            }\n\n            if (this._shareColors) {\n                child.colors(this.colors());\n            }\n\n            child.x(this.x());\n\n            child.xAxis(this.xAxis());\n\n            if (child.useRightYAxis()) {\n                child.y(this.rightY());\n                child.yAxis(this.rightYAxis());\n            } else {\n                child.y(this.y());\n                child.yAxis(this.yAxis());\n            }\n\n            child.plotData();\n\n            child._activateRenderlets();\n        }\n    }\n\n    /**\n     * Get or set whether to draw gridlines from the right y axis.  Drawing from the left y axis is the\n     * default behavior. This option is only respected when subcharts with both left and right y-axes\n     * are present.\n     * @param {Boolean} [useRightAxisGridLines=false]\n     * @returns {Boolean|CompositeChart}\n     */\n    useRightAxisGridLines (useRightAxisGridLines) {\n        if (!arguments) {\n            return this._rightAxisGridLines;\n        }\n\n        this._rightAxisGridLines = useRightAxisGridLines;\n        return this;\n    }\n\n    /**\n     * Get or set chart-specific options for all child charts. This is equivalent to calling\n     * {@link BaseMixin#options .options} on each child chart.\n     * @param {Object} [childOptions]\n     * @returns {Object|CompositeChart}\n     */\n    childOptions (childOptions) {\n        if (!arguments.length) {\n            return this._childOptions;\n        }\n        this._childOptions = childOptions;\n        this._children.forEach(child => {\n            child.options(this._childOptions);\n        });\n        return this;\n    }\n\n    fadeDeselectedArea (brushSelection) {\n        if (this.brushOn()) {\n            for (let i = 0; i < this._children.length; ++i) {\n                const child = this._children[i];\n                child.fadeDeselectedArea(brushSelection);\n            }\n        }\n    }\n\n    /**\n     * Set or get the right y axis label.\n     * @param {String} [rightYAxisLabel]\n     * @param {Number} [padding]\n     * @returns {String|CompositeChart}\n     */\n    rightYAxisLabel (rightYAxisLabel, padding) {\n        if (!arguments.length) {\n            return this._rightYAxisLabel;\n        }\n        this._rightYAxisLabel = rightYAxisLabel;\n        this.margins().right -= this._rightYAxisLabelPadding;\n        this._rightYAxisLabelPadding = (padding === undefined) ? DEFAULT_RIGHT_Y_AXIS_LABEL_PADDING : padding;\n        this.margins().right += this._rightYAxisLabelPadding;\n        return this;\n    }\n\n    /**\n     * Combine the given charts into one single composite coordinate grid chart.\n     * @example\n     * moveChart.compose([\n     *     // when creating sub-chart you need to pass in the parent chart\n     *     new LineChart(moveChart)\n     *         .group(indexAvgByMonthGroup) // if group is missing then parent's group will be used\n     *         .valueAccessor(function (d){return d.value.avg;})\n     *         // most of the normal functions will continue to work in a composed chart\n     *         .renderArea(true)\n     *         .stack(monthlyMoveGroup, function (d){return d.value;})\n     *         .title(function (d){\n     *             var value = d.value.avg?d.value.avg:d.value;\n     *             if(isNaN(value)) value = 0;\n     *             return dateFormat(d.key) + '\\n' + numberFormat(value);\n     *         }),\n     *     new BarChart(moveChart)\n     *         .group(volumeByMonthGroup)\n     *         .centerBar(true)\n     * ]);\n     * @param {Array<Chart>} [subChartArray]\n     * @returns {CompositeChart}\n     */\n    compose (subChartArray) {\n        this._children = subChartArray;\n        this._children.forEach(child => {\n            child.height(this.height());\n            child.width(this.width());\n            child.margins(this.margins());\n\n            if (this._shareTitle) {\n                child.title(this.title());\n            }\n\n            child.options(this._childOptions);\n        });\n        this.rescale();\n        return this;\n    }\n\n    _setChildrenProperty (prop, value) {\n        this._children.forEach(child => {\n            child[prop](value);\n        });\n    }\n\n    // properties passed through in compose()\n    height (height) {\n        if(!arguments.length) {\n            return super.height();\n        }\n        super.height(height);\n        this._setChildrenProperty('height', height);\n        return this;\n    }\n\n    width (width) {\n        if(!arguments.length) {\n            return super.width();\n        }\n        super.width(width);\n        this._setChildrenProperty('width', width);\n        return this;\n    }\n\n    margins (margins) {\n        if(!arguments.length) {\n            return super.margins();\n        }\n        super.margins(margins);\n        this._setChildrenProperty('margins', margins);\n        return this;\n    }\n\n    /**\n     * Returns the child charts which are composed into the composite chart.\n     * @returns {Array<BaseMixin>}\n     */\n    children () {\n        return this._children;\n    }\n\n    /**\n     * Get or set color sharing for the chart. If set, the {@link ColorMixin#colors .colors()} value from this chart\n     * will be shared with composed children. Additionally if the child chart implements\n     * Stackable and has not set a custom .colorAccessor, then it will generate a color\n     * specific to its order in the composition.\n     * @param {Boolean} [shareColors=false]\n     * @returns {Boolean|CompositeChart}\n     */\n    shareColors (shareColors) {\n        if (!arguments.length) {\n            return this._shareColors;\n        }\n        this._shareColors = shareColors;\n        return this;\n    }\n\n    /**\n     * Get or set title sharing for the chart. If set, the {@link BaseMixin#title .title()} value from\n     * this chart will be shared with composed children.\n     *\n     * Note: currently you must call this before `compose` or the child will still get the parent's\n     * `title` function!\n     * @param {Boolean} [shareTitle=true]\n     * @returns {Boolean|CompositeChart}\n     */\n    shareTitle (shareTitle) {\n        if (!arguments.length) {\n            return this._shareTitle;\n        }\n        this._shareTitle = shareTitle;\n        return this;\n    }\n\n    /**\n     * Get or set the y scale for the right axis. The right y scale is typically automatically\n     * generated by the chart implementation.\n     * @see {@link https://github.com/d3/d3-scale/blob/master/README.md d3.scale}\n     * @param {d3.scale} [yScale]\n     * @returns {d3.scale|CompositeChart}\n     */\n    rightY (yScale) {\n        if (!arguments.length) {\n            return this._rightY;\n        }\n        this._rightY = yScale;\n        this.rescale();\n        return this;\n    }\n\n    /**\n     * Get or set alignment between left and right y axes. A line connecting '0' on both y axis\n     * will be parallel to x axis. This only has effect when {@link CoordinateGridMixin#elasticY elasticY} is true.\n     * @param {Boolean} [alignYAxes=false]\n     * @returns {Chart}\n     */\n    alignYAxes (alignYAxes) {\n        if (!arguments.length) {\n            return this._alignYAxes;\n        }\n        this._alignYAxes = alignYAxes;\n        this.rescale();\n        return this;\n    }\n\n    _leftYAxisChildren () {\n        return this._children.filter(child => !child.useRightYAxis());\n    }\n\n    _rightYAxisChildren () {\n        return this._children.filter(child => child.useRightYAxis());\n    }\n\n    _getYAxisMin (charts) {\n        return charts.map(c => c.yAxisMin());\n    }\n\n    _yAxisMin () {\n        return min(this._getYAxisMin(this._leftYAxisChildren()));\n    }\n\n    _rightYAxisMin () {\n        return min(this._getYAxisMin(this._rightYAxisChildren()));\n    }\n\n    _getYAxisMax (charts) {\n        return charts.map(c => c.yAxisMax());\n    }\n\n    _yAxisMax () {\n        return utils.add(max(this._getYAxisMax(this._leftYAxisChildren())), this.yAxisPadding());\n    }\n\n    _rightYAxisMax () {\n        return utils.add(max(this._getYAxisMax(this._rightYAxisChildren())), this.yAxisPadding());\n    }\n\n    _getAllXAxisMinFromChildCharts () {\n        return this._children.map(c => c.xAxisMin());\n    }\n\n    xAxisMin () {\n        return utils.subtract(min(this._getAllXAxisMinFromChildCharts()), this.xAxisPadding(), this.xAxisPaddingUnit());\n    }\n\n    _getAllXAxisMaxFromChildCharts () {\n        return this._children.map(c => c.xAxisMax());\n    }\n\n    xAxisMax () {\n        return utils.add(max(this._getAllXAxisMaxFromChildCharts()), this.xAxisPadding(), this.xAxisPaddingUnit());\n    }\n\n    legendables () {\n        return this._children.reduce((items, child) => {\n            if (this._shareColors) {\n                child.colors(this.colors());\n            }\n            items.push.apply(items, child.legendables());\n            return items;\n        }, []);\n    }\n\n    legendHighlight (d) {\n        for (let j = 0; j < this._children.length; ++j) {\n            const child = this._children[j];\n            child.legendHighlight(d);\n        }\n    }\n\n    legendReset (d) {\n        for (let j = 0; j < this._children.length; ++j) {\n            const child = this._children[j];\n            child.legendReset(d);\n        }\n    }\n\n    legendToggle () {\n        console.log('composite should not be getting legendToggle itself');\n    }\n\n    /**\n     * Set or get the right y axis used by the composite chart. This function is most useful when y\n     * axis customization is required. The y axis in dc.js is an instance of a\n     * [d3.axisRight](https://github.com/d3/d3-axis/blob/master/README.md#axisRight) therefore it supports any valid\n     * d3 axis manipulation.\n     *\n     * **Caution**: The right y axis is usually generated internally by dc; resetting it may cause\n     * unexpected results.  Note also that when used as a getter, this function is not chainable: it\n     * returns the axis, not the chart,\n     * {@link https://github.com/dc-js/dc.js/wiki/FAQ#why-does-everything-break-after-a-call-to-xaxis-or-yaxis\n     * so attempting to call chart functions after calling `.yAxis()` will fail}.\n     * @see {@link https://github.com/d3/d3-axis/blob/master/README.md#axisRight}\n     * @example\n     * // customize y axis tick format\n     * chart.rightYAxis().tickFormat(function (v) {return v + '%';});\n     * // customize y axis tick values\n     * chart.rightYAxis().tickValues([0, 100, 200, 300]);\n     * @param {d3.axisRight} [rightYAxis]\n     * @returns {d3.axisRight|CompositeChart}\n     */\n    rightYAxis (rightYAxis) {\n        if (!arguments.length) {\n            return this._rightYAxis;\n        }\n        this._rightYAxis = rightYAxis;\n        return this;\n    }\n\n    yAxisMin () {\n        throw new Error('Not supported for this chart type');\n    }\n\n    yAxisMax () {\n        throw new Error('Not supported for this chart type');\n    }\n}\n\nexport const compositeChart = (parent, chartGroup) => new CompositeChart(parent, chartGroup);\n","import {format} from 'd3-format';\n\nimport {logger} from '../core/logger';\nimport {BaseMixin} from '../base/base-mixin';\n\n/**\n * The data count widget is a simple widget designed to display the number of records selected by the\n * current filters out of the total number of records in the data set. Once created the data count widget\n * will automatically update the text content of child elements with the following classes:\n *\n * * `.total-count` - total number of records\n * * `.filter-count` - number of records matched by the current filters\n *\n * Note: this widget works best for the specific case of showing the number of records out of a\n * total. If you want a more general-purpose numeric display, please use the\n * {@link NumberDisplay} widget instead.\n *\n * Examples:\n * - {@link http://dc-js.github.com/dc.js/ Nasdaq 100 Index}\n * @mixes BaseMixin\n */\nexport class DataCount extends BaseMixin {\n    /**\n     * Create a Data Count widget.\n     * @example\n     * var ndx = crossfilter(data);\n     * var all = ndx.groupAll();\n     *\n     * new DataCount('.dc-data-count')\n     *     .crossfilter(ndx)\n     *     .groupAll(all);\n     * @param {String|node|d3.selection} parent - Any valid\n     * {@link https://github.com/d3/d3-selection/blob/master/README.md#select d3 single selector} specifying\n     * a dom block element such as a div; or a dom element or d3 selection.\n     * @param {String} [chartGroup] - The name of the chart group this chart instance should be placed in.\n     * Interaction with a chart will only trigger events and redraws within the chart's group.\n     */\n    constructor (parent, chartGroup) {\n        super();\n\n        this._formatNumber = format(',d');\n        this._crossfilter = null;\n        this._groupAll = null;\n        this._html = {some: '', all: ''};\n\n        this._mandatoryAttributes(['crossfilter', 'groupAll']);\n\n        this.anchor(parent, chartGroup);\n    }\n\n    /**\n     * Gets or sets an optional object specifying HTML templates to use depending how many items are\n     * selected. The text `%total-count` will replaced with the total number of records, and the text\n     * `%filter-count` will be replaced with the number of selected records.\n     * - all: HTML template to use if all items are selected\n     * - some: HTML template to use if not all items are selected\n     * @example\n     * counter.html({\n     *      some: '%filter-count out of %total-count records selected',\n     *      all: 'All records selected. Click on charts to apply filters'\n     * })\n     * @param {{some:String, all: String}} [options]\n     * @returns {{some:String, all: String}|DataCount}\n     */\n    html (options) {\n        if (!arguments.length) {\n            return this._html;\n        }\n        if (options.all) {\n            this._html.all = options.all;\n        }\n        if (options.some) {\n            this._html.some = options.some;\n        }\n        return this;\n    }\n\n    /**\n     * Gets or sets an optional function to format the filter count and total count.\n     * @see {@link https://github.com/d3/d3-format/blob/master/README.md#format d3.format}\n     * @example\n     * counter.formatNumber(d3.format('.2g'))\n     * @param {Function} [formatter=d3.format('.2g')]\n     * @returns {Function|DataCount}\n     */\n    formatNumber (formatter) {\n        if (!arguments.length) {\n            return this._formatNumber;\n        }\n        this._formatNumber = formatter;\n        return this;\n    }\n\n    _doRender () {\n        const tot = this.crossfilter().size(),\n            val = this.groupAll().value();\n        const all = this._formatNumber(tot);\n        const selected = this._formatNumber(val);\n\n        if ((tot === val) && (this._html.all !== '')) {\n            this.root().html(this._html.all.replace('%total-count', all).replace('%filter-count', selected));\n        } else if (this._html.some !== '') {\n            this.root().html(this._html.some.replace('%total-count', all).replace('%filter-count', selected));\n        } else {\n            this.selectAll('.total-count').text(all);\n            this.selectAll('.filter-count').text(selected);\n        }\n        return this;\n    }\n\n    _doRedraw () {\n        return this._doRender();\n    }\n\n    crossfilter (cf) {\n        if (!arguments.length) {\n            return this._crossfilter;\n        }\n        this._crossfilter = cf;\n        return this;\n    }\n\n    dimension (cf) {\n        logger.warnOnce('consider using dataCount.crossfilter instead of dataCount.dimension for clarity');\n        if (!arguments.length) {\n            return this.crossfilter();\n        }\n        return this.crossfilter(cf);\n    }\n\n    groupAll (groupAll) {\n        if (!arguments.length) {\n            return this._groupAll;\n        }\n        this._groupAll = groupAll;\n        return this;\n    }\n\n    group (groupAll) {\n        logger.warnOnce('consider using dataCount.groupAll instead of dataCount.group for clarity');\n        if (!arguments.length) {\n            return this.groupAll();\n        }\n        return this.groupAll(groupAll);\n    }\n}\n\nexport const dataCount = (parent, chartGroup) => new DataCount(parent, chartGroup);\n","import {ascending} from 'd3-array';\n\nimport {logger} from '../core/logger';\nimport {BaseMixin} from '../base/base-mixin';\nimport {compatNestHelper} from '../core/d3compat';\n\nconst LABEL_CSS_CLASS = 'dc-grid-label';\nconst ITEM_CSS_CLASS = 'dc-grid-item';\nconst SECTION_CSS_CLASS = 'dc-grid-section dc-grid-group';\nconst GRID_CSS_CLASS = 'dc-grid-top';\n\n/**\n * Data grid is a simple widget designed to list the filtered records, providing\n * a simple way to define how the items are displayed.\n *\n * Note: Formerly the data grid chart (and data table) used the {@link DataGrid#group group} attribute as a\n * keying function for {@link https://github.com/d3/d3-collection/blob/master/README.md#nest nesting} the data\n * together in sections.  This was confusing so it has been renamed to `section`, although `group` still works.\n *\n * Examples:\n * - {@link https://dc-js.github.io/dc.js/ep/ List of members of the european parliament}\n * @mixes BaseMixin\n */\nexport class DataGrid extends BaseMixin {\n    /**\n     * Create a Data Grid.\n     * @param {String|node|d3.selection} parent - Any valid\n     * {@link https://github.com/d3/d3-selection/blob/master/README.md#select d3 single selector} specifying\n     * a dom block element such as a div; or a dom element or d3 selection.\n     * @param {String} [chartGroup] - The name of the chart group this chart instance should be placed in.\n     * Interaction with a chart will only trigger events and redraws within the chart's group.\n     */\n    constructor (parent, chartGroup) {\n        super();\n\n        this._section = null;\n        this._size = 999; // shouldn't be needed, but you might\n        this._html = function (d) {\n            return `you need to provide an html() handling param:  ${JSON.stringify(d)}`;\n        };\n        this._sortBy = function (d) {\n            return d;\n        };\n        this._order = ascending;\n        this._beginSlice = 0;\n        this._endSlice = undefined;\n\n        this._htmlSection = d => `<div class='${SECTION_CSS_CLASS}'><h1 class='${LABEL_CSS_CLASS}'>${ \n            this.keyAccessor()(d)}</h1></div>`;\n\n        this._mandatoryAttributes(['dimension', 'section']);\n\n        this.anchor(parent, chartGroup);\n    }\n\n    _doRender () {\n        this.selectAll(`div.${GRID_CSS_CLASS}`).remove();\n\n        this._renderItems(this._renderSections());\n\n        return this;\n    }\n\n    _renderSections () {\n        const sections = this.root().selectAll(`div.${GRID_CSS_CLASS}`)\n            .data(this._nestEntries(), d => this.keyAccessor()(d));\n\n        const itemSection = sections\n            .enter()\n            .append('div')\n            .attr('class', GRID_CSS_CLASS);\n\n        if (this._htmlSection) {\n            itemSection\n                .html(d => this._htmlSection(d));\n        }\n\n        sections.exit().remove();\n        return itemSection;\n    }\n\n    _nestEntries () {\n        let entries = this.dimension().top(this._size);\n\n        entries = entries\n            .sort((a, b) => this._order(this._sortBy(a), this._sortBy(b)))\n            .slice(this._beginSlice, this._endSlice)\n\n        return compatNestHelper({\n            key: this.section(),\n            sortKeys: this._order,\n            entries\n        });\n    }\n\n    _renderItems (sections) {\n        let items = sections.order()\n            .selectAll(`div.${ITEM_CSS_CLASS}`)\n            .data(d => d.values);\n\n        items.exit().remove();\n\n        items = items\n            .enter()\n            .append('div')\n            .attr('class', ITEM_CSS_CLASS)\n            .html(d => this._html(d))\n            .merge(items);\n\n        return items;\n    }\n\n    _doRedraw () {\n        return this._doRender();\n    }\n\n    /**\n     * Get or set the section function for the data grid. The section function takes a data row and\n     * returns the key to specify to {@link https://github.com/d3/d3-collection/blob/master/README.md#nest d3.nest}\n     * to split rows into sections.\n     *\n     * Do not pass in a crossfilter section as this will not work.\n     * @example\n     * // section rows by the value of their field\n     * chart\n     *     .section(function(d) { return d.field; })\n     * @param {Function} section Function taking a row of data and returning the nest key.\n     * @returns {Function|DataGrid}\n     */\n    section (section) {\n        if (!arguments.length) {\n            return this._section;\n        }\n        this._section = section;\n        return this;\n    }\n\n    /**\n     * Backward-compatible synonym for {@link DataGrid#section section}.\n     *\n     * @param {Function} section Function taking a row of data and returning the nest key.\n     * @returns {Function|DataGrid}\n     */\n    group (section) {\n        logger.warnOnce('consider using dataGrid.section instead of dataGrid.group for clarity');\n        if (!arguments.length) {\n            return this.section();\n        }\n        return this.section(section);\n    }\n\n    /**\n     * Get or set the index of the beginning slice which determines which entries get displayed by the widget.\n     * Useful when implementing pagination.\n     * @param {Number} [beginSlice=0]\n     * @returns {Number|DataGrid}\n     */\n    beginSlice (beginSlice) {\n        if (!arguments.length) {\n            return this._beginSlice;\n        }\n        this._beginSlice = beginSlice;\n        return this;\n    }\n\n    /**\n     * Get or set the index of the end slice which determines which entries get displayed by the widget.\n     * Useful when implementing pagination.\n     * @param {Number} [endSlice]\n     * @returns {Number|DataGrid}\n     */\n    endSlice (endSlice) {\n        if (!arguments.length) {\n            return this._endSlice;\n        }\n        this._endSlice = endSlice;\n        return this;\n    }\n\n    /**\n     * Get or set the grid size which determines the number of items displayed by the widget.\n     * @param {Number} [size=999]\n     * @returns {Number|DataGrid}\n     */\n    size (size) {\n        if (!arguments.length) {\n            return this._size;\n        }\n        this._size = size;\n        return this;\n    }\n\n    /**\n     * Get or set the function that formats an item. The data grid widget uses a\n     * function to generate dynamic html. Use your favourite templating engine or\n     * generate the string directly.\n     * @example\n     * chart.html(function (d) { return '<div class='item '+data.exampleCategory+''>'+data.exampleString+'</div>';});\n     * @param {Function} [html]\n     * @returns {Function|DataGrid}\n     */\n    html (html) {\n        if (!arguments.length) {\n            return this._html;\n        }\n        this._html = html;\n        return this;\n    }\n\n    /**\n     * Get or set the function that formats a section label.\n     * @example\n     * chart.htmlSection (function (d) { return '<h2>'.d.key . 'with ' . d.values.length .' items</h2>'});\n     * @param {Function} [htmlSection]\n     * @returns {Function|DataGrid}\n     */\n    htmlSection (htmlSection) {\n        if (!arguments.length) {\n            return this._htmlSection;\n        }\n        this._htmlSection = htmlSection;\n        return this;\n    }\n\n    /**\n     * Backward-compatible synonym for {@link DataGrid#htmlSection htmlSection}.\n     * @param {Function} [htmlSection]\n     * @returns {Function|DataGrid}\n     */\n    htmlGroup (htmlSection) {\n        logger.warnOnce('consider using dataGrid.htmlSection instead of dataGrid.htmlGroup for clarity');\n        if (!arguments.length) {\n            return this.htmlSection();\n        }\n        return this.htmlSection(htmlSection);\n    }\n\n    /**\n     * Get or set sort-by function. This function works as a value accessor at the item\n     * level and returns a particular field to be sorted.\n     * @example\n     * chart.sortBy(function(d) {\n     *     return d.date;\n     * });\n     * @param {Function} [sortByFunction]\n     * @returns {Function|DataGrid}\n     */\n    sortBy (sortByFunction) {\n        if (!arguments.length) {\n            return this._sortBy;\n        }\n        this._sortBy = sortByFunction;\n        return this;\n    }\n\n    /**\n     * Get or set sort the order function.\n     * @see {@link https://github.com/d3/d3-array/blob/master/README.md#ascending d3.ascending}\n     * @see {@link https://github.com/d3/d3-array/blob/master/README.md#descending d3.descending}\n     * @example\n     * chart.order(d3.descending);\n     * @param {Function} [order=d3.ascending]\n     * @returns {Function|DataGrid}\n     */\n    order (order) {\n        if (!arguments.length) {\n            return this._order;\n        }\n        this._order = order;\n        return this;\n    }\n}\n\nexport const dataGrid = (parent, chartGroup) => new DataGrid(parent, chartGroup);\n","import {ascending} from 'd3-array';\n\nimport {logger} from '../core/logger';\nimport {BaseMixin} from '../base/base-mixin';\nimport {compatNestHelper} from '../core/d3compat';\n\nconst LABEL_CSS_CLASS = 'dc-table-label';\nconst ROW_CSS_CLASS = 'dc-table-row';\nconst COLUMN_CSS_CLASS = 'dc-table-column';\nconst SECTION_CSS_CLASS = 'dc-table-section dc-table-group';\nconst HEAD_CSS_CLASS = 'dc-table-head';\n\n/**\n * The data table is a simple widget designed to list crossfilter focused data set (rows being\n * filtered) in a good old tabular fashion.\n *\n * An interesting feature of the data table is that you can pass a crossfilter group to the\n * `dimension`, if you want to show aggregated data instead of raw data rows. This requires no\n * special code as long as you specify the {@link DataTable#order order} as `d3.descending`,\n * since the data table will use `dimension.top()` to fetch the data in that case, and the method is\n * equally supported on the crossfilter group as the crossfilter dimension.\n *\n * If you want to display aggregated data in ascending order, you will need to wrap the group\n * in a [fake dimension](https://github.com/dc-js/dc.js/wiki/FAQ#fake-dimensions) to support the\n * `.bottom()` method. See the example linked below for more details.\n *\n * Note: Formerly the data table (and data grid chart) used the {@link DataTable#group group} attribute as a\n * keying function for {@link https://github.com/d3/d3-collection/blob/master/README.md#nest nesting} the data\n * together in sections.  This was confusing so it has been renamed to `section`, although `group` still works.\n * Examples:\n * - {@link http://dc-js.github.com/dc.js/ Nasdaq 100 Index}\n * - {@link http://dc-js.github.io/dc.js/examples/table-on-aggregated-data.html dataTable on a crossfilter group}\n * ({@link https://github.com/dc-js/dc.js/blob/master/web-src/examples/table-on-aggregated-data.html source})\n *\n * @mixes BaseMixin\n */\nexport class DataTable extends BaseMixin {\n    /**\n     * Create a Data Table.\n     *\n     * @param {String|node|d3.selection} parent - Any valid\n     * {@link https://github.com/d3/d3-selection/blob/master/README.md#select d3 single selector} specifying\n     * a dom block element such as a div; or a dom element or d3 selection.\n     * @param {String} [chartGroup] - The name of the chart group this chart instance should be placed in.\n     * Interaction with a chart will only trigger events and redraws within the chart's group.\n     */\n    constructor (parent, chartGroup) {\n        super();\n\n        this._size = 25;\n        this._columns = [];\n        this._sortBy = d => d;\n        this._order = ascending;\n        this._beginSlice = 0;\n        this._endSlice = undefined;\n        this._showSections = true;\n        this._section = () => ''; // all in one section\n\n        this._mandatoryAttributes(['dimension']);\n\n        this.anchor(parent, chartGroup);\n    }\n\n    _doRender () {\n        this.selectAll('tbody').remove();\n\n        this._renderRows(this._renderSections());\n\n        return this;\n    }\n\n    _doColumnValueFormat (v, d) {\n        return (typeof v === 'function') ? v(d) :  // v as function\n            (typeof v === 'string') ? d[v] :       // v is field name string\n            v.format(d);                           // v is Object, use fn (element 2)\n    }\n\n    _doColumnHeaderFormat (d) {\n        // if 'function', convert to string representation\n        // show a string capitalized\n        // if an object then display its label string as-is.\n        return (typeof d === 'function') ? this._doColumnHeaderFnToString(d) :\n            (typeof d === 'string') ? this._doColumnHeaderCapitalize(d) :\n            String(d.label);\n    }\n\n    _doColumnHeaderCapitalize (s) {\n        // capitalize\n        return s.charAt(0).toUpperCase() + s.slice(1);\n    }\n\n    _doColumnHeaderFnToString (f) {\n        // columnString(f) {\n        let s = String(f);\n        const i1 = s.indexOf('return ');\n        if (i1 >= 0) {\n            const i2 = s.lastIndexOf(';');\n            if (i2 >= 0) {\n                s = s.substring(i1 + 7, i2);\n                const i3 = s.indexOf('numberFormat');\n                if (i3 >= 0) {\n                    s = s.replace('numberFormat', '');\n                }\n            }\n        }\n        return s;\n    }\n\n    _renderSections () {\n        // The 'original' example uses all 'functions'.\n        // If all 'functions' are used, then don't remove/add a header, and leave\n        // the html alone. This preserves the functionality of earlier releases.\n        // A 2nd option is a string representing a field in the data.\n        // A third option is to supply an Object such as an array of 'information', and\n        // supply your own _doColumnHeaderFormat and _doColumnValueFormat functions to\n        // create what you need.\n        let bAllFunctions = true;\n        this._columns.forEach(f => {\n            bAllFunctions = bAllFunctions & (typeof f === 'function');\n        });\n\n        if (!bAllFunctions) {\n            // ensure one thead\n            let thead = this.selectAll('thead').data([0]);\n            thead.exit().remove();\n            thead = thead.enter()\n                .append('thead')\n                .merge(thead);\n\n            // with one tr\n            let headrow = thead.selectAll('tr').data([0]);\n            headrow.exit().remove();\n            headrow = headrow.enter()\n                .append('tr')\n                .merge(headrow);\n\n            // with a th for each column\n            const headcols = headrow.selectAll('th')\n                .data(this._columns);\n            headcols.exit().remove();\n            headcols.enter().append('th')\n                .merge(headcols)\n                .attr('class', HEAD_CSS_CLASS)\n                .html(d => (this._doColumnHeaderFormat(d)));\n        }\n\n        const sections = this.root().selectAll('tbody')\n            .data(this._nestEntries(), d => this.keyAccessor()(d));\n\n        const rowSection = sections\n            .enter()\n            .append('tbody');\n\n        if (this._showSections === true) {\n            rowSection\n                .append('tr')\n                .attr('class', SECTION_CSS_CLASS)\n                .append('td')\n                .attr('class', LABEL_CSS_CLASS)\n                .attr('colspan', this._columns.length)\n                .html(d => this.keyAccessor()(d));\n        }\n\n        sections.exit().remove();\n\n        return rowSection;\n    }\n\n    _nestEntries () {\n        let entries;\n        if (this._order === ascending) {\n            entries = this.dimension().bottom(this._size);\n        } else {\n            entries = this.dimension().top(this._size);\n        }\n\n        entries = entries.sort((a, b) => this._order(this._sortBy(a), this._sortBy(b))).slice(this._beginSlice, this._endSlice)\n\n        return compatNestHelper({\n            key: this.section(),\n            sortKeys: this._order,\n            entries\n        });\n    }\n\n    _renderRows (sections) {\n        const rows = sections.order()\n            .selectAll(`tr.${ROW_CSS_CLASS}`)\n            .data(d => d.values);\n\n        const rowEnter = rows.enter()\n            .append('tr')\n            .attr('class', ROW_CSS_CLASS);\n\n        this._columns.forEach((v, i) => {\n            rowEnter.append('td')\n                .attr('class', `${COLUMN_CSS_CLASS} _${i}`)\n                .html(d => this._doColumnValueFormat(v, d));\n        });\n\n        rows.exit().remove();\n\n        return rows;\n    }\n\n    _doRedraw () {\n        return this._doRender();\n    }\n\n    /**\n     * Get or set the section function for the data table. The section function takes a data row and\n     * returns the key to specify to {@link https://github.com/d3/d3-collection/blob/master/README.md#nest d3.nest}\n     * to split rows into sections. By default there will be only one section with no name.\n     *\n     * Set {@link DataTable#showSections showSections} to false to hide the section headers\n     *\n     * @example\n     * // section rows by the value of their field\n     * chart\n     *     .section(function(d) { return d.field; })\n     * @param {Function} section Function taking a row of data and returning the nest key.\n     * @returns {Function|DataTable}\n     */\n    section (section) {\n        if (!arguments.length) {\n            return this._section;\n        }\n        this._section = section;\n        return this;\n    }\n\n    /**\n     * Backward-compatible synonym for {@link DataTable#section section}.\n     *\n     * @param {Function} section Function taking a row of data and returning the nest key.\n     * @returns {Function|DataTable}\n     */\n    group (section) {\n        logger.warnOnce('consider using dataTable.section instead of dataTable.group for clarity');\n        if (!arguments.length) {\n            return this.section();\n        }\n        return this.section(section);\n    }\n\n    /**\n     * Get or set the table size which determines the number of rows displayed by the widget.\n     * @param {Number} [size=25]\n     * @returns {Number|DataTable}\n     */\n    size (size) {\n        if (!arguments.length) {\n            return this._size;\n        }\n        this._size = size;\n        return this;\n    }\n\n    /**\n     * Get or set the index of the beginning slice which determines which entries get displayed\n     * by the widget. Useful when implementing pagination.\n     *\n     * Note: the sortBy function will determine how the rows are ordered for pagination purposes.\n\n     * See the {@link http://dc-js.github.io/dc.js/examples/table-pagination.html table pagination example}\n     * to see how to implement the pagination user interface using `beginSlice` and `endSlice`.\n     * @param {Number} [beginSlice=0]\n     * @returns {Number|DataTable}\n     */\n    beginSlice (beginSlice) {\n        if (!arguments.length) {\n            return this._beginSlice;\n        }\n        this._beginSlice = beginSlice;\n        return this;\n    }\n\n    /**\n     * Get or set the index of the end slice which determines which entries get displayed by the\n     * widget. Useful when implementing pagination. See {@link DataTable#beginSlice `beginSlice`} for more information.\n     * @param {Number|undefined} [endSlice=undefined]\n     * @returns {Number|DataTable}\n     */\n    endSlice (endSlice) {\n        if (!arguments.length) {\n            return this._endSlice;\n        }\n        this._endSlice = endSlice;\n        return this;\n    }\n\n    /**\n     * Get or set column functions. The data table widget supports several methods of specifying the\n     * columns to display.\n     *\n     * The original method uses an array of functions to generate dynamic columns. Column functions\n     * are simple javascript functions with only one input argument `d` which represents a row in\n     * the data set. The return value of these functions will be used to generate the content for\n     * each cell. However, this method requires the HTML for the table to have a fixed set of column\n     * headers.\n     *\n     * <pre><code>chart.columns([\n     *     function(d) { return d.date; },\n     *     function(d) { return d.open; },\n     *     function(d) { return d.close; },\n     *     function(d) { return numberFormat(d.close - d.open); },\n     *     function(d) { return d.volume; }\n     * ]);\n     * </code></pre>\n     *\n     * In the second method, you can list the columns to read from the data without specifying it as\n     * a function, except where necessary (ie, computed columns).  Note the data element name is\n     * capitalized when displayed in the table header. You can also mix in functions as necessary,\n     * using the third `{label, format}` form, as shown below.\n     *\n     * <pre><code>chart.columns([\n     *     \"date\",    // d[\"date\"], ie, a field accessor; capitalized automatically\n     *     \"open\",    // ...\n     *     \"close\",   // ...\n     *     {\n     *         label: \"Change\",\n     *         format: function (d) {\n     *             return numberFormat(d.close - d.open);\n     *         }\n     *     },\n     *     \"volume\"   // d[\"volume\"], ie, a field accessor; capitalized automatically\n     * ]);\n     * </code></pre>\n     *\n     * In the third example, we specify all fields using the `{label, format}` method:\n     * <pre><code>chart.columns([\n     *     {\n     *         label: \"Date\",\n     *         format: function (d) { return d.date; }\n     *     },\n     *     {\n     *         label: \"Open\",\n     *         format: function (d) { return numberFormat(d.open); }\n     *     },\n     *     {\n     *         label: \"Close\",\n     *         format: function (d) { return numberFormat(d.close); }\n     *     },\n     *     {\n     *         label: \"Change\",\n     *         format: function (d) { return numberFormat(d.close - d.open); }\n     *     },\n     *     {\n     *         label: \"Volume\",\n     *         format: function (d) { return d.volume; }\n     *     }\n     * ]);\n     * </code></pre>\n     *\n     * You may wish to override the dataTable functions `_doColumnHeaderCapitalize` and\n     * `_doColumnHeaderFnToString`, which are used internally to translate the column information or\n     * function into a displayed header. The first one is used on the \"string\" column specifier; the\n     * second is used to transform a stringified function into something displayable. For the Stock\n     * example, the function for Change becomes the table header **d.close - d.open**.\n     *\n     * Finally, you can even specify a completely different form of column definition. To do this,\n     * override `_chart._doColumnHeaderFormat` and `_chart._doColumnValueFormat` Be aware that\n     * fields without numberFormat specification will be displayed just as they are stored in the\n     * data, unformatted.\n     * @param {Array<Function>} [columns=[]]\n     * @returns {Array<Function>}|DataTable}\n     */\n    columns (columns) {\n        if (!arguments.length) {\n            return this._columns;\n        }\n        this._columns = columns;\n        return this;\n    }\n\n    /**\n     * Get or set sort-by function. This function works as a value accessor at row level and returns a\n     * particular field to be sorted by.\n     * @example\n     * chart.sortBy(function(d) {\n     *     return d.date;\n     * });\n     * @param {Function} [sortBy=identity function]\n     * @returns {Function|DataTable}\n     */\n    sortBy (sortBy) {\n        if (!arguments.length) {\n            return this._sortBy;\n        }\n        this._sortBy = sortBy;\n        return this;\n    }\n\n    /**\n     * Get or set sort order. If the order is `d3.ascending`, the data table will use\n     * `dimension().bottom()` to fetch the data; otherwise it will use `dimension().top()`\n     * @see {@link https://github.com/d3/d3-array/blob/master/README.md#ascending d3.ascending}\n     * @see {@link https://github.com/d3/d3-array/blob/master/README.md#descending d3.descending}\n     * @example\n     * chart.order(d3.descending);\n     * @param {Function} [order=d3.ascending]\n     * @returns {Function|DataTable}\n     */\n    order (order) {\n        if (!arguments.length) {\n            return this._order;\n        }\n        this._order = order;\n        return this;\n    }\n\n    /**\n     * Get or set if section header rows will be shown.\n     * @example\n     * chart\n     *     .section([value], [name])\n     *     .showSections(true|false);\n     * @param {Boolean} [showSections=true]\n     * @returns {Boolean|DataTable}\n     */\n    showSections (showSections) {\n        if (!arguments.length) {\n            return this._showSections;\n        }\n        this._showSections = showSections;\n        return this;\n    }\n\n    /**\n     * Backward-compatible synonym for {@link DataTable#showSections showSections}.\n     * @param {Boolean} [showSections=true]\n     * @returns {Boolean|DataTable}\n     */\n    showGroups (showSections) {\n        logger.warnOnce('consider using dataTable.showSections instead of dataTable.showGroups for clarity');\n        if (!arguments.length) {\n            return this.showSections();\n        }\n        return this.showSections(showSections);\n    }\n}\n\nexport const dataTable = (parent, chartGroup) => new DataTable(parent, chartGroup);\n","import {geoPath, geoAlbersUsa} from 'd3-geo';\nimport {select} from 'd3-selection';\n\nimport {BaseMixin} from '../base/base-mixin';\nimport {ColorMixin} from '../base/color-mixin';\nimport {transition} from '../core/core';\nimport {logger} from '../core/logger';\nimport {events} from '../core/events';\nimport {utils} from '../core/utils';\nimport {adaptHandler} from '../core/d3compat';\n\n/**\n * The geo choropleth chart is designed as an easy way to create a crossfilter driven choropleth map\n * from GeoJson data. This chart implementation was inspired by\n * {@link http://bl.ocks.org/4060606 the great d3 choropleth example}.\n *\n * Examples:\n * - {@link http://dc-js.github.com/dc.js/vc/index.html US Venture Capital Landscape 2011}\n * @mixes ColorMixin\n * @mixes BaseMixin\n */\nexport class GeoChoroplethChart extends ColorMixin(BaseMixin) {\n    /**\n     * Create a Geo Choropleth Chart.\n     * @example\n     * // create a choropleth chart under '#us-chart' element using the default global chart group\n     * var chart1 = new GeoChoroplethChart('#us-chart');\n     * // create a choropleth chart under '#us-chart2' element using chart group A\n     * var chart2 = new CompositeChart('#us-chart2', 'chartGroupA');\n     * @param {String|node|d3.selection} parent - Any valid\n     * {@link https://github.com/d3/d3-selection/blob/master/README.md#select d3 single selector} specifying\n     * a dom block element such as a div; or a dom element or d3 selection.\n     * @param {String} [chartGroup] - The name of the chart group this chart instance should be placed in.\n     * Interaction with a chart will only trigger events and redraws within the chart's group.\n     */\n    constructor (parent, chartGroup) {\n        super();\n\n        this.colorAccessor(d => d || 0);\n\n        this._geoPath = geoPath();\n        this._projectionFlag = undefined;\n        this._projection = undefined;\n\n        this._geoJsons = [];\n\n        this.anchor(parent, chartGroup);\n    }\n\n    _doRender () {\n        this.resetSvg();\n        for (let layerIndex = 0; layerIndex < this._geoJsons.length; ++layerIndex) {\n            const states = this.svg().append('g')\n                .attr('class', `layer${layerIndex}`);\n\n            let regionG = states.selectAll(`g.${this._geoJson(layerIndex).name}`)\n                .data(this._geoJson(layerIndex).data);\n\n            regionG = regionG.enter()\n                .append('g')\n                .attr('class', this._geoJson(layerIndex).name)\n                .merge(regionG);\n\n            regionG\n                .append('path')\n                .classed('dc-tabbable', this._keyboardAccessible)\n                .attr('fill', 'white')\n                .attr('d', this._getGeoPath());\n\n            regionG.append('title');\n\n            this._plotData(layerIndex);\n        }\n        this._projectionFlag = false;\n    }\n\n    _plotData (layerIndex) {\n        const data = this._generateLayeredData();\n\n        if (this._isDataLayer(layerIndex)) {\n            const regionG = this._renderRegionG(layerIndex);\n\n            this._renderPaths(regionG, layerIndex, data);\n\n            this._renderTitles(regionG, layerIndex, data);\n        }\n    }\n\n    _generateLayeredData () {\n        const data = {};\n        const groupAll = this.data();\n        for (let i = 0; i < groupAll.length; ++i) {\n            data[this.keyAccessor()(groupAll[i])] = this.valueAccessor()(groupAll[i]);\n        }\n        return data;\n    }\n\n    _isDataLayer (layerIndex) {\n        return this._geoJson(layerIndex).keyAccessor;\n    }\n\n    _renderRegionG (layerIndex) {\n        const regionG = this.svg()\n            .selectAll(this._layerSelector(layerIndex))\n            .classed('selected', d => this._isSelected(layerIndex, d))\n            .classed('deselected', d => this._isDeselected(layerIndex, d))\n            .attr('class', d => {\n                const layerNameClass = this._geoJson(layerIndex).name;\n                const regionClass = utils.nameToId(this._geoJson(layerIndex).keyAccessor(d));\n                let baseClasses = `${layerNameClass} ${regionClass}`;\n                if (this._isSelected(layerIndex, d)) {\n                    baseClasses += ' selected';\n                }\n                if (this._isDeselected(layerIndex, d)) {\n                    baseClasses += ' deselected';\n                }\n                return baseClasses;\n            });\n        return regionG;\n    }\n\n    _layerSelector (layerIndex) {\n        return `g.layer${layerIndex} g.${this._geoJson(layerIndex).name}`;\n    }\n\n    _isSelected (layerIndex, d) {\n        return this.hasFilter() && this.hasFilter(this._getKey(layerIndex, d));\n    }\n\n    _isDeselected (layerIndex, d) {\n        return this.hasFilter() && !this.hasFilter(this._getKey(layerIndex, d));\n    }\n\n    _getKey (layerIndex, d) {\n        return this._geoJson(layerIndex).keyAccessor(d);\n    }\n\n    _geoJson (index) {\n        return this._geoJsons[index];\n    }\n\n    _renderPaths (regionG, layerIndex, data) {\n        const paths = regionG\n            .select('path')\n            .attr('fill', function () {\n                const currentFill = select(this).attr('fill');\n                if (currentFill) {\n                    return currentFill;\n                }\n                return 'none';\n            })\n            .on('click', adaptHandler(d => this.onClick(d, layerIndex)));\n\n        if (this._keyboardAccessible) {\n            this._makeKeyboardAccessible(this.onClick, layerIndex);\n        }\n\n        transition(paths, this.transitionDuration(),\n                   this.transitionDelay()).attr('fill', (d, i) => this.getColor(data[this._geoJson(layerIndex).keyAccessor(d)], i));\n    }\n\n    onClick (d, layerIndex) {\n        const selectedRegion = this._geoJson(layerIndex).keyAccessor(d);\n        events.trigger(() => {\n            this.filter(selectedRegion);\n            this.redrawGroup();\n        });\n    }\n\n    _renderTitles (regionG, layerIndex, data) {\n        if (this.renderTitle()) {\n            regionG.selectAll('title').text(d => {\n                const key = this._getKey(layerIndex, d);\n                const value = data[key];\n                return this.title()({key: key, value: value});\n            });\n        }\n    }\n\n    _doRedraw () {\n        for (let layerIndex = 0; layerIndex < this._geoJsons.length; ++layerIndex) {\n            this._plotData(layerIndex);\n            if (this._projectionFlag) {\n                this.svg().selectAll(`g.${this._geoJson(layerIndex).name} path`).attr('d', this._getGeoPath());\n            }\n        }\n        this._projectionFlag = false;\n    }\n\n    /**\n     * **mandatory**\n     *\n     * Use this function to insert a new GeoJson map layer. This function can be invoked multiple times\n     * if you have multiple GeoJson data layers to render on top of each other. If you overlay multiple\n     * layers with the same name the new overlay will override the existing one.\n     * @see {@link http://geojson.org/ GeoJSON}\n     * @see {@link https://github.com/topojson/topojson/wiki TopoJSON}\n     * @see {@link https://github.com/topojson/topojson-1.x-api-reference/blob/master/API-Reference.md#wiki-feature topojson.feature}\n     * @example\n     * // insert a layer for rendering US states\n     * chart.overlayGeoJson(statesJson.features, 'state', function(d) {\n     *      return d.properties.name;\n     * });\n     * @param {_geoJson} json - a geojson feed\n     * @param {String} name - name of the layer\n     * @param {Function} keyAccessor - accessor function used to extract 'key' from the GeoJson data. The key extracted by\n     * this function should match the keys returned by the crossfilter groups.\n     * @returns {GeoChoroplethChart}\n     */\n    overlayGeoJson (json, name, keyAccessor) {\n        for (let i = 0; i < this._geoJsons.length; ++i) {\n            if (this._geoJsons[i].name === name) {\n                this._geoJsons[i].data = json;\n                this._geoJsons[i].keyAccessor = keyAccessor;\n                return this;\n            }\n        }\n        this._geoJsons.push({name: name, data: json, keyAccessor: keyAccessor});\n        return this;\n    }\n\n    /**\n     * Gets or sets a custom geo projection function. See the available\n     * {@link https://github.com/d3/d3-geo/blob/master/README.md#projections d3 geo projection functions}.\n     *\n     * Starting version 3.0 it has been deprecated to rely on the default projection being\n     * {@link https://github.com/d3/d3-geo/blob/master/README.md#geoAlbersUsa d3.geoAlbersUsa()}. Please\n     * set it explicitly. {@link https://bl.ocks.org/mbostock/5557726\n     * Considering that `null` is also a valid value for projection}, if you need\n     * projection to be `null` please set it explicitly to `null`.\n     * @see {@link https://github.com/d3/d3-geo/blob/master/README.md#projections d3.projection}\n     * @see {@link https://github.com/d3/d3-geo-projection d3-geo-projection}\n     * @param {d3.projection} [projection=d3.geoAlbersUsa()]\n     * @returns {d3.projection|GeoChoroplethChart}\n     */\n    projection (projection) {\n        if (!arguments.length) {\n            return this._projection;\n        }\n\n        this._projection = projection;\n        this._projectionFlag = true;\n        return this;\n    }\n\n    _getGeoPath () {\n        if (this._projection === undefined) {\n            logger.warn('choropleth projection default of geoAlbers is deprecated,' +\n                ' in next version projection will need to be set explicitly');\n            return this._geoPath.projection(geoAlbersUsa());\n        }\n\n        return this._geoPath.projection(this._projection);\n    }\n\n    /**\n     * Returns all GeoJson layers currently registered with this chart. The returned array is a\n     * reference to this chart's internal data structure, so any modification to this array will also\n     * modify this chart's internal registration.\n     * @returns {Array<{name:String, data: Object, accessor: Function}>}\n     */\n    geoJsons () {\n        return this._geoJsons;\n    }\n\n    /**\n     * Returns the {@link https://github.com/d3/d3-geo/blob/master/README.md#paths d3.geoPath} object used to\n     * render the projection and features.  Can be useful for figuring out the bounding box of the\n     * feature set and thus a way to calculate scale and translation for the projection.\n     * @see {@link https://github.com/d3/d3-geo/blob/master/README.md#paths d3.geoPath}\n     * @returns {d3.geoPath}\n     */\n    geoPath () {\n        return this._geoPath;\n    }\n\n    /**\n     * Remove a GeoJson layer from this chart by name\n     * @param {String} name\n     * @returns {GeoChoroplethChart}\n     */\n    removeGeoJson (name) {\n        const geoJsons = [];\n\n        for (let i = 0; i < this._geoJsons.length; ++i) {\n            const layer = this._geoJsons[i];\n            if (layer.name !== name) {\n                geoJsons.push(layer);\n            }\n        }\n\n        this._geoJsons = geoJsons;\n\n        return this;\n    }\n}\n\nexport const geoChoroplethChart = (parent, chartGroup) => new GeoChoroplethChart(parent, chartGroup);\n","import {ascending} from 'd3-array';\nimport {scaleBand} from 'd3-scale';\n\nimport {transition} from '../core/core';\nimport {logger} from '../core/logger';\nimport {filters} from '../core/filters';\nimport {events} from '../core/events';\nimport {ColorMixin} from '../base/color-mixin';\nimport {MarginMixin} from '../base/margin-mixin';\nimport {adaptHandler} from '../core/d3compat';\n\nconst DEFAULT_BORDER_RADIUS = 6.75;\n\n/**\n * A heat map is matrix that represents the values of two dimensions of data using colors.\n * @mixes ColorMixin\n * @mixes MarginMixin\n * @mixes BaseMixin\n */\nexport class HeatMap extends ColorMixin(MarginMixin) {\n    /**\n     * Create a Heat Map\n     * @example\n     * // create a heat map under #chart-container1 element using the default global chart group\n     * var heatMap1 = new HeatMap('#chart-container1');\n     * // create a heat map under #chart-container2 element using chart group A\n     * var heatMap2 = new HeatMap('#chart-container2', 'chartGroupA');\n     * @param {String|node|d3.selection} parent - Any valid\n     * {@link https://github.com/d3/d3-selection/blob/master/README.md#select d3 single selector} specifying\n     * a dom block element such as a div; or a dom element or d3 selection.\n     * @param {String} [chartGroup] - The name of the chart group this chart instance should be placed in.\n     * Interaction with a chart will only trigger events and redraws within the chart's group.\n     */\n    constructor (parent, chartGroup) {\n        super();\n\n        this._chartBody = undefined;\n\n        this._cols = undefined;\n        this._rows = undefined;\n        this._colOrdering = ascending;\n        this._rowOrdering = ascending;\n        this._colScale = scaleBand();\n        this._rowScale = scaleBand();\n\n        this._xBorderRadius = DEFAULT_BORDER_RADIUS;\n        this._yBorderRadius = DEFAULT_BORDER_RADIUS;\n\n        this._mandatoryAttributes(['group']);\n        this.title(this.colorAccessor());\n\n        this._colsLabel = d => d;\n        this._rowsLabel = d => d;\n\n        this._xAxisOnClick = d => {\n            this._filterAxis(0, d);\n        };\n        this._yAxisOnClick = d => {\n            this._filterAxis(1, d);\n        };\n        this._boxOnClick = d => {\n            const filter = d.key;\n            events.trigger(() => {\n                this.filter(filters.TwoDimensionalFilter(filter));\n                this.redrawGroup();\n            });\n        };\n\n        this.anchor(parent, chartGroup);\n    }\n\n    /**\n     * Set or get the column label function. The chart class uses this function to render\n     * column labels on the X axis. It is passed the column name.\n     * @example\n     * // the default label function just returns the name\n     * chart.colsLabel(function(d) { return d; });\n     * @param  {Function} [labelFunction=function(d) { return d; }]\n     * @returns {Function|HeatMap}\n     */\n    colsLabel (labelFunction) {\n        if (!arguments.length) {\n            return this._colsLabel;\n        }\n        this._colsLabel = labelFunction;\n        return this;\n    }\n\n    /**\n     * Set or get the row label function. The chart class uses this function to render\n     * row labels on the Y axis. It is passed the row name.\n     * @example\n     * // the default label function just returns the name\n     * chart.rowsLabel(function(d) { return d; });\n     * @param  {Function} [labelFunction=function(d) { return d; }]\n     * @returns {Function|HeatMap}\n     */\n    rowsLabel (labelFunction) {\n        if (!arguments.length) {\n            return this._rowsLabel;\n        }\n        this._rowsLabel = labelFunction;\n        return this;\n    }\n\n    _filterAxis (axis, value) {\n        const cellsOnAxis = this.selectAll('.box-group').filter(d => d.key[axis] === value);\n        const unfilteredCellsOnAxis = cellsOnAxis.filter(d => !this.hasFilter(d.key));\n        events.trigger(() => {\n            const selection = unfilteredCellsOnAxis.empty() ? cellsOnAxis : unfilteredCellsOnAxis;\n            const filtersList = selection.data().map(kv => filters.TwoDimensionalFilter(kv.key));\n            this.filter([filtersList]);\n            this.redrawGroup();\n        });\n    }\n\n    filter (filter) {\n        const nonstandardFilter = f => {\n            logger.warnOnce('heatmap.filter taking a coordinate is deprecated - please pass dc.filters.TwoDimensionalFilter instead');\n            return this._filter(filters.TwoDimensionalFilter(f));\n        };\n\n        if (!arguments.length) {\n            return super.filter();\n        }\n        if (filter !== null && filter.filterType !== 'TwoDimensionalFilter' &&\n            !(Array.isArray(filter) && Array.isArray(filter[0]) && filter[0][0].filterType === 'TwoDimensionalFilter')) {\n            return nonstandardFilter(filter);\n        }\n        return super.filter(filter);\n    }\n\n    /**\n     * Gets or sets the values used to create the rows of the heatmap, as an array. By default, all\n     * the values will be fetched from the data using the value accessor.\n     * @param  {Array<String|Number>} [rows]\n     * @returns {Array<String|Number>|HeatMap}\n     */\n\n    rows (rows) {\n        if (!arguments.length) {\n            return this._rows;\n        }\n        this._rows = rows;\n        return this;\n    }\n\n    /**\n     * Get or set a comparator to order the rows.\n     * Default is {@link https://github.com/d3/d3-array#ascending d3.ascending}.\n     * @param  {Function} [rowOrdering]\n     * @returns {Function|HeatMap}\n     */\n    rowOrdering (rowOrdering) {\n        if (!arguments.length) {\n            return this._rowOrdering;\n        }\n        this._rowOrdering = rowOrdering;\n        return this;\n    }\n\n    /**\n     * Gets or sets the keys used to create the columns of the heatmap, as an array. By default, all\n     * the values will be fetched from the data using the key accessor.\n     * @param  {Array<String|Number>} [cols]\n     * @returns {Array<String|Number>|HeatMap}\n     */\n    cols (cols) {\n        if (!arguments.length) {\n            return this._cols;\n        }\n        this._cols = cols;\n        return this;\n    }\n\n    /**\n     * Get or set a comparator to order the columns.\n     * Default is  {@link https://github.com/d3/d3-array#ascending d3.ascending}.\n     * @param  {Function} [colOrdering]\n     * @returns {Function|HeatMap}\n     */\n    colOrdering (colOrdering) {\n        if (!arguments.length) {\n            return this._colOrdering;\n        }\n        this._colOrdering = colOrdering;\n        return this;\n    }\n\n    _doRender () {\n        this.resetSvg();\n\n        this._chartBody = this.svg()\n            .append('g')\n            .attr('class', 'heatmap')\n            .attr('transform', `translate(${this.margins().left},${this.margins().top})`);\n\n        return this._doRedraw();\n    }\n\n    _doRedraw () {\n        const data = this.data();\n        let rows = this.rows() || data.map(this.valueAccessor()),\n            cols = this.cols() || data.map(this.keyAccessor());\n        if (this._rowOrdering) {\n            rows = rows.sort(this._rowOrdering);\n        }\n        if (this._colOrdering) {\n            cols = cols.sort(this._colOrdering);\n        }\n        rows = this._rowScale.domain(rows);\n        cols = this._colScale.domain(cols);\n\n        const rowCount = rows.domain().length,\n            colCount = cols.domain().length,\n            boxWidth = Math.floor(this.effectiveWidth() / colCount),\n            boxHeight = Math.floor(this.effectiveHeight() / rowCount);\n\n        cols.rangeRound([0, this.effectiveWidth()]);\n        rows.rangeRound([this.effectiveHeight(), 0]);\n\n        let boxes = this._chartBody.selectAll('g.box-group').data(this.data(),\n                                                                  (d, i) => `${this.keyAccessor()(d, i)}\\0${this.valueAccessor()(d, i)}`);\n\n        boxes.exit().remove();\n\n        const gEnter = boxes.enter().append('g')\n            .attr('class', 'box-group');\n\n        gEnter.append('rect')\n            .attr('class', 'heat-box')\n            .classed('dc-tabbable', this._keyboardAccessible)\n            .attr('fill', 'white')\n            .attr('x', (d, i) => cols(this.keyAccessor()(d, i)))\n            .attr('y', (d, i) => rows(this.valueAccessor()(d, i)))\n            .on('click', adaptHandler(this.boxOnClick()));\n\n        if (this._keyboardAccessible) {\n            this._makeKeyboardAccessible(this.boxOnClick);\n        }\n\n        boxes = gEnter.merge(boxes);\n\n        if (this.renderTitle()) {\n            gEnter.append('title');\n            boxes.select('title').text(this.title());\n        }\n\n        transition(boxes.select('rect'), this.transitionDuration(), this.transitionDelay())\n            .attr('x', (d, i) => cols(this.keyAccessor()(d, i)))\n            .attr('y', (d, i) => rows(this.valueAccessor()(d, i)))\n            .attr('rx', this._xBorderRadius)\n            .attr('ry', this._yBorderRadius)\n            .attr('fill', this.getColor)\n            .attr('width', boxWidth)\n            .attr('height', boxHeight);\n\n        let gCols = this._chartBody.select('g.cols');\n        if (gCols.empty()) {\n            gCols = this._chartBody.append('g').attr('class', 'cols axis');\n        }\n        let gColsText = gCols.selectAll('text').data(cols.domain());\n\n        gColsText.exit().remove();\n\n        gColsText = gColsText\n            .enter()\n            .append('text')\n            .attr('x', d => cols(d) + boxWidth / 2)\n            .style('text-anchor', 'middle')\n            .attr('y', this.effectiveHeight())\n            .attr('dy', 12)\n            .on('click', adaptHandler(this.xAxisOnClick()))\n            .text(this.colsLabel())\n            .merge(gColsText);\n\n        transition(gColsText, this.transitionDuration(), this.transitionDelay())\n            .text(this.colsLabel())\n            .attr('x', d => cols(d) + boxWidth / 2)\n            .attr('y', this.effectiveHeight());\n\n        let gRows = this._chartBody.select('g.rows');\n        if (gRows.empty()) {\n            gRows = this._chartBody.append('g').attr('class', 'rows axis');\n        }\n\n        let gRowsText = gRows.selectAll('text').data(rows.domain());\n\n        gRowsText.exit().remove();\n\n        gRowsText = gRowsText\n            .enter()\n            .append('text')\n            .style('text-anchor', 'end')\n            .attr('x', 0)\n            .attr('dx', -2)\n            .attr('y', d => rows(d) + boxHeight / 2)\n            .attr('dy', 6)\n            .on('click', adaptHandler(this.yAxisOnClick()))\n            .text(this.rowsLabel())\n            .merge(gRowsText);\n\n        transition(gRowsText, this.transitionDuration(), this.transitionDelay())\n            .text(this.rowsLabel())\n            .attr('y', d => rows(d) + boxHeight / 2);\n\n        if (this.hasFilter()) {\n            const chart = this;\n            this.selectAll('g.box-group').each(function (d) {\n                if (chart.isSelectedNode(d)) {\n                    chart.highlightSelected(this);\n                } else {\n                    chart.fadeDeselected(this);\n                }\n            });\n        } else {\n            const chart = this;\n            this.selectAll('g.box-group').each(function () {\n                chart.resetHighlight(this);\n            });\n        }\n        return this;\n    }\n\n    /**\n     * Gets or sets the handler that fires when an individual cell is clicked in the heatmap.\n     * By default, filtering of the cell will be toggled.\n     * @example\n     * // default box on click handler\n     * chart.boxOnClick(function (d) {\n     *     var filter = d.key;\n     *     events.trigger(function () {\n     *         _chart.filter(filter);\n     *         _chart.redrawGroup();\n     *     });\n     * });\n     * @param  {Function} [handler]\n     * @returns {Function|HeatMap}\n     */\n    boxOnClick (handler) {\n        if (!arguments.length) {\n            return this._boxOnClick;\n        }\n        this._boxOnClick = handler;\n        return this;\n    }\n\n    /**\n     * Gets or sets the handler that fires when a column tick is clicked in the x axis.\n     * By default, if any cells in the column are unselected, the whole column will be selected,\n     * otherwise the whole column will be unselected.\n     * @param  {Function} [handler]\n     * @returns {Function|HeatMap}\n     */\n    xAxisOnClick (handler) {\n        if (!arguments.length) {\n            return this._xAxisOnClick;\n        }\n        this._xAxisOnClick = handler;\n        return this;\n    }\n\n    /**\n     * Gets or sets the handler that fires when a row tick is clicked in the y axis.\n     * By default, if any cells in the row are unselected, the whole row will be selected,\n     * otherwise the whole row will be unselected.\n     * @param  {Function} [handler]\n     * @returns {Function|HeatMap}\n     */\n    yAxisOnClick (handler) {\n        if (!arguments.length) {\n            return this._yAxisOnClick;\n        }\n        this._yAxisOnClick = handler;\n        return this;\n    }\n\n    /**\n     * Gets or sets the X border radius.  Set to 0 to get full rectangles.\n     * @param  {Number} [xBorderRadius=6.75]\n     * @returns {Number|HeatMap}\n     */\n    xBorderRadius (xBorderRadius) {\n        if (!arguments.length) {\n            return this._xBorderRadius;\n        }\n        this._xBorderRadius = xBorderRadius;\n        return this;\n    }\n\n    /**\n     * Gets or sets the Y border radius.  Set to 0 to get full rectangles.\n     * @param  {Number} [yBorderRadius=6.75]\n     * @returns {Number|HeatMap}\n     */\n    yBorderRadius (yBorderRadius) {\n        if (!arguments.length) {\n            return this._yBorderRadius;\n        }\n        this._yBorderRadius = yBorderRadius;\n        return this;\n    }\n\n    isSelectedNode (d) {\n        return this.hasFilter(d.key);\n    }\n}\n\nexport const heatMap = (parent, chartGroup) => new HeatMap(parent, chartGroup);\n","import {select} from 'd3-selection';\nimport {event} from 'd3-selection';\n\nimport {pluck, utils} from '../core/utils';\nimport {adaptHandler} from '../core/d3compat';\nimport {constants} from '../core/constants';\n\n/**\n * htmlLegend is a attachable widget that can be added to other dc charts to render horizontal/vertical legend\n * labels.\n * @example\n * chart.legend(HtmlLegend().container(legendContainerElement).horizontal(false))\n * @returns {HtmlLegend}\n */\nexport class HtmlLegend {\n    constructor () {\n        this._htmlLegendDivCssClass = 'dc-html-legend';\n        this._legendItemCssClassHorizontal = 'dc-legend-item-horizontal';\n        this._legendItemCssClassVertical = 'dc-legend-item-vertical';\n        this._parent = undefined;\n        this._container = undefined;\n        this._legendText = pluck('name');\n        this._maxItems = undefined;\n        this._horizontal = false;\n        this._legendItemClass = undefined;\n        this._highlightSelected = false;\n        this._keyboardAccessible = false;\n    }\n\n    parent (p) {\n        if (!arguments.length) {\n            return this._parent;\n        }\n        this._parent = p;\n        return this;\n    }\n\n    render () {\n        this._defaultLegendItemCssClass = this._horizontal ? this._legendItemCssClassHorizontal : this._legendItemCssClassVertical;\n        this._container.select(`div.${this._htmlLegendDivCssClass}`).remove();\n\n        const container = this._container.append('div').attr('class', this._htmlLegendDivCssClass);\n        container.attr('style', `max-width:${this._container.nodes()[0].style.width}`);\n\n        let legendables = this._parent.legendables();\n        const filters = this._parent.filters();\n\n        if (this._maxItems !== undefined) {\n            legendables = legendables.slice(0, this._maxItems);\n        }\n\n        const legendItemClassName = this._legendItemClass ? this._legendItemClass : this._defaultLegendItemCssClass;\n\n        const itemEnter = container.selectAll(`div.${legendItemClassName}`)\n            .data(legendables).enter()\n            .append('div')\n            .classed(legendItemClassName, true)\n            .on('mouseover', adaptHandler(d => this._parent.legendHighlight(d)))\n            .on('mouseout', adaptHandler(d => this._parent.legendReset(d)))\n            .on('click', adaptHandler(d => this._parent.legendToggle(d)));\n\n        if (this._highlightSelected) {\n            itemEnter.classed(constants.SELECTED_CLASS, d => filters.indexOf(d.name) !== -1);\n        }\n\n        itemEnter.append('span')\n            .attr('class', 'dc-legend-item-color')\n            .style('background-color', pluck('color'));\n\n        itemEnter.append('span')\n            .attr('class', 'dc-legend-item-label')\n            .classed('dc-tabbable', this._keyboardAccessible)\n            .attr('title', this._legendText)\n            .text(this._legendText);\n\n        if (this._keyboardAccessible) {\n            this._makeLegendKeyboardAccessible();\n        }\n    }\n\n    /**\n     * Set the container selector for the legend widget. Required.\n     * @param {String} [container]\n     * @return {String|HtmlLegend}\n     */\n    container (container) {\n        if (!arguments.length) {\n            return this._container;\n        }\n        this._container = select(container);\n        return this;\n    }\n\n    /**\n     * This can be optionally used to override class for legenditem and just use this class style.\n     * This is helpful for overriding the style of a particular chart rather than overriding\n     * the style for all charts.\n     *\n     * Setting this will disable the highlighting of selected items also.\n     * @param {String} [legendItemClass]\n     * @return {String|HtmlLegend}\n     */\n    legendItemClass (legendItemClass) {\n        if (!arguments.length) {\n            return this._legendItemClass;\n        }\n        this._legendItemClass = legendItemClass;\n        return this;\n    }\n\n    /**\n     * This can be optionally used to enable highlighting legends for the selections/filters for the\n     * chart.\n     * @param {String} [highlightSelected]\n     * @return {String|HtmlLegend}\n     */\n    highlightSelected (highlightSelected) {\n        if (!arguments.length) {\n            return this._highlightSelected;\n        }\n        this._highlightSelected = highlightSelected;\n        return this;\n    }\n\n    /**\n     * Display the legend horizontally instead of vertically\n     * @param {String} [horizontal]\n     * @return {String|HtmlLegend}\n     */\n    horizontal (horizontal) {\n        if (!arguments.length) {\n            return this._horizontal;\n        }\n        this._horizontal = horizontal;\n        return this;\n    }\n\n    /**\n     * Set or get the legend text function. The legend widget uses this function to render the legend\n     * text for each item. If no function is specified the legend widget will display the names\n     * associated with each group.\n     * @param  {Function} [legendText]\n     * @returns {Function|HtmlLegend}\n     * @example\n     * // default legendText\n     * legend.legendText(pluck('name'))\n     *\n     * // create numbered legend items\n     * chart.legend(new HtmlLegend().legendText(function(d, i) { return i + '. ' + d.name; }))\n     *\n     * // create legend displaying group counts\n     * chart.legend(new HtmlLegend().legendText(function(d) { return d.name + ': ' d.data; }))\n     */\n    legendText (legendText) {\n        if (!arguments.length) {\n            return this._legendText;\n        }\n        this._legendText = legendText;\n        return this;\n    }\n\n    /**\n     * Maximum number of legend items to display\n     * @param  {Number} [maxItems]\n     * @return {HtmlLegend}\n     */\n    maxItems (maxItems) {\n        if (!arguments.length) {\n            return this._maxItems;\n        }\n        this._maxItems = utils.isNumber(maxItems) ? maxItems : undefined;\n        return this;\n    }\n\n    /**\n     * If set, individual legend items will be focusable from keyboard and on pressing Enter or Space\n     * will behave as if clicked on.\n     * \n     * If `svgDescription` on the parent chart has not been explicitly set, will also set the default \n     * SVG description text to the class constructor name, like BarChart or HeatMap, and make the entire\n     * SVG focusable.\n     * @param {Boolean} [keyboardAccessible=false]\n     * @returns {Boolean|HtmlLegend}\n     */\n    keyboardAccessible (keyboardAccessible) {\n        if (!arguments.length) {\n            return this._keyboardAccessible;\n        }\n        this._keyboardAccessible = keyboardAccessible;\n        return this;\n    }\n\n    _makeLegendKeyboardAccessible () {\n\n        if (!this._parent._svgDescription) {\n\n            this._parent.svg().append('desc')\n                .attr('id', `desc-id-${this._parent.__dcFlag__}`)\n                .html(`${this._parent.svgDescription()}`);\n\n            this._parent.svg()\n                .attr('tabindex', '0')\n                .attr('role', 'img')\n                .attr('aria-labelledby', `desc-id-${this._parent.__dcFlag__}`);\n        }\n\n        const tabElements = this.container()\n            .selectAll('.dc-legend-item-label.dc-tabbable')\n            .attr('tabindex', 0);\n\n        tabElements\n            .on('keydown', d => {\n                // trigger only if d is an object\n                if (event.keyCode === 13 && typeof d === 'object') {\n                    d.chart.legendToggle(d)\n                } \n                // special case for space key press - prevent scrolling\n                if (event.keyCode === 32 && typeof d === 'object') {\n                    d.chart.legendToggle(d)\n                    event.preventDefault();            \n                }\n            })\n            .on('focus', d => {\n                this._parent.legendHighlight(d);\n            })\n            .on('blur', d => {\n                this._parent.legendReset(d);\n            });\n    }\n}\n\nexport const htmlLegend = () => new HtmlLegend();\n","import {pluck, utils} from '../core/utils';\nimport {adaptHandler} from '../core/d3compat';\nimport {constants} from '../core/constants';\n\nconst LABEL_GAP = 2;\n\n/**\n * Legend is a attachable widget that can be added to other dc charts to render horizontal legend\n * labels.\n *\n * Examples:\n * - {@link http://dc-js.github.com/dc.js/ Nasdaq 100 Index}\n * - {@link http://dc-js.github.com/dc.js/crime/index.html Canadian City Crime Stats}\n * @example\n * chart.legend(new Legend().x(400).y(10).itemHeight(13).gap(5))\n * @returns {Legend}\n */\nexport class Legend {\n    constructor () {\n        this._parent = undefined;\n        this._x = 0;\n        this._y = 0;\n        this._itemHeight = 12;\n        this._gap = 5;\n        this._horizontal = false;\n        this._legendWidth = 560;\n        this._itemWidth = 70;\n        this._autoItemWidth = false;\n        this._legendText = pluck('name');\n        this._maxItems = undefined;\n        this._highlightSelected = false;\n        this._keyboardAccessible = false;\n\n        this._g = undefined;\n    }\n\n    parent (p) {\n        if (!arguments.length) {\n            return this._parent;\n        }\n        this._parent = p;\n        return this;\n    }\n\n    /**\n     * Set or get x coordinate for legend widget.\n     * @param  {Number} [x=0]\n     * @returns {Number|Legend}\n     */\n    x (x) {\n        if (!arguments.length) {\n            return this._x;\n        }\n        this._x = x;\n        return this;\n    }\n\n    /**\n     * Set or get y coordinate for legend widget.\n     * @param  {Number} [y=0]\n     * @returns {Number|Legend}\n     */\n    y (y) {\n        if (!arguments.length) {\n            return this._y;\n        }\n        this._y = y;\n        return this;\n    }\n\n    /**\n     * Set or get gap between legend items.\n     * @param  {Number} [gap=5]\n     * @returns {Number|Legend}\n     */\n    gap (gap) {\n        if (!arguments.length) {\n            return this._gap;\n        }\n        this._gap = gap;\n        return this;\n    }\n\n    /**\n     * This can be optionally used to enable highlighting legends for the selections/filters for the\n     * chart.\n     * @param {String} [highlightSelected]\n     * @return {String|dc.legend}\n     **/\n    highlightSelected (highlightSelected) {\n        if (!arguments.length) {\n            return this._highlightSelected;\n        }\n        this._highlightSelected = highlightSelected;\n        return this;\n    }\n\n    /**\n     * Set or get legend item height.\n     * @param  {Number} [itemHeight=12]\n     * @returns {Number|Legend}\n     */\n    itemHeight (itemHeight) {\n        if (!arguments.length) {\n            return this._itemHeight;\n        }\n        this._itemHeight = itemHeight;\n        return this;\n    }\n\n    /**\n     * Position legend horizontally instead of vertically.\n     * @param  {Boolean} [horizontal=false]\n     * @returns {Boolean|Legend}\n     */\n    horizontal (horizontal) {\n        if (!arguments.length) {\n            return this._horizontal;\n        }\n        this._horizontal = horizontal;\n        return this;\n    }\n\n    /**\n     * Maximum width for horizontal legend.\n     * @param  {Number} [legendWidth=500]\n     * @returns {Number|Legend}\n     */\n    legendWidth (legendWidth) {\n        if (!arguments.length) {\n            return this._legendWidth;\n        }\n        this._legendWidth = legendWidth;\n        return this;\n    }\n\n    /**\n     * Legend item width for horizontal legend.\n     * @param  {Number} [itemWidth=70]\n     * @returns {Number|Legend}\n     */\n    itemWidth (itemWidth) {\n        if (!arguments.length) {\n            return this._itemWidth;\n        }\n        this._itemWidth = itemWidth;\n        return this;\n    }\n\n    /**\n     * Turn automatic width for legend items on or off. If true, {@link Legend#itemWidth itemWidth} is ignored.\n     * This setting takes into account the {@link Legend#gap gap}.\n     * @param  {Boolean} [autoItemWidth=false]\n     * @returns {Boolean|Legend}\n     */\n    autoItemWidth (autoItemWidth) {\n        if (!arguments.length) {\n            return this._autoItemWidth;\n        }\n        this._autoItemWidth = autoItemWidth;\n        return this;\n    }\n\n    /**\n     * Set or get the legend text function. The legend widget uses this function to render the legend\n     * text for each item. If no function is specified the legend widget will display the names\n     * associated with each group.\n     * @param  {Function} [legendText]\n     * @returns {Function|Legend}\n     * @example\n     * // default legendText\n     * legend.legendText(pluck('name'))\n     *\n     * // create numbered legend items\n     * chart.legend(new Legend().legendText(function(d, i) { return i + '. ' + d.name; }))\n     *\n     * // create legend displaying group counts\n     * chart.legend(new Legend().legendText(function(d) { return d.name + ': ' d.data; }))\n     */\n    legendText (legendText) {\n        if (!arguments.length) {\n            return this._legendText;\n        }\n        this._legendText = legendText;\n        return this;\n    }\n\n    /**\n     * Maximum number of legend items to display\n     * @param  {Number} [maxItems]\n     * @return {Legend}\n     */\n    maxItems (maxItems) {\n        if (!arguments.length) {\n            return this._maxItems;\n        }\n        this._maxItems = utils.isNumber(maxItems) ? maxItems : undefined;\n        return this;\n    }\n\n    /**\n     * If set, individual legend items will be focusable from keyboard and on pressing Enter or Space\n     * will behave as if clicked on.\n     * \n     * If `svgDescription` on the parent chart has not been explicitly set, will also set the default \n     * SVG description text to the class constructor name, like BarChart or HeatMap, and make the entire\n     * SVG focusable.\n     * @param {Boolean} [keyboardAccessible=false]\n     * @returns {Boolean|Legend}\n     */\n    keyboardAccessible (keyboardAccessible) {\n        if (!arguments.length) {\n            return this._keyboardAccessible;\n        }\n        this._keyboardAccessible = keyboardAccessible;\n        return this;\n    }\n\n    // Implementation methods\n\n    _legendItemHeight () {\n        return this._gap + this._itemHeight;\n    }\n\n    _makeLegendKeyboardAccessible () {\n\n        if (!this._parent._svgDescription) {\n\n            this._parent.svg().append('desc')\n                .attr('id', `desc-id-${this._parent.__dcFlag__}`)\n                .html(`${this._parent.svgDescription()}`);\n\n            this._parent.svg()\n                .attr('tabindex', '0')\n                .attr('role', 'img')\n                .attr('aria-labelledby', `desc-id-${this._parent.__dcFlag__}`);\n        }\n\n        const tabElements = this._parent.svg()\n            .selectAll('.dc-legend .dc-tabbable')\n            .attr('tabindex', 0);\n\n        tabElements\n            .on('keydown', adaptHandler((d, event) => {\n                // trigger only if d is an object\n                if (event.keyCode === 13 && typeof d === 'object') {\n                    d.chart.legendToggle(d)\n                } \n                // special case for space key press - prevent scrolling\n                if (event.keyCode === 32 && typeof d === 'object') {\n                    d.chart.legendToggle(d)\n                    event.preventDefault();            \n                }\n            }))\n            .on('focus', adaptHandler(d => {\n                this._parent.legendHighlight(d);\n            }))\n            .on('blur', adaptHandler(d => {\n                this._parent.legendReset(d);\n            }));\n    }\n\n    render () {\n        this._parent.svg().select('g.dc-legend').remove();\n        this._g = this._parent.svg().append('g')\n            .attr('class', 'dc-legend')\n            .attr('transform', `translate(${this._x},${this._y})`);\n        let legendables = this._parent.legendables();\n        const filters = this._parent.filters();\n\n        if (this._maxItems !== undefined) {\n            legendables = legendables.slice(0, this._maxItems);\n        }\n\n        const itemEnter = this._g.selectAll('g.dc-legend-item')\n            .data(legendables)\n            .enter()\n            .append('g')\n            .attr('class', 'dc-legend-item')\n            .on('mouseover', adaptHandler(d => {\n                this._parent.legendHighlight(d);\n            }))\n            .on('mouseout', adaptHandler(d => {\n                this._parent.legendReset(d);\n            }))\n            .on('click', adaptHandler(d => {\n                d.chart.legendToggle(d);\n            }));\n\n        if (this._highlightSelected) {\n            itemEnter.classed(constants.SELECTED_CLASS,\n                              d => filters.indexOf(d.name) !== -1);\n        }\n\n\n        this._g.selectAll('g.dc-legend-item')\n            .classed('fadeout', d => d.chart.isLegendableHidden(d));\n\n        if (legendables.some(pluck('dashstyle'))) {\n            itemEnter\n                .append('line')\n                .attr('x1', 0)\n                .attr('y1', this._itemHeight / 2)\n                .attr('x2', this._itemHeight)\n                .attr('y2', this._itemHeight / 2)\n                .attr('stroke-width', 2)\n                .attr('stroke-dasharray', pluck('dashstyle'))\n                .attr('stroke', pluck('color'));\n        } else {\n            itemEnter\n                .append('rect')\n                .attr('width', this._itemHeight)\n                .attr('height', this._itemHeight)\n                .attr('fill', d => d ? d.color : 'blue');\n        }\n\n        {\n            const self = this;\n\n            itemEnter.append('text')\n                .text(self._legendText)\n                .classed('dc-tabbable', this._keyboardAccessible)\n                .attr('x', self._itemHeight + LABEL_GAP)\n                .attr('y', function () {\n                    return self._itemHeight / 2 + (this.clientHeight ? this.clientHeight : 13) / 2 - 2;\n                });\n\n            if (this._keyboardAccessible) {\n                this._makeLegendKeyboardAccessible();\n            }\n        }\n\n        let cumulativeLegendTextWidth = 0;\n        let row = 0;\n\n        {\n            const self = this;\n\n            itemEnter.attr('transform', function (d, i) {\n                if (self._horizontal) {\n                    const itemWidth = self._autoItemWidth === true ? this.getBBox().width + self._gap : self._itemWidth;\n                    if ((cumulativeLegendTextWidth + itemWidth) > self._legendWidth && cumulativeLegendTextWidth > 0) {\n                        ++row;\n                        cumulativeLegendTextWidth = 0;\n                    }\n                    const translateBy = `translate(${cumulativeLegendTextWidth},${row * self._legendItemHeight()})`;\n                    cumulativeLegendTextWidth += itemWidth;\n                    return translateBy;\n                } else {\n                    return `translate(0,${i * self._legendItemHeight()})`;\n                }\n            });\n        }\n    }\n\n}\n\nexport const legend = () => new Legend();\n","import {\n    area,\n    curveBasis,\n    curveBasisClosed,\n    curveBasisOpen,\n    curveBundle,\n    curveCardinal,\n    curveCardinalClosed,\n    curveCardinalOpen,\n    curveLinear,\n    curveLinearClosed,\n    curveMonotoneX,\n    curveStep,\n    curveStepAfter,\n    curveStepBefore,\n    line\n} from 'd3-shape';\nimport {select} from 'd3-selection';\n\nimport {logger} from '../core/logger';\nimport {pluck, utils} from '../core/utils';\nimport {StackMixin} from '../base/stack-mixin';\nimport {transition} from '../core/core';\n\nconst DEFAULT_DOT_RADIUS = 5;\nconst TOOLTIP_G_CLASS = 'dc-tooltip';\nconst DOT_CIRCLE_CLASS = 'dot';\nconst Y_AXIS_REF_LINE_CLASS = 'yRef';\nconst X_AXIS_REF_LINE_CLASS = 'xRef';\nconst DEFAULT_DOT_OPACITY = 1e-6;\nconst LABEL_PADDING = 3;\n\n/**\n * Concrete line/area chart implementation.\n *\n * Examples:\n * - {@link http://dc-js.github.com/dc.js/ Nasdaq 100 Index}\n * - {@link http://dc-js.github.com/dc.js/crime/index.html Canadian City Crime Stats}\n * @mixes StackMixin\n * @mixes CoordinateGridMixin\n */\nexport class LineChart extends StackMixin {\n    /**\n     * Create a Line Chart.\n     * @example\n     * // create a line chart under #chart-container1 element using the default global chart group\n     * var chart1 = new LineChart('#chart-container1');\n     * // create a line chart under #chart-container2 element using chart group A\n     * var chart2 = new LineChart('#chart-container2', 'chartGroupA');\n     * // create a sub-chart under a composite parent chart\n     * var chart3 = new LineChart(compositeChart);\n     * @param {String|node|d3.selection|CompositeChart} parent - Any valid\n     * {@link https://github.com/d3/d3-selection/blob/master/README.md#select d3 single selector}\n     * specifying a dom block element such as a div; or a dom element or d3 selection.  If the line\n     * chart is a sub-chart in a {@link CompositeChart Composite Chart} then pass in the parent\n     * composite chart instance instead.\n     * @param {String} [chartGroup] - The name of the chart group this chart instance should be placed in.\n     * Interaction with a chart will only trigger events and redraws within the chart's group.\n     */\n    constructor (parent, chartGroup) {\n        super();\n\n        this._renderArea = false;\n        this._dotRadius = DEFAULT_DOT_RADIUS;\n        this._dataPointRadius = null;\n        this._dataPointFillOpacity = DEFAULT_DOT_OPACITY;\n        this._dataPointStrokeOpacity = DEFAULT_DOT_OPACITY;\n        this._curve = null;\n        this._interpolate = null; // d3.curveLinear;  // deprecated in 3.0\n        this._tension = null;  // deprecated in 3.0\n        this._defined = undefined;\n        this._dashStyle = undefined;\n        this._xyTipsOn = true;\n\n        this.transitionDuration(500);\n        this.transitionDelay(0);\n        this._rangeBandPadding(1);\n\n        this.label(d => utils.printSingleValue(d.y0 + d.y), false);\n\n        this.anchor(parent, chartGroup);\n    }\n\n    plotData () {\n        const chartBody = this.chartBodyG();\n        let layersList = chartBody.select('g.stack-list');\n\n        if (layersList.empty()) {\n            layersList = chartBody.append('g').attr('class', 'stack-list');\n        }\n\n        let layers = layersList.selectAll('g.stack').data(this.data());\n\n        const layersEnter = layers\n            .enter()\n            .append('g')\n            .attr('class', (d, i) => `stack _${i}`);\n\n        layers = layersEnter.merge(layers);\n\n        this._drawLine(layersEnter, layers);\n\n        this._drawArea(layersEnter, layers);\n\n        this._drawDots(chartBody, layers);\n\n        if (this.renderLabel()) {\n            this._drawLabels(layers);\n        }\n    }\n\n    /**\n     * Gets or sets the curve factory to use for lines and areas drawn, allowing e.g. step\n     * functions, splines, and cubic interpolation. Typically you would use one of the interpolator functions\n     * provided by {@link https://github.com/d3/d3-shape/blob/master/README.md#curves d3 curves}.\n     *\n     * Replaces the use of {@link LineChart#interpolate} and {@link LineChart#tension}\n     * in dc.js < 3.0\n     *\n     * This is passed to\n     * {@link https://github.com/d3/d3-shape/blob/master/README.md#line_curve line.curve} and\n     * {@link https://github.com/d3/d3-shape/blob/master/README.md#area_curve area.curve}.\n     * @example\n     * // default\n     * chart\n     *     .curve(d3.curveLinear);\n     * // Add tension to curves that support it\n     * chart\n     *     .curve(d3.curveCardinal.tension(0.5));\n     * // You can use some specialized variation like\n     * // https://en.wikipedia.org/wiki/Centripetal_Catmull%E2%80%93Rom_spline\n     * chart\n     *     .curve(d3.curveCatmullRom.alpha(0.5));\n     * @see {@link https://github.com/d3/d3-shape/blob/master/README.md#line_curve line.curve}\n     * @see {@link https://github.com/d3/d3-shape/blob/master/README.md#area_curve area.curve}\n     * @param  {d3.curve} [curve=d3.curveLinear]\n     * @returns {d3.curve|LineChart}\n     */\n    curve (curve) {\n        if (!arguments.length) {\n            return this._curve;\n        }\n        this._curve = curve;\n        return this;\n    }\n\n    /**\n     * Gets or sets the interpolator to use for lines drawn, by string name, allowing e.g. step\n     * functions, splines, and cubic interpolation.\n     *\n     * Possible values are: 'linear', 'linear-closed', 'step', 'step-before', 'step-after', 'basis',\n     * 'basis-open', 'basis-closed', 'bundle', 'cardinal', 'cardinal-open', 'cardinal-closed', and\n     * 'monotone'.\n     *\n     * This function exists for backward compatibility. Use {@link LineChart#curve}\n     * which is generic and provides more options.\n     * Value set through `.curve` takes precedence over `.interpolate` and `.tension`.\n     * @deprecated since version 3.0 use {@link LineChart#curve} instead\n     * @see {@link LineChart#curve}\n     * @param  {d3.curve} [interpolate=d3.curveLinear]\n     * @returns {d3.curve|LineChart}\n     */\n    interpolate (interpolate) {\n        logger.warnOnce('dc.lineChart.interpolate has been deprecated since version 3.0 use dc.lineChart.curve instead');\n        if (!arguments.length) {\n            return this._interpolate;\n        }\n        this._interpolate = interpolate;\n        return this;\n    }\n\n    /**\n     * Gets or sets the tension to use for lines drawn, in the range 0 to 1.\n     *\n     * Passed to the {@link https://github.com/d3/d3-shape/blob/master/README.md#curves d3 curve function}\n     * if it provides a `.tension` function. Example:\n     * {@link https://github.com/d3/d3-shape/blob/master/README.md#curveCardinal_tension curveCardinal.tension}.\n     *\n     * This function exists for backward compatibility. Use {@link LineChart#curve}\n     * which is generic and provides more options.\n     * Value set through `.curve` takes precedence over `.interpolate` and `.tension`.\n     * @deprecated since version 3.0 use {@link LineChart#curve} instead\n     * @see {@link LineChart#curve}\n     * @param  {Number} [tension=0]\n     * @returns {Number|LineChart}\n     */\n    tension (tension) {\n        logger.warnOnce('dc.lineChart.tension has been deprecated since version 3.0 use dc.lineChart.curve instead');\n        if (!arguments.length) {\n            return this._tension;\n        }\n        this._tension = tension;\n        return this;\n    }\n\n    /**\n     * Gets or sets a function that will determine discontinuities in the line which should be\n     * skipped: the path will be broken into separate subpaths if some points are undefined.\n     * This function is passed to\n     * {@link https://github.com/d3/d3-shape/blob/master/README.md#line_defined line.defined}\n     *\n     * Note: crossfilter will sometimes coerce nulls to 0, so you may need to carefully write\n     * custom reduce functions to get this to work, depending on your data. See\n     * {@link https://github.com/dc-js/dc.js/issues/615#issuecomment-49089248 this GitHub comment}\n     * for more details and an example.\n     * @see {@link https://github.com/d3/d3-shape/blob/master/README.md#line_defined line.defined}\n     * @param  {Function} [defined]\n     * @returns {Function|LineChart}\n     */\n    defined (defined) {\n        if (!arguments.length) {\n            return this._defined;\n        }\n        this._defined = defined;\n        return this;\n    }\n\n    /**\n     * Set the line's d3 dashstyle. This value becomes the 'stroke-dasharray' of line. Defaults to empty\n     * array (solid line).\n     * @see {@link https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/stroke-dasharray stroke-dasharray}\n     * @example\n     * // create a Dash Dot Dot Dot\n     * chart.dashStyle([3,1,1,1]);\n     * @param  {Array<Number>} [dashStyle=[]]\n     * @returns {Array<Number>|LineChart}\n     */\n    dashStyle (dashStyle) {\n        if (!arguments.length) {\n            return this._dashStyle;\n        }\n        this._dashStyle = dashStyle;\n        return this;\n    }\n\n    /**\n     * Get or set render area flag. If the flag is set to true then the chart will render the area\n     * beneath each line and the line chart effectively becomes an area chart.\n     * @param  {Boolean} [renderArea=false]\n     * @returns {Boolean|LineChart}\n     */\n    renderArea (renderArea) {\n        if (!arguments.length) {\n            return this._renderArea;\n        }\n        this._renderArea = renderArea;\n        return this;\n    }\n\n    _getColor (d, i) {\n        return this.getColor.call(d, d.values, i);\n    }\n\n    // To keep it backward compatible, this covers multiple cases\n    // See https://github.com/dc-js/dc.js/issues/1376\n    // It will be removed when interpolate and tension are removed.\n    _getCurveFactory () {\n        let curve = null;\n\n        // _curve takes precedence\n        if (this._curve) {\n            return this._curve;\n        }\n\n        // Approximate the D3v3 behavior\n        if (typeof this._interpolate === 'function') {\n            curve = this._interpolate;\n        } else {\n            // If _interpolate is string\n            const mapping = {\n                'linear': curveLinear,\n                'linear-closed': curveLinearClosed,\n                'step': curveStep,\n                'step-before': curveStepBefore,\n                'step-after': curveStepAfter,\n                'basis': curveBasis,\n                'basis-open': curveBasisOpen,\n                'basis-closed': curveBasisClosed,\n                'bundle': curveBundle,\n                'cardinal': curveCardinal,\n                'cardinal-open': curveCardinalOpen,\n                'cardinal-closed': curveCardinalClosed,\n                'monotone': curveMonotoneX\n            };\n            curve = mapping[this._interpolate];\n        }\n\n        // Default value\n        if (!curve) {\n            curve = curveLinear;\n        }\n\n        if (this._tension !== null) {\n            if (typeof curve.tension !== 'function') {\n                logger.warn('tension was specified but the curve/interpolate does not support it.');\n            } else {\n                curve = curve.tension(this._tension);\n            }\n        }\n        return curve;\n    }\n\n    _drawLine (layersEnter, layers) {\n        const _line = line()\n            .x(d => this.x()(d.x))\n            .y(d => this.y()(d.y + d.y0))\n            .curve(this._getCurveFactory());\n        if (this._defined) {\n            _line.defined(this._defined);\n        }\n\n        const path = layersEnter.append('path')\n            .attr('class', 'line')\n            .attr('stroke', (d, i) => this._getColor(d, i));\n        if (this._dashStyle) {\n            path.attr('stroke-dasharray', this._dashStyle);\n        }\n\n        transition(layers.select('path.line'), this.transitionDuration(), this.transitionDelay())\n        //.ease('linear')\n            .attr('stroke', (d, i) => this._getColor(d, i))\n            .attr('d', d => this._safeD(_line(d.values)));\n    }\n\n    _drawArea (layersEnter, layers) {\n        if (this._renderArea) {\n            const _area = area()\n                .x(d => this.x()(d.x))\n                .y1(d => this.y()(d.y + d.y0))\n                .y0(d => this.y()(d.y0))\n                .curve(this._getCurveFactory());\n            if (this._defined) {\n                _area.defined(this._defined);\n            }\n\n            layersEnter.append('path')\n                .attr('class', 'area')\n                .attr('fill', (d, i) => this._getColor(d, i))\n                .attr('d', d => this._safeD(_area(d.values)));\n\n            transition(layers.select('path.area'), this.transitionDuration(), this.transitionDelay())\n            //.ease('linear')\n                .attr('fill', (d, i) => this._getColor(d, i))\n                .attr('d', d => this._safeD(_area(d.values)));\n        }\n    }\n\n    _safeD (d) {\n        return (!d || d.indexOf('NaN') >= 0) ? 'M0,0' : d;\n    }\n\n    _drawDots (chartBody, layers) {\n        if (this.xyTipsOn() === 'always' || (!(this.brushOn() || this.parentBrushOn()) && this.xyTipsOn())) {\n            const tooltipListClass = `${TOOLTIP_G_CLASS}-list`;\n            let tooltips = chartBody.select(`g.${tooltipListClass}`);\n\n            if (tooltips.empty()) {\n                tooltips = chartBody.append('g').attr('class', tooltipListClass);\n            }\n\n            layers.each((data, layerIndex) => {\n                let points = data.values;\n                if (this._defined) {\n                    points = points.filter(this._defined);\n                }\n\n                let g = tooltips.select(`g.${TOOLTIP_G_CLASS}._${layerIndex}`);\n                if (g.empty()) {\n                    g = tooltips.append('g').attr('class', `${TOOLTIP_G_CLASS} _${layerIndex}`);\n                }\n\n                this._createRefLines(g);\n\n                const dots = g.selectAll(`circle.${DOT_CIRCLE_CLASS}`)\n                    .data(points, pluck('x'));\n\n                const chart = this;\n                const dotsEnterModify = dots\n                    .enter()\n                    .append('circle')\n                    .attr('class', DOT_CIRCLE_CLASS)\n                    .classed('dc-tabbable', this._keyboardAccessible)\n                    .attr('cx', d => utils.safeNumber(this.x()(d.x)))\n                    .attr('cy', d => utils.safeNumber(this.y()(d.y + d.y0)))\n                    .attr('r', this._getDotRadius())\n                    .style('fill-opacity', this._dataPointFillOpacity)\n                    .style('stroke-opacity', this._dataPointStrokeOpacity)\n                    .attr('fill', this.getColor)\n                    .attr('stroke', this.getColor)\n                    .on('mousemove', function () {\n                        const dot = select(this);\n                        chart._showDot(dot);\n                        chart._showRefLines(dot, g);\n                    })\n                    .on('mouseout', function () {\n                        const dot = select(this);\n                        chart._hideDot(dot);\n                        chart._hideRefLines(g);\n                    })\n                    .merge(dots);\n\n                // special case for on-focus for line chart and its dots\n                if (this._keyboardAccessible) {\n\n                    this._svg.selectAll('.dc-tabbable')\n                        .attr('tabindex', 0)\n                        .on('focus', function () {\n                            const dot = select(this);\n                            chart._showDot(dot);\n                            chart._showRefLines(dot, g);\n                        })\n                        .on('blur', function () {\n                            const dot = select(this);\n                            chart._hideDot(dot);\n                            chart._hideRefLines(g);\n                        });\n                }\n\n                dotsEnterModify.call(dot => this._doRenderTitle(dot, data));\n\n                transition(dotsEnterModify, this.transitionDuration())\n                    .attr('cx', d => utils.safeNumber(this.x()(d.x)))\n                    .attr('cy', d => utils.safeNumber(this.y()(d.y + d.y0)))\n                    .attr('fill', this.getColor);\n\n                dots.exit().remove();\n            });\n        }\n    }\n\n    _drawLabels (layers) {\n        const chart = this;\n        layers.each(function (data, layerIndex) {\n            const layer = select(this);\n            const labels = layer.selectAll('text.lineLabel')\n                .data(data.values, pluck('x'));\n\n            const labelsEnterModify = labels\n                .enter()\n                .append('text')\n                .attr('class', 'lineLabel')\n                .attr('text-anchor', 'middle')\n                .merge(labels);\n\n            transition(labelsEnterModify, chart.transitionDuration())\n                .attr('x', d => utils.safeNumber(chart.x()(d.x)))\n                .attr('y', d => {\n                    const y = chart.y()(d.y + d.y0) - LABEL_PADDING;\n                    return utils.safeNumber(y);\n                })\n                .text(d => chart.label()(d));\n\n            transition(labels.exit(), chart.transitionDuration())\n                .attr('height', 0)\n                .remove();\n        });\n    }\n\n    _createRefLines (g) {\n        const yRefLine = g.select(`path.${Y_AXIS_REF_LINE_CLASS}`).empty() ?\n            g.append('path').attr('class', Y_AXIS_REF_LINE_CLASS) : g.select(`path.${Y_AXIS_REF_LINE_CLASS}`);\n        yRefLine.style('display', 'none').attr('stroke-dasharray', '5,5');\n\n        const xRefLine = g.select(`path.${X_AXIS_REF_LINE_CLASS}`).empty() ?\n            g.append('path').attr('class', X_AXIS_REF_LINE_CLASS) : g.select(`path.${X_AXIS_REF_LINE_CLASS}`);\n        xRefLine.style('display', 'none').attr('stroke-dasharray', '5,5');\n    }\n\n    _showDot (dot) {\n        dot.style('fill-opacity', 0.8);\n        dot.style('stroke-opacity', 0.8);\n        dot.attr('r', this._dotRadius);\n        return dot;\n    }\n\n    _showRefLines (dot, g) {\n        const x = dot.attr('cx');\n        const y = dot.attr('cy');\n        const yAxisX = (this._yAxisX() - this.margins().left);\n        const yAxisRefPathD = `M${yAxisX} ${y}L${x} ${y}`;\n        const xAxisRefPathD = `M${x} ${this.yAxisHeight()}L${x} ${y}`;\n        g.select(`path.${Y_AXIS_REF_LINE_CLASS}`).style('display', '').attr('d', yAxisRefPathD);\n        g.select(`path.${X_AXIS_REF_LINE_CLASS}`).style('display', '').attr('d', xAxisRefPathD);\n    }\n\n    _getDotRadius () {\n        return this._dataPointRadius || this._dotRadius;\n    }\n\n    _hideDot (dot) {\n        dot.style('fill-opacity', this._dataPointFillOpacity)\n            .style('stroke-opacity', this._dataPointStrokeOpacity)\n            .attr('r', this._getDotRadius());\n    }\n\n    _hideRefLines (g) {\n        g.select(`path.${Y_AXIS_REF_LINE_CLASS}`).style('display', 'none');\n        g.select(`path.${X_AXIS_REF_LINE_CLASS}`).style('display', 'none');\n    }\n\n    _doRenderTitle (dot, d) {\n        if (this.renderTitle()) {\n            dot.select('title').remove();\n            dot.append('title').text(pluck('data', this.title(d.name)));\n        }\n    }\n\n    /**\n     * Turn on/off the mouseover behavior of an individual data point which renders a circle and x/y axis\n     * dashed lines back to each respective axis.  This is ignored if the chart\n     * {@link CoordinateGridMixin#brushOn brush} is on\n     * @param  {Boolean} [xyTipsOn=false]\n     * @returns {Boolean|LineChart}\n     */\n    xyTipsOn (xyTipsOn) {\n        if (!arguments.length) {\n            return this._xyTipsOn;\n        }\n        this._xyTipsOn = xyTipsOn;\n        return this;\n    }\n\n    /**\n     * Get or set the radius (in px) for dots displayed on the data points.\n     * @param  {Number} [dotRadius=5]\n     * @returns {Number|LineChart}\n     */\n    dotRadius (dotRadius) {\n        if (!arguments.length) {\n            return this._dotRadius;\n        }\n        this._dotRadius = dotRadius;\n        return this;\n    }\n\n    /**\n     * Always show individual dots for each datapoint.\n     *\n     * If `options` is falsy, it disables data point rendering. If no `options` are provided, the\n     * current `options` values are instead returned.\n     * @example\n     * chart.renderDataPoints({radius: 2, fillOpacity: 0.8, strokeOpacity: 0.0})\n     * @param  {{fillOpacity: Number, strokeOpacity: Number, radius: Number}} [options={fillOpacity: 0.8, strokeOpacity: 0.0, radius: 2}]\n     * @returns {{fillOpacity: Number, strokeOpacity: Number, radius: Number}|LineChart}\n     */\n    renderDataPoints (options) {\n        if (!arguments.length) {\n            return {\n                fillOpacity: this._dataPointFillOpacity,\n                strokeOpacity: this._dataPointStrokeOpacity,\n                radius: this._dataPointRadius\n            };\n        } else if (!options) {\n            this._dataPointFillOpacity = DEFAULT_DOT_OPACITY;\n            this._dataPointStrokeOpacity = DEFAULT_DOT_OPACITY;\n            this._dataPointRadius = null;\n        } else {\n            this._dataPointFillOpacity = options.fillOpacity || 0.8;\n            this._dataPointStrokeOpacity = options.strokeOpacity || 0.0;\n            this._dataPointRadius = options.radius || 2;\n        }\n        return this;\n    }\n\n    _colorFilter (color, dashstyle, inv) {\n        return function () {\n            const item = select(this);\n            const match = (item.attr('stroke') === color &&\n                item.attr('stroke-dasharray') === ((dashstyle instanceof Array) ?\n                    dashstyle.join(',') : null)) || item.attr('fill') === color;\n            return inv ? !match : match;\n        };\n    }\n\n    legendHighlight (d) {\n        if (!this.isLegendableHidden(d)) {\n            this.g().selectAll('path.line, path.area')\n                .classed('highlight', this._colorFilter(d.color, d.dashstyle))\n                .classed('fadeout', this._colorFilter(d.color, d.dashstyle, true));\n        }\n    }\n\n    legendReset () {\n        this.g().selectAll('path.line, path.area')\n            .classed('highlight', false)\n            .classed('fadeout', false);\n    }\n\n    legendables () {\n        const legendables = super.legendables();\n        if (!this._dashStyle) {\n            return legendables;\n        }\n        return legendables.map(l => {\n            l.dashstyle = this._dashStyle;\n            return l;\n        });\n    }\n}\n\nexport const lineChart = (parent, chartGroup) => new LineChart(parent, chartGroup);\n","import {format} from 'd3-format';\nimport {easeQuad} from 'd3-ease';\nimport {interpolateNumber} from 'd3-interpolate';\n\nimport {BaseMixin} from '../base/base-mixin';\n\nconst SPAN_CLASS = 'number-display';\n\n/**\n * A display of a single numeric value.\n *\n * Unlike other charts, you do not need to set a dimension. Instead a group object must be provided and\n * a valueAccessor that returns a single value.\n *\n * If the group is a {@link https://github.com/crossfilter/crossfilter/wiki/API-Reference#crossfilter_groupAll groupAll}\n * then its `.value()` will be displayed. This is the recommended usage.\n *\n * However, if it is given an ordinary group, the `numberDisplay` will show the last bin's value, after\n * sorting with the {@link https://dc-js.github.io/dc.js/docs/html/dc.baseMixin.html#ordering__anchor ordering}\n * function. `numberDisplay` defaults the `ordering` function to sorting by value, so this will display\n * the largest value if the values are numeric.\n * @mixes BaseMixin\n */\nexport class NumberDisplay extends BaseMixin {\n    /**\n     * Create a Number Display widget.\n     *\n     * @example\n     * // create a number display under #chart-container1 element using the default global chart group\n     * var display1 = new NumberDisplay('#chart-container1');\n     * @param {String|node|d3.selection} parent - Any valid\n     * {@link https://github.com/d3/d3-selection/blob/master/README.md#select d3 single selector} specifying\n     * a dom block element such as a div; or a dom element or d3 selection.\n     * @param {String} [chartGroup] - The name of the chart group this chart instance should be placed in.\n     * Interaction with a chart will only trigger events and redraws within the chart's group.\n     */\n    constructor (parent, chartGroup) {\n        super();\n\n        this._formatNumber = format('.2s');\n        this._html = {one: '', some: '', none: ''};\n        this._lastValue = undefined;\n        this._ariaLiveRegion = false;\n\n        // dimension not required\n        this._mandatoryAttributes(['group']);\n\n        // default to ordering by value, to emulate old group.top(1) behavior when multiple groups\n        this.ordering(kv => kv.value);\n\n        this.data(group => {\n            const valObj = group.value ? group.value() : this._maxBin(group.all());\n            return this.valueAccessor()(valObj);\n        });\n\n        this.transitionDuration(250); // good default\n        this.transitionDelay(0);\n\n        this.anchor(parent, chartGroup);\n    }\n\n    /**\n     * Gets or sets an optional object specifying HTML templates to use depending on the number\n     * displayed.  The text `%number` will be replaced with the current value.\n     * - one: HTML template to use if the number is 1\n     * - zero: HTML template to use if the number is 0\n     * - some: HTML template to use otherwise\n     * @example\n     * numberWidget.html({\n     *      one:'%number record',\n     *      some:'%number records',\n     *      none:'no records'})\n     * @param {{one:String, some:String, none:String}} [html={one: '', some: '', none: ''}]\n     * @returns {{one:String, some:String, none:String}|NumberDisplay}\n     */\n    html (html) {\n        if (!arguments.length) {\n            return this._html;\n        }\n        if (html.none) {\n            this._html.none = html.none;//if none available\n        } else if (html.one) {\n            this._html.none = html.one;//if none not available use one\n        } else if (html.some) {\n            this._html.none = html.some;//if none and one not available use some\n        }\n        if (html.one) {\n            this._html.one = html.one;//if one available\n        } else if (html.some) {\n            this._html.one = html.some;//if one not available use some\n        }\n        if (html.some) {\n            this._html.some = html.some;//if some available\n        } else if (html.one) {\n            this._html.some = html.one;//if some not available use one\n        }\n        return this;\n    }\n\n    /**\n     * Calculate and return the underlying value of the display.\n     * @returns {Number}\n     */\n    value () {\n        return this.data();\n    }\n\n    _maxBin (all) {\n        if (!all.length) {\n            return null;\n        }\n        const sorted = this._computeOrderedGroups(all);\n        return sorted[sorted.length - 1];\n    }\n\n    _doRender () {\n        const newValue = this.value();\n        let span = this.selectAll(`.${SPAN_CLASS}`);\n\n        if (span.empty()) {\n            span = span.data([0])\n                .enter()\n                .append('span')\n                .attr('class', SPAN_CLASS)\n                .classed('dc-tabbable', this._keyboardAccessible)\n                .merge(span);\n\n            if (this._keyboardAccessible) {\n                span.attr('tabindex', '0');\n            }\n\n            if (this._ariaLiveRegion) {\n                this.transitionDuration(0);\n                span.attr('aria-live', 'polite');\n            }\n        }\n\n        {\n            const chart = this;\n            span.transition()\n                .duration(chart.transitionDuration())\n                .delay(chart.transitionDelay())\n                .ease(easeQuad)\n                .tween('text', function () {\n                    // [XA] don't try and interpolate from Infinity, else this breaks.\n                    const interpStart = isFinite(chart._lastValue) ? chart._lastValue : 0;\n                    const interp = interpolateNumber(interpStart || 0, newValue);\n                    chart._lastValue = newValue;\n\n                    // need to save it in D3v4\n                    const node = this;\n                    return t => {\n                        let html = null;\n                        const num = chart.formatNumber()(interp(t));\n                        if (newValue === 0 && (chart._html.none !== '')) {\n                            html = chart._html.none;\n                        } else if (newValue === 1 && (chart._html.one !== '')) {\n                            html = chart._html.one;\n                        } else if (chart._html.some !== '') {\n                            html = chart._html.some;\n                        }\n                        node.innerHTML = html ? html.replace('%number', num) : num;\n                    };\n                });\n        }\n    }\n\n    _doRedraw () {\n        return this._doRender();\n    }\n\n    /**\n     * Get or set a function to format the value for the display.\n     * @see {@link https://github.com/d3/d3-format/blob/master/README.md#format d3.format}\n     * @param {Function} [formatter=d3.format('.2s')]\n     * @returns {Function|NumberDisplay}\n     */\n    formatNumber (formatter) {\n        if (!arguments.length) {\n            return this._formatNumber;\n        }\n        this._formatNumber = formatter;\n        return this;\n    }\n\n    /**\n     * If set, the Number Display widget will have its aria-live attribute set to 'polite' which will\n     * notify screen readers when the widget changes its value. Note that setting this method will also\n     * disable the default transition between the old and the new values. This is to avoid change\n     * notifications spoken out before the new value finishes re-drawing. It is also advisable to check\n     * if the widget has appropriately set accessibility description or label. \n     * @param {Boolean} [ariaLiveRegion=false]\n     * @returns {Boolean|NumberDisplay}\n     */\n    ariaLiveRegion (ariaLiveRegion) {\n        if (!arguments.length) {\n            return this._ariaLiveRegion;\n        }\n        this._ariaLiveRegion = ariaLiveRegion;\n        return this;\n    }\n\n}\n\nexport const numberDisplay = (parent, chartGroup) => new NumberDisplay(parent, chartGroup);\n","import {min, sum} from 'd3-array';\nimport {arc, pie} from 'd3-shape';\nimport {select} from 'd3-selection';\nimport {interpolate} from 'd3-interpolate';\n\nimport {CapMixin} from '../base/cap-mixin';\nimport {ColorMixin} from '../base/color-mixin';\nimport {BaseMixin} from '../base/base-mixin';\nimport {transition} from '../core/core';\nimport {adaptHandler} from '../core/d3compat';\n\nconst DEFAULT_MIN_ANGLE_FOR_LABEL = 0.5;\n\n/**\n * The pie chart implementation is usually used to visualize a small categorical distribution.  The pie\n * chart uses keyAccessor to determine the slices, and valueAccessor to calculate the size of each\n * slice relative to the sum of all values. Slices are ordered by {@link BaseMixin#ordering ordering}\n * which defaults to sorting by key.\n *\n * Examples:\n * - {@link http://dc-js.github.com/dc.js/ Nasdaq 100 Index}\n * @mixes CapMixin\n * @mixes ColorMixin\n * @mixes BaseMixin\n */\nexport class PieChart extends CapMixin(ColorMixin(BaseMixin)) {\n    /**\n     * Create a Pie Chart\n     *\n     * @example\n     * // create a pie chart under #chart-container1 element using the default global chart group\n     * var chart1 = new PieChart('#chart-container1');\n     * // create a pie chart under #chart-container2 element using chart group A\n     * var chart2 = new PieChart('#chart-container2', 'chartGroupA');\n     * @param {String|node|d3.selection} parent - Any valid\n     * {@link https://github.com/d3/d3-selection/blob/master/README.md#select d3 single selector} specifying\n     * a dom block element such as a div; or a dom element or d3 selection.\n     * @param {String} [chartGroup] - The name of the chart group this chart instance should be placed in.\n     * Interaction with a chart will only trigger events and redraws within the chart's group.\n     */\n    constructor (parent, chartGroup) {\n        super();\n\n        this._sliceCssClass = 'pie-slice';\n        this._labelCssClass = 'pie-label';\n        this._sliceGroupCssClass = 'pie-slice-group';\n        this._labelGroupCssClass = 'pie-label-group';\n        this._emptyCssClass = 'empty-chart';\n        this._emptyTitle = 'empty';\n\n        this._radius = undefined;\n        this._givenRadius = undefined; // specified radius, if any\n        this._innerRadius = 0;\n        this._externalRadiusPadding = 0;\n\n\n        this._g = undefined;\n        this._cx = undefined;\n        this._cy = undefined;\n        this._minAngleForLabel = DEFAULT_MIN_ANGLE_FOR_LABEL;\n        this._externalLabelRadius = undefined;\n        this._drawPaths = false;\n\n        this.colorAccessor(d => this.cappedKeyAccessor(d));\n\n        this.title(d => `${this.cappedKeyAccessor(d)}: ${this.cappedValueAccessor(d)}`);\n\n        this.label(d => this.cappedKeyAccessor(d));\n        this.renderLabel(true);\n\n        this.transitionDuration(350);\n        this.transitionDelay(0);\n\n        this.anchor(parent, chartGroup);\n    }\n\n    /**\n     * Get or set the maximum number of slices the pie chart will generate. The top slices are determined by\n     * value from high to low. Other slices exceeding the cap will be rolled up into one single *Others* slice.\n     * @param {Number} [cap]\n     * @returns {Number|PieChart}\n     */\n    slicesCap (cap) {\n        return this.cap(cap)\n    }\n\n    _doRender () {\n        this.resetSvg();\n\n        this._g = this.svg()\n            .append('g')\n            .attr('transform', `translate(${this.cx()},${this.cy()})`);\n\n        this._g.append('g').attr('class', this._sliceGroupCssClass);\n        this._g.append('g').attr('class', this._labelGroupCssClass);\n\n        this._drawChart();\n\n        return this;\n    }\n\n    _drawChart () {\n        // set radius from chart size if none given, or if given radius is too large\n        const maxRadius = min([this.width(), this.height()]) / 2;\n        this._radius = this._givenRadius && this._givenRadius < maxRadius ? this._givenRadius : maxRadius;\n\n        const arcs = this._buildArcs();\n\n        const pieLayout = this._pieLayout();\n        let pieData;\n        // if we have data...\n        if (sum(this.data(), d => this.cappedValueAccessor(d))) {\n            pieData = pieLayout(this.data());\n            this._g.classed(this._emptyCssClass, false);\n        } else {\n            // otherwise we'd be getting NaNs, so override\n            // note: abuse others for its ignoring the value accessor\n            pieData = pieLayout([{key: this._emptyTitle, value: 1, others: [this._emptyTitle]}]);\n            this._g.classed(this._emptyCssClass, true);\n        }\n\n        if (this._g) {\n            const slices = this._g.select(`g.${this._sliceGroupCssClass}`)\n                .selectAll(`g.${this._sliceCssClass}`)\n                .data(pieData);\n\n            const labels = this._g.select(`g.${this._labelGroupCssClass}`)\n                .selectAll(`text.${this._labelCssClass}`)\n                .data(pieData);\n\n            this._removeElements(slices, labels);\n\n            this._createElements(slices, labels, arcs, pieData);\n\n            this._updateElements(pieData, arcs);\n\n            this._highlightFilter();\n\n            transition(this._g, this.transitionDuration(), this.transitionDelay())\n                .attr('transform', `translate(${this.cx()},${this.cy()})`);\n        }\n    }\n\n    _createElements (slices, labels, arcs, pieData) {\n        const slicesEnter = this._createSliceNodes(slices);\n\n        this._createSlicePath(slicesEnter, arcs);\n\n        this._createTitles(slicesEnter);\n\n        this._createLabels(labels, pieData, arcs);\n    }\n\n    _createSliceNodes (slices) {\n        return slices\n            .enter()\n            .append('g')\n            .attr('class', (d, i) => `${this._sliceCssClass} _${i}`)\n            .classed('dc-tabbable', this._keyboardAccessible);\n    }\n\n    _createSlicePath (slicesEnter, arcs) {\n        const slicePath = slicesEnter.append('path')\n            .attr('fill', (d, i) => this._fill(d, i))\n            .on('click', adaptHandler(d => this._onClick(d)))\n            .attr('d', (d, i) => this._safeArc(d, i, arcs));\n\n        if (this._keyboardAccessible) {\n            this._makeKeyboardAccessible(this._onClick);\n        }\n\n        const tranNodes = transition(slicePath, this.transitionDuration(), this.transitionDelay());\n        if (tranNodes.attrTween) {\n            const chart = this;\n            tranNodes.attrTween('d', function (d) {\n                return chart._tweenPie(d, this);\n            });\n        }\n    }\n\n    _createTitles (slicesEnter) {\n        if (this.renderTitle()) {\n            slicesEnter.append('title').text(d => this.title()(d.data));\n        }\n    }\n\n    _applyLabelText (labels) {\n        labels\n            .text(d => {\n                const data = d.data;\n                if ((this._sliceHasNoData(data) || this._sliceTooSmall(d)) && !this._isSelectedSlice(d)) {\n                    return '';\n                }\n                return this.label()(d.data);\n            });\n    }\n\n    _positionLabels (labels, arcs) {\n        this._applyLabelText(labels);\n        transition(labels, this.transitionDuration(), this.transitionDelay())\n            .attr('transform', d => this._labelPosition(d, arcs))\n            .attr('text-anchor', 'middle');\n    }\n\n    _highlightSlice (i, whether) {\n        this.select(`g.pie-slice._${i}`)\n            .classed('highlight', whether);\n    }\n\n    _createLabels (labels, pieData, arcs) {\n        if (this.renderLabel()) {\n            const labelsEnter = labels\n                .enter()\n                .append('text')\n                .attr('class', (d, i) => {\n                    let classes = `${this._sliceCssClass} ${this._labelCssClass} _${i}`;\n                    if (this._externalLabelRadius) {\n                        classes += ' external';\n                    }\n                    return classes;\n                })\n                .on('click', adaptHandler(d => this._onClick(d)))\n                .on('mouseover', adaptHandler(d => {\n                    this._highlightSlice(d.index, true);\n                }))\n                .on('mouseout', adaptHandler(d => {\n                    this._highlightSlice(d.index, false);\n                }));\n            this._positionLabels(labelsEnter, arcs);\n            if (this._externalLabelRadius && this._drawPaths) {\n                this._updateLabelPaths(pieData, arcs);\n            }\n        }\n    }\n\n    _updateLabelPaths (pieData, arcs) {\n        let polyline = this._g.selectAll(`polyline.${this._sliceCssClass}`)\n            .data(pieData);\n\n        polyline.exit().remove();\n\n        polyline = polyline\n            .enter()\n            .append('polyline')\n            .attr('class', (d, i) => `pie-path _${i} ${this._sliceCssClass}`)\n            .on('click', adaptHandler(d => this._onClick(d)))\n            .on('mouseover', adaptHandler(d => {\n                this._highlightSlice(d.index, true);\n            }))\n            .on('mouseout', adaptHandler(d => {\n                this._highlightSlice(d.index, false);\n            }))\n            .merge(polyline);\n\n        const arc2 = arc()\n            .outerRadius(this._radius - this._externalRadiusPadding + this._externalLabelRadius)\n            .innerRadius(this._radius - this._externalRadiusPadding);\n        const tranNodes = transition(polyline, this.transitionDuration(), this.transitionDelay());\n        // this is one rare case where d3.selection differs from d3.transition\n        if (tranNodes.attrTween) {\n            tranNodes\n                .attrTween('points', function (d) {\n                    let current = this._current || d;\n                    current = {startAngle: current.startAngle, endAngle: current.endAngle};\n                    const _interpolate = interpolate(current, d);\n                    this._current = _interpolate(0);\n                    return t => {\n                        const d2 = _interpolate(t);\n                        return [arcs.centroid(d2), arc2.centroid(d2)];\n                    };\n                });\n        } else {\n            tranNodes.attr('points', d => [arcs.centroid(d), arc2.centroid(d)]);\n        }\n        tranNodes.style('visibility', d => d.endAngle - d.startAngle < 0.0001 ? 'hidden' : 'visible');\n\n    }\n\n    _updateElements (pieData, arcs) {\n        this._updateSlicePaths(pieData, arcs);\n        this._updateLabels(pieData, arcs);\n        this._updateTitles(pieData);\n    }\n\n    _updateSlicePaths (pieData, arcs) {\n        const slicePaths = this._g.selectAll(`g.${this._sliceCssClass}`)\n            .data(pieData)\n            .select('path')\n            .attr('d', (d, i) => this._safeArc(d, i, arcs));\n        const tranNodes = transition(slicePaths, this.transitionDuration(), this.transitionDelay());\n        if (tranNodes.attrTween) {\n            const chart = this;\n            tranNodes.attrTween('d', function (d) {\n                return chart._tweenPie(d, this);\n            });\n        }\n        tranNodes.attr('fill', (d, i) => this._fill(d, i));\n    }\n\n    _updateLabels (pieData, arcs) {\n        if (this.renderLabel()) {\n            const labels = this._g.selectAll(`text.${this._labelCssClass}`)\n                .data(pieData);\n            this._positionLabels(labels, arcs);\n            if (this._externalLabelRadius && this._drawPaths) {\n                this._updateLabelPaths(pieData, arcs);\n            }\n        }\n    }\n\n    _updateTitles (pieData) {\n        if (this.renderTitle()) {\n            this._g.selectAll(`g.${this._sliceCssClass}`)\n                .data(pieData)\n                .select('title')\n                .text(d => this.title()(d.data));\n        }\n    }\n\n    _removeElements (slices, labels) {\n        slices.exit().remove();\n        labels.exit().remove();\n    }\n\n    _highlightFilter () {\n        const chart = this;\n        if (this.hasFilter()) {\n            this.selectAll(`g.${this._sliceCssClass}`).each(function (d) {\n                if (chart._isSelectedSlice(d)) {\n                    chart.highlightSelected(this);\n                } else {\n                    chart.fadeDeselected(this);\n                }\n            });\n        } else {\n            this.selectAll(`g.${this._sliceCssClass}`).each(function () {\n                chart.resetHighlight(this);\n            });\n        }\n    }\n\n    /**\n     * Get or set the external radius padding of the pie chart. This will force the radius of the\n     * pie chart to become smaller or larger depending on the value.\n     * @param {Number} [externalRadiusPadding=0]\n     * @returns {Number|PieChart}\n     */\n    externalRadiusPadding (externalRadiusPadding) {\n        if (!arguments.length) {\n            return this._externalRadiusPadding;\n        }\n        this._externalRadiusPadding = externalRadiusPadding;\n        return this;\n    }\n\n    /**\n     * Get or set the inner radius of the pie chart. If the inner radius is greater than 0px then the\n     * pie chart will be rendered as a doughnut chart.\n     * @param {Number} [innerRadius=0]\n     * @returns {Number|PieChart}\n     */\n    innerRadius (innerRadius) {\n        if (!arguments.length) {\n            return this._innerRadius;\n        }\n        this._innerRadius = innerRadius;\n        return this;\n    }\n\n    /**\n     * Get or set the outer radius. If the radius is not set, it will be half of the minimum of the\n     * chart width and height.\n     * @param {Number} [radius]\n     * @returns {Number|PieChart}\n     */\n    radius (radius) {\n        if (!arguments.length) {\n            return this._givenRadius;\n        }\n        this._givenRadius = radius;\n        return this;\n    }\n\n    /**\n     * Get or set center x coordinate position. Default is center of svg.\n     * @param {Number} [cx]\n     * @returns {Number|PieChart}\n     */\n    cx (cx) {\n        if (!arguments.length) {\n            return (this._cx || this.width() / 2);\n        }\n        this._cx = cx;\n        return this;\n    }\n\n    /**\n     * Get or set center y coordinate position. Default is center of svg.\n     * @param {Number} [cy]\n     * @returns {Number|PieChart}\n     */\n    cy (cy) {\n        if (!arguments.length) {\n            return (this._cy || this.height() / 2);\n        }\n        this._cy = cy;\n        return this;\n    }\n\n    _buildArcs () {\n        return arc()\n            .outerRadius(this._radius - this._externalRadiusPadding)\n            .innerRadius(this._innerRadius);\n    }\n\n    _isSelectedSlice (d) {\n        return this.hasFilter(this.cappedKeyAccessor(d.data));\n    }\n\n    _doRedraw () {\n        this._drawChart();\n        return this;\n    }\n\n    /**\n     * Get or set the minimal slice angle for label rendering. Any slice with a smaller angle will not\n     * display a slice label.\n     * @param {Number} [minAngleForLabel=0.5]\n     * @returns {Number|PieChart}\n     */\n    minAngleForLabel (minAngleForLabel) {\n        if (!arguments.length) {\n            return this._minAngleForLabel;\n        }\n        this._minAngleForLabel = minAngleForLabel;\n        return this;\n    }\n\n    _pieLayout () {\n        return pie().sort(null).value(d => this.cappedValueAccessor(d));\n    }\n\n    _sliceTooSmall (d) {\n        const angle = (d.endAngle - d.startAngle);\n        return isNaN(angle) || angle < this._minAngleForLabel;\n    }\n\n    _sliceHasNoData (d) {\n        return this.cappedValueAccessor(d) === 0;\n    }\n\n    _isOffCanvas (current) {\n        return !current || isNaN(current.startAngle) || isNaN(current.endAngle);\n    }\n\n    _fill (d, i) {\n        return this.getColor(d.data, i);\n    }\n\n    _onClick (d) {\n        if (this._g.attr('class') !== this._emptyCssClass) {\n            this.onClick(d.data);\n        }\n    }\n\n    _safeArc (d, i, _arc) {\n        let path = _arc(d, i);\n        if (path.indexOf('NaN') >= 0) {\n            path = 'M0,0';\n        }\n        return path;\n    }\n\n    /**\n     * Title to use for the only slice when there is no data.\n     * @param {String} [title]\n     * @returns {String|PieChart}\n     */\n    emptyTitle (title) {\n        if (arguments.length === 0) {\n            return this._emptyTitle;\n        }\n        this._emptyTitle = title;\n        return this;\n    }\n\n    /**\n     * Position slice labels offset from the outer edge of the chart.\n     *\n     * The argument specifies the extra radius to be added for slice labels.\n     * @param {Number} [externalLabelRadius]\n     * @returns {Number|PieChart}\n     */\n    externalLabels (externalLabelRadius) {\n        if (arguments.length === 0) {\n            return this._externalLabelRadius;\n        } else if (externalLabelRadius) {\n            this._externalLabelRadius = externalLabelRadius;\n        } else {\n            this._externalLabelRadius = undefined;\n        }\n\n        return this;\n    }\n\n    /**\n     * Get or set whether to draw lines from pie slices to their labels.\n     *\n     * @param {Boolean} [drawPaths]\n     * @returns {Boolean|PieChart}\n     */\n    drawPaths (drawPaths) {\n        if (arguments.length === 0) {\n            return this._drawPaths;\n        }\n        this._drawPaths = drawPaths;\n        return this;\n    }\n\n    _labelPosition (d, _arc) {\n        let centroid;\n        if (this._externalLabelRadius) {\n            centroid = arc()\n                .outerRadius(this._radius - this._externalRadiusPadding + this._externalLabelRadius)\n                .innerRadius(this._radius - this._externalRadiusPadding + this._externalLabelRadius)\n                .centroid(d);\n        } else {\n            centroid = _arc.centroid(d);\n        }\n        if (isNaN(centroid[0]) || isNaN(centroid[1])) {\n            return 'translate(0,0)';\n        } else {\n            return `translate(${centroid})`;\n        }\n    }\n\n    legendables () {\n        return this.data().map((d, i) => {\n            const legendable = {name: d.key, data: d.value, others: d.others, chart: this};\n            legendable.color = this.getColor(d, i);\n            return legendable;\n        });\n    }\n\n    legendHighlight (d) {\n        this._highlightSliceFromLegendable(d, true);\n    }\n\n    legendReset (d) {\n        this._highlightSliceFromLegendable(d, false);\n    }\n\n    legendToggle (d) {\n        this.onClick({key: d.name, others: d.others});\n    }\n\n    _highlightSliceFromLegendable (legendable, highlighted) {\n        this.selectAll('g.pie-slice').each(function (d) {\n            if (legendable.name === d.data.key) {\n                select(this).classed('highlight', highlighted);\n            }\n        });\n    }\n\n    _tweenPie (b, element) {\n        b.innerRadius = this._innerRadius;\n        let current = element._current;\n        if (this._isOffCanvas(current)) {\n            current = {startAngle: 0, endAngle: 0};\n        } else {\n            // only interpolate startAngle & endAngle, not the whole data object\n            current = {startAngle: current.startAngle, endAngle: current.endAngle};\n        }\n        const i = interpolate(current, b);\n        element._current = i(0);\n        return t => this._safeArc(i(t), 0, this._buildArcs());\n    }\n\n\n}\n\nexport const pieChart = (parent, chartGroup) => new PieChart(parent, chartGroup);\n","import {extent} from 'd3-array';\nimport {axisBottom} from 'd3-axis';\nimport {scaleLinear} from 'd3-scale';\n\nimport {CapMixin} from '../base/cap-mixin';\nimport {MarginMixin} from '../base/margin-mixin';\nimport {ColorMixin} from '../base/color-mixin';\nimport {transition} from '../core/core';\nimport {adaptHandler} from '../core/d3compat';\n\n/**\n * Concrete row chart implementation.\n *\n * Examples:\n * - {@link http://dc-js.github.com/dc.js/ Nasdaq 100 Index}\n * @mixes CapMixin\n * @mixes MarginMixin\n * @mixes ColorMixin\n * @mixes BaseMixin\n */\nexport class RowChart extends CapMixin(ColorMixin(MarginMixin)) {\n    /**\n     * Create a Row Chart.\n     * @example\n     * // create a row chart under #chart-container1 element using the default global chart group\n     * var chart1 = new RowChart('#chart-container1');\n     * // create a row chart under #chart-container2 element using chart group A\n     * var chart2 = new RowChart('#chart-container2', 'chartGroupA');\n     * @param {String|node|d3.selection} parent - Any valid\n     * {@link https://github.com/d3/d3-selection/blob/master/README.md#select d3 single selector} specifying\n     * a dom block element such as a div; or a dom element or d3 selection.\n     * @param {String} [chartGroup] - The name of the chart group this chart instance should be placed in.\n     * Interaction with a chart will only trigger events and redraws within the chart's group.\n     */\n    constructor (parent, chartGroup) {\n        super();\n\n        this._g = undefined;\n\n        this._labelOffsetX = 10;\n        this._labelOffsetY = 15;\n        this._hasLabelOffsetY = false;\n        this._dyOffset = '0.35em'; // this helps center labels https://github.com/d3/d3-3.x-api-reference/blob/master/SVG-Shapes.md#svg_text\n        this._titleLabelOffsetX = 2;\n\n        this._gap = 5;\n\n        this._fixedBarHeight = false;\n        this._rowCssClass = 'row';\n        this._titleRowCssClass = 'titlerow';\n        this._renderTitleLabel = false;\n\n        this._x = undefined;\n\n        this._elasticX = undefined;\n\n        this._xAxis = axisBottom();\n\n        this._rowData = undefined;\n\n        this.rowsCap = this.cap;\n\n        this.title(d => `${this.cappedKeyAccessor(d)}: ${this.cappedValueAccessor(d)}`);\n\n        this.label(d => this.cappedKeyAccessor(d));\n\n        this.anchor(parent, chartGroup);\n    }\n\n    _calculateAxisScale () {\n        if (!this._x || this._elasticX) {\n            const _extent = extent(this._rowData, d => this.cappedValueAccessor(d));\n            if (_extent[0] > 0) {\n                _extent[0] = 0;\n            }\n            if (_extent[1] < 0) {\n                _extent[1] = 0;\n            }\n            this._x = scaleLinear().domain(_extent)\n                .range([0, this.effectiveWidth()]);\n        }\n        this._xAxis.scale(this._x);\n    }\n\n    _drawAxis () {\n        let axisG = this._g.select('g.axis');\n\n        this._calculateAxisScale();\n\n        if (axisG.empty()) {\n            axisG = this._g.append('g').attr('class', 'axis');\n        }\n        axisG.attr('transform', `translate(0, ${this.effectiveHeight()})`);\n\n        transition(axisG, this.transitionDuration(), this.transitionDelay())\n            .call(this._xAxis);\n    }\n\n    _doRender () {\n        this.resetSvg();\n\n        this._g = this.svg()\n            .append('g')\n            .attr('transform', `translate(${this.margins().left},${this.margins().top})`);\n\n        this._drawChart();\n\n        return this;\n    }\n\n    /**\n     * Gets or sets the x scale. The x scale can be any d3\n     * {@link https://github.com/d3/d3-scale/blob/master/README.md d3.scale}.\n     * @see {@link https://github.com/d3/d3-scale/blob/master/README.md d3.scale}\n     * @param {d3.scale} [scale]\n     * @returns {d3.scale|RowChart}\n     */\n    x (scale) {\n        if (!arguments.length) {\n            return this._x;\n        }\n        this._x = scale;\n        return this;\n    }\n\n    _drawGridLines () {\n        this._g.selectAll('g.tick')\n            .select('line.grid-line')\n            .remove();\n\n        this._g.selectAll('g.tick')\n            .append('line')\n            .attr('class', 'grid-line')\n            .attr('x1', 0)\n            .attr('y1', 0)\n            .attr('x2', 0)\n            .attr('y2', () => -this.effectiveHeight());\n    }\n\n    _drawChart () {\n        this._rowData = this.data();\n\n        this._drawAxis();\n        this._drawGridLines();\n\n        let rows = this._g.selectAll(`g.${this._rowCssClass}`)\n            .data(this._rowData);\n\n        this._removeElements(rows);\n        rows = this._createElements(rows)\n            .merge(rows);\n        this._updateElements(rows);\n    }\n\n    _createElements (rows) {\n        const rowEnter = rows.enter()\n            .append('g')\n            .attr('class', (d, i) => `${this._rowCssClass} _${i}`);\n\n        rowEnter.append('rect').attr('width', 0);\n\n        this._createLabels(rowEnter);\n\n        return rowEnter;\n    }\n\n    _removeElements (rows) {\n        rows.exit().remove();\n    }\n\n    _rootValue () {\n        const root = this._x(0);\n        return (root === -Infinity || root !== root) ? this._x(1) : root;\n    }\n\n    _updateElements (rows) {\n        const n = this._rowData.length;\n\n        let height;\n        if (!this._fixedBarHeight) {\n            height = (this.effectiveHeight() - (n + 1) * this._gap) / n;\n        } else {\n            height = this._fixedBarHeight;\n        }\n\n        // vertically align label in center unless they override the value via property setter\n        if (!this._hasLabelOffsetY) {\n            this._labelOffsetY = height / 2;\n        }\n\n        const rect = rows.attr('transform', (d, i) => `translate(0,${(i + 1) * this._gap + i * height})`).select('rect')\n            .attr('height', height)\n            .attr('fill', this.getColor)\n            .on('click', adaptHandler(d => this._onClick(d)))\n            .classed('dc-tabbable', this._keyboardAccessible)\n            .classed('deselected', d => (this.hasFilter()) ? !this._isSelectedRow(d) : false)\n            .classed('selected', d => (this.hasFilter()) ? this._isSelectedRow(d) : false);\n\n        if (this._keyboardAccessible) {\n            this._makeKeyboardAccessible(adaptHandler(d => this._onClick(d)));\n        }\n\n        transition(rect, this.transitionDuration(), this.transitionDelay())\n            .attr('width', d => Math.abs(this._rootValue() - this._x(this.cappedValueAccessor(d))))\n            .attr('transform', d => this._translateX(d));\n\n        this._createTitles(rows);\n        this._updateLabels(rows);\n    }\n\n    _createTitles (rows) {\n        if (this.renderTitle()) {\n            rows.select('title').remove();\n            rows.append('title').text(this.title());\n        }\n    }\n\n    _createLabels (rowEnter) {\n        if (this.renderLabel()) {\n            rowEnter.append('text')\n                .on('click', adaptHandler(d => this._onClick(d)));\n        }\n        if (this.renderTitleLabel()) {\n            rowEnter.append('text')\n                .attr('class', this._titleRowCssClass)\n                .on('click', adaptHandler(d => this._onClick(d)));\n        }\n    }\n\n    _updateLabels (rows) {\n        if (this.renderLabel()) {\n            const lab = rows.select('text')\n                .attr('x', this._labelOffsetX)\n                .attr('y', this._labelOffsetY)\n                .attr('dy', this._dyOffset)\n                .on('click', adaptHandler(d => this._onClick(d)))\n                .attr('class', (d, i) => `${this._rowCssClass} _${i}`)\n                .text(d => this.label()(d));\n            transition(lab, this.transitionDuration(), this.transitionDelay())\n                .attr('transform', d => this._translateX(d));\n        }\n        if (this.renderTitleLabel()) {\n            const titlelab = rows.select(`.${this._titleRowCssClass}`)\n                .attr('x', this.effectiveWidth() - this._titleLabelOffsetX)\n                .attr('y', this._labelOffsetY)\n                .attr('dy', this._dyOffset)\n                .attr('text-anchor', 'end')\n                .on('click', adaptHandler(d => this._onClick(d)))\n                .attr('class', (d, i) => `${this._titleRowCssClass} _${i}`)\n                .text(d => this.title()(d));\n            transition(titlelab, this.transitionDuration(), this.transitionDelay())\n                .attr('transform', d => this._translateX(d));\n        }\n    }\n\n    /**\n     * Turn on/off Title label rendering (values) using SVG style of text-anchor 'end'.\n     * @param {Boolean} [renderTitleLabel=false]\n     * @returns {Boolean|RowChart}\n     */\n    renderTitleLabel (renderTitleLabel) {\n        if (!arguments.length) {\n            return this._renderTitleLabel;\n        }\n        this._renderTitleLabel = renderTitleLabel;\n        return this;\n    }\n\n    _onClick (d) {\n        this.onClick(d);\n    }\n\n    _translateX (d) {\n        const x = this._x(this.cappedValueAccessor(d)),\n            x0 = this._rootValue(),\n            s = x > x0 ? x0 : x;\n        return `translate(${s},0)`;\n    }\n\n    _doRedraw () {\n        this._drawChart();\n        return this;\n    }\n\n    /**\n     * Get or sets the x axis for the row chart instance.\n     * See the {@link https://github.com/d3/d3-axis/blob/master/README.md d3.axis}\n     * documention for more information.\n     * @param {d3.axis} [xAxis]\n     * @example\n     * // customize x axis tick format\n     * chart.xAxis().tickFormat(function (v) {return v + '%';});\n     * // customize x axis tick values\n     * chart.xAxis().tickValues([0, 100, 200, 300]);\n     * // use a top-oriented axis. Note: position of the axis and grid lines will need to\n     * // be set manually, see https://dc-js.github.io/dc.js/examples/row-top-axis.html\n     * chart.xAxis(d3.axisTop())\n     * @returns {d3.axis|RowChart}\n     */\n    xAxis (xAxis) {\n        if (!arguments.length) {\n            return this._xAxis;\n        }\n        this._xAxis = xAxis;\n        return this;\n    }\n\n    /**\n     * Get or set the fixed bar height. Default is [false] which will auto-scale bars.\n     * For example, if you want to fix the height for a specific number of bars (useful in TopN charts)\n     * you could fix height as follows (where count = total number of bars in your TopN and gap is\n     * your vertical gap space).\n     * @example\n     * chart.fixedBarHeight( chartheight - (count + 1) * gap / count);\n     * @param {Boolean|Number} [fixedBarHeight=false]\n     * @returns {Boolean|Number|RowChart}\n     */\n    fixedBarHeight (fixedBarHeight) {\n        if (!arguments.length) {\n            return this._fixedBarHeight;\n        }\n        this._fixedBarHeight = fixedBarHeight;\n        return this;\n    }\n\n    /**\n     * Get or set the vertical gap space between rows on a particular row chart instance.\n     * @param {Number} [gap=5]\n     * @returns {Number|RowChart}\n     */\n    gap (gap) {\n        if (!arguments.length) {\n            return this._gap;\n        }\n        this._gap = gap;\n        return this;\n    }\n\n    /**\n     * Get or set the elasticity on x axis. If this attribute is set to true, then the x axis will rescale to auto-fit the\n     * data range when filtered.\n     * @param {Boolean} [elasticX]\n     * @returns {Boolean|RowChart}\n     */\n    elasticX (elasticX) {\n        if (!arguments.length) {\n            return this._elasticX;\n        }\n        this._elasticX = elasticX;\n        return this;\n    }\n\n    /**\n     * Get or set the x offset (horizontal space to the top left corner of a row) for labels on a particular row chart.\n     * @param {Number} [labelOffsetX=10]\n     * @returns {Number|RowChart}\n     */\n    labelOffsetX (labelOffsetX) {\n        if (!arguments.length) {\n            return this._labelOffsetX;\n        }\n        this._labelOffsetX = labelOffsetX;\n        return this;\n    }\n\n    /**\n     * Get or set the y offset (vertical space to the top left corner of a row) for labels on a particular row chart.\n     * @param {Number} [labelOffsety=15]\n     * @returns {Number|RowChart}\n     */\n    labelOffsetY (labelOffsety) {\n        if (!arguments.length) {\n            return this._labelOffsetY;\n        }\n        this._labelOffsetY = labelOffsety;\n        this._hasLabelOffsetY = true;\n        return this;\n    }\n\n    /**\n     * Get of set the x offset (horizontal space between right edge of row and right edge or text.\n     * @param {Number} [titleLabelOffsetX=2]\n     * @returns {Number|RowChart}\n     */\n    titleLabelOffsetX (titleLabelOffsetX) {\n        if (!arguments.length) {\n            return this._titleLabelOffsetX;\n        }\n        this._titleLabelOffsetX = titleLabelOffsetX;\n        return this;\n    }\n\n    _isSelectedRow (d) {\n        return this.hasFilter(this.cappedKeyAccessor(d));\n    }\n}\n\nexport const rowChart = (parent, chartGroup) => new RowChart(parent, chartGroup);\n","import {symbol} from 'd3-shape';\nimport {select} from 'd3-selection';\nimport {brush} from 'd3-brush';\nimport {ascending} from 'd3-array'\n\nimport {CoordinateGridMixin} from '../base/coordinate-grid-mixin';\nimport {optionalTransition, transition} from '../core/core';\nimport {filters} from '../core/filters';\nimport {constants} from '../core/constants';\nimport {events} from '../core/events';\n\n/**\n * A scatter plot chart\n *\n * Examples:\n * - {@link http://dc-js.github.io/dc.js/examples/scatter.html Scatter Chart}\n * - {@link http://dc-js.github.io/dc.js/examples/multi-scatter.html Multi-Scatter Chart}\n * @mixes CoordinateGridMixin\n */\nexport class ScatterPlot extends CoordinateGridMixin {\n    /**\n     * Create a Scatter Plot.\n     * @example\n     * // create a scatter plot under #chart-container1 element using the default global chart group\n     * var chart1 = new ScatterPlot('#chart-container1');\n     * // create a scatter plot under #chart-container2 element using chart group A\n     * var chart2 = new ScatterPlot('#chart-container2', 'chartGroupA');\n     * // create a sub-chart under a composite parent chart\n     * var chart3 = new ScatterPlot(compositeChart);\n     * @param {String|node|d3.selection} parent - Any valid\n     * {@link https://github.com/d3/d3-selection/blob/master/README.md#select d3 single selector} specifying\n     * a dom block element such as a div; or a dom element or d3 selection.\n     * @param {String} [chartGroup] - The name of the chart group this chart instance should be placed in.\n     * Interaction with a chart will only trigger events and redraws within the chart's group.\n     */\n    constructor (parent, chartGroup) {\n        super();\n\n        this._symbol = symbol();\n\n        this._existenceAccessor = d => d.value;\n\n        const originalKeyAccessor = this.keyAccessor();\n        this.keyAccessor(d => originalKeyAccessor(d)[0]);\n        this.valueAccessor(d => originalKeyAccessor(d)[1]);\n        this.colorAccessor(() => this._groupName);\n\n        // OPACITY TEST\n        this._opacityAccessor = () => this._groupName;\n        this._opacity = () => 0.5;\n\n\n        // this basically just counteracts the setting of its own key/value accessors\n        // see https://github.com/dc-js/dc.js/issues/702\n        this.title(d => `${this.keyAccessor()(d)},${this.valueAccessor()(d)}: ${this.existenceAccessor()(d)}`);\n\n        this._highlightedSize = 7;\n        this._symbolSize = 5;\n        this._excludedSize = 3;\n        this._excludedColor = null;\n        this._excludedOpacity = () => 1.0;\n        this._emptySize = 0;\n        this._emptyOpacity = 0;\n        this._nonemptyOpacity = 1;\n        this._emptyColor = null;\n        this._filtered = [];\n        this._canvas = null;\n        this._context = null;\n        this._useCanvas = false;\n\n\n        // Use a 2 dimensional brush\n        this.brush(brush());\n\n        this._symbol.size((d, i) => this._elementSize(d, i));\n\n        this.anchor(parent, chartGroup);\n    }\n\n    // Calculates element radius for canvas plot to be comparable to D3 area based symbol sizes\n    _canvasElementSize (d, isFiltered) {\n        if (!this._existenceAccessor(d)) {\n            return this._emptySize / Math.sqrt(Math.PI);\n        } else if (isFiltered) {\n            return this._symbolSize / Math.sqrt(Math.PI);\n        } else {\n            return this._excludedSize / Math.sqrt(Math.PI);\n        }\n    }\n\n    _elementSize (d, i) {\n        if (!this._existenceAccessor(d)) {\n            return Math.pow(this._emptySize, 2);\n        } else if (this._filtered[i]) {\n            return Math.pow(this._symbolSize, 2);\n        } else {\n            return Math.pow(this._excludedSize, 2);\n        }\n    }\n\n    _locator (d) {\n        return `translate(${this.x()(this.keyAccessor()(d))},${ \n            this.y()(this.valueAccessor()(d))})`;\n    }\n\n    filter (filter) {\n        if (!arguments.length) {\n            return super.filter();\n        }\n\n        return super.filter(filters.RangedTwoDimensionalFilter(filter));\n    }\n\n    /**\n     * Method that replaces original resetSvg and appropriately inserts canvas\n     * element along with svg element and sets their CSS properties appropriately\n     * so they are overlapped on top of each other.\n     * Remove the chart's SVGElements from the dom and recreate the container SVGElement.\n     * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/SVGElement SVGElement}\n     * @returns {SVGElement}\n     */\n    resetSvg () {\n        if (!this._useCanvas) {\n            return super.resetSvg();\n        } else {\n            super.resetSvg(); // Perform original svgReset inherited from baseMixin\n            this.select('canvas').remove(); // remove old canvas\n\n            const svgSel = this.svg();\n            const rootSel = this.root();\n\n            // Set root node to relative positioning and svg to absolute\n            rootSel.style('position', 'relative');\n            svgSel.style('position', 'relative');\n\n            // Check if SVG element already has any extra top/left CSS offsets\n            const svgLeft = isNaN(parseInt(svgSel.style('left'), 10)) ? 0 : parseInt(svgSel.style('left'), 10);\n            const svgTop = isNaN(parseInt(svgSel.style('top'), 10)) ? 0 : parseInt(svgSel.style('top'), 10);\n            const width = this.effectiveWidth();\n            const height = this.effectiveHeight();\n            const margins = this.margins(); // {top: 10, right: 130, bottom: 42, left: 42}\n\n            // Add the canvas element such that it perfectly overlaps the plot area of the scatter plot SVG\n            const devicePixelRatio = window.devicePixelRatio || 1;\n            this._canvas = this.root().append('canvas')\n                .attr('x', 0)\n                .attr('y', 0)\n                .attr('width', (width) * devicePixelRatio)\n                .attr('height', (height) * devicePixelRatio)\n                .style('width', `${width}px`)\n                .style('height', `${height}px`)\n                .style('position', 'absolute')\n                .style('top', `${margins.top + svgTop}px`)\n                .style('left', `${margins.left + svgLeft}px`)\n                .style('z-index', -1) // Place behind SVG\n                .style('pointer-events', 'none'); // Disable pointer events on canvas so SVG can capture brushing\n\n            // Define canvas context and set clipping path\n            this._context = this._canvas.node().getContext('2d');\n            this._context.scale(devicePixelRatio, devicePixelRatio);\n            this._context.rect(0, 0, width, height);\n            this._context.clip(); // Setup clipping path\n            this._context.imageSmoothingQuality = 'high';\n\n            return this.svg(); // Respect original return param for this.resetSvg;\n        }\n    }\n\n    _resizeCanvas () {\n        const width = this.effectiveWidth();\n        const height = this.effectiveHeight();\n\n        const devicePixelRatio = window.devicePixelRatio || 1;\n        this._canvas\n            .attr('width', (width) * devicePixelRatio)\n            .attr('height', (height) * devicePixelRatio)\n            .style('width', `${width}px`)\n            .style('height', `${height}px`);\n        this._context.scale(devicePixelRatio, devicePixelRatio);\n    }\n\n\n    /**\n     * Set or get whether to use canvas backend for plotting scatterPlot. Note that the\n     * canvas backend does not currently support\n     * {@link ScatterPlot#customSymbol customSymbol} or\n     * {@link ScatterPlot#symbol symbol} methods and is limited to always plotting\n     * with filled circles. Symbols are drawn with\n     * {@link ScatterPlot#symbolSize symbolSize} radius. By default, the SVG backend\n     * is used when `useCanvas` is set to `false`.\n     * @param {Boolean} [useCanvas=false]\n     * @return {Boolean|d3.selection}\n     */\n    useCanvas (useCanvas) {\n        if (!arguments.length) {\n            return this._useCanvas;\n        }\n        this._useCanvas = useCanvas;\n        return this;\n    }\n\n    /**\n     * Set or get canvas element. You should usually only ever use the get method as\n     * dc.js will handle canvas element generation.  Provides valid canvas only when\n     * {@link ScatterPlot#useCanvas useCanvas} is set to `true`\n     * @param {CanvasElement|d3.selection} [canvasElement]\n     * @return {CanvasElement|d3.selection}\n     */\n    canvas (canvasElement) {\n        if (!arguments.length) {\n            return this._canvas;\n        }\n        this._canvas = canvasElement;\n        return this;\n    }\n\n    /**\n     * Get canvas 2D context. Provides valid context only when\n     * {@link ScatterPlot#useCanvas useCanvas} is set to `true`\n     * @return {CanvasContext}\n     */\n    context () {\n        return this._context;\n    }\n\n    /*eslint complexity: [2,11] */\n    // Plots data on canvas element. If argument provided, assumes legend is\n    // currently being highlighted and modifies opacity/size of symbols accordingly\n    // @param {Object} [legendHighlightDatum] - Datum provided to legendHighlight method\n    _plotOnCanvas (legendHighlightDatum) {\n        this._resizeCanvas();\n        const context = this.context();\n        context.clearRect(0, 0, (context.canvas.width + 2) * 1, (context.canvas.height + 2) * 1);\n        const data = this.data();\n\n        // Draw the data on canvas\n        data.forEach((d, i) => {\n            const isFiltered = !this.filter() || this.filter().isFiltered([d.key[0], d.key[1]]);\n            // Calculate opacity for current data point\n            let cOpacity = 1;\n            if (!this._existenceAccessor(d)) {\n                cOpacity = this._emptyOpacity;\n            } else if (isFiltered) {\n                cOpacity = this.getOpacity(d);\n            } else {\n                cOpacity = this.getExcludedOpacity(d);\n            }\n            // Calculate color for current data point\n            let cColor = null;\n            if (this._emptyColor && !this._existenceAccessor(d)) {\n                cColor = this._emptyColor;\n            } else if (this.excludedColor() && !isFiltered) {\n                cColor = this.excludedColor();\n            } else {\n                cColor = this.getColor(d);\n            }\n            let cSize = this._canvasElementSize(d, isFiltered);\n\n            // Adjust params for data points if legend is highlighted\n            if (legendHighlightDatum) {\n                const isHighlighted = (cColor === legendHighlightDatum.color);\n                // Calculate opacity for current data point\n                const fadeOutOpacity = 0.1; // TODO: Make this programmatically setable\n                if (!isHighlighted) { // Fade out non-highlighted colors + highlighted colors outside filter\n                    cOpacity = fadeOutOpacity;\n                }\n                if (isHighlighted) { // Set size for highlighted color data points\n                    cSize = this._highlightedSize / Math.sqrt(Math.PI);\n                }\n            }\n\n            // Draw point on canvas\n            context.save();\n            context.globalAlpha = cOpacity;\n            context.beginPath();\n            context.arc(this.x()(this.keyAccessor()(d)), this.y()(this.valueAccessor()(d)), cSize, 0, 2 * Math.PI, true);\n            context.fillStyle = cColor;\n            context.fill();\n            // context.lineWidth = 0.5; // Commented out code to add stroke around scatter points if desired\n            // context.strokeStyle = '#333';\n            // context.stroke();\n            context.restore();\n        });\n    }\n\n    _plotOnSVG () {\n\n        const data = this.data();\n\n        if (this._keyboardAccessible) {\n            // sort based on the x value (key)\n            data.sort((a, b) => ascending(this.keyAccessor()(a), this.keyAccessor()(b)));\n        }\n\n        let symbols = this.chartBodyG().selectAll('path.symbol')\n            .data(data);\n\n        transition(symbols.exit(), this.transitionDuration(), this.transitionDelay())\n            .attr('opacity', 0).remove();\n\n        symbols = symbols\n            .enter()\n            .append('path')\n            .attr('class', 'symbol')\n            .classed('dc-tabbable', this._keyboardAccessible)\n            .attr('opacity', 0)\n            .attr('fill', this.getColor)\n            .attr('transform', d => this._locator(d))\n            .merge(symbols);\n\n        // no click handler - just tabindex for reading out of tooltips\n        if (this._keyboardAccessible) {\n            this._makeKeyboardAccessible();\n            symbols.order();\n        }\n\n        symbols.call(s => this._renderTitles(s, data));\n\n        symbols.each((d, i) => {\n            this._filtered[i] = !this.filter() || this.filter().isFiltered([this.keyAccessor()(d), this.valueAccessor()(d)]);\n        });\n\n        transition(symbols, this.transitionDuration(), this.transitionDelay())\n            .attr('opacity', (d, i) => {\n                if (!this._existenceAccessor(d)) {\n                    return this._emptyOpacity;\n                } else if (this._filtered[i]) {\n                    return this.getOpacity(d);\n                } else {\n                    return this.excludedOpacity();\n                }\n            })\n            .attr('fill', (d, i) => {\n                if (this._emptyColor && !this._existenceAccessor(d)) {\n                    return this._emptyColor;\n                } else if (this.excludedColor() && !this._filtered[i]) {\n                    return this.excludedColor();\n                } else {\n                    return this.getColor(d);\n                }\n            })\n            .attr('transform', d => this._locator(d))\n            .attr('d', this._symbol);\n    }\n\n    plotData () {\n        if (this._useCanvas) {\n            this._plotOnCanvas();\n        } else {\n            this._plotOnSVG();\n        }\n    }\n\n    _renderTitles (_symbol, _d) {\n        if (this.renderTitle()) {\n            _symbol.selectAll('title').remove();\n            _symbol.append('title').text(d => this.title()(d));\n        }\n    }\n\n    /**\n     * Get or set the existence accessor.  If a point exists, it is drawn with\n     * {@link ScatterPlot#symbolSize symbolSize} radius and\n     * opacity 1; if it does not exist, it is drawn with\n     * {@link ScatterPlot#emptySize emptySize} radius and opacity 0. By default,\n     * the existence accessor checks if the reduced value is truthy.\n     * @see {@link ScatterPlot#symbolSize symbolSize}\n     * @see {@link ScatterPlot#emptySize emptySize}\n     * @example\n     * // default accessor\n     * chart.existenceAccessor(function (d) { return d.value; });\n     * @param {Function} [accessor]\n     * @returns {Function|ScatterPlot}\n     */\n    existenceAccessor (accessor) {\n        if (!arguments.length) {\n            return this._existenceAccessor;\n        }\n        this._existenceAccessor = accessor;\n        return this;\n    }\n\n    /**\n     * Get or set the symbol type used for each point. By default the symbol is a circle (d3.symbolCircle).\n     * Type can be a constant or an accessor.\n     * @see {@link https://github.com/d3/d3-shape/blob/master/README.md#symbol_type symbol.type}\n     * @example\n     * // Circle type\n     * chart.symbol(d3.symbolCircle);\n     * // Square type\n     * chart.symbol(d3.symbolSquare);\n     * @param {Function} [type=d3.symbolCircle]\n     * @returns {Function|ScatterPlot}\n     */\n    symbol (type) {\n        if (!arguments.length) {\n            return this._symbol.type();\n        }\n        this._symbol.type(type);\n        return this;\n    }\n\n    /**\n     * Get or set the symbol generator. By default `ScatterPlot` will use\n     * {@link https://github.com/d3/d3-shape/blob/master/README.md#symbol d3.symbol()}\n     * to generate symbols. `ScatterPlot` will set the\n     * {@link https://github.com/d3/d3-shape/blob/master/README.md#symbol_size symbol size accessor}\n     * on the symbol generator.\n     * @see {@link https://github.com/d3/d3-shape/blob/master/README.md#symbol d3.symbol}\n     * @see {@link https://stackoverflow.com/questions/25332120/create-additional-d3-js-symbols Create additional D3.js symbols}\n     * @param {String|Function} [customSymbol=d3.symbol()]\n     * @returns {String|Function|ScatterPlot}\n     */\n    customSymbol (customSymbol) {\n        if (!arguments.length) {\n            return this._symbol;\n        }\n        this._symbol = customSymbol;\n        this._symbol.size((d, i) => this._elementSize(d, i));\n        return this;\n    }\n\n    /**\n     * Set or get radius for symbols.\n     * @see {@link https://github.com/d3/d3-shape/blob/master/README.md#symbol_size d3.symbol.size}\n     * @param {Number} [symbolSize=3]\n     * @returns {Number|ScatterPlot}\n     */\n    symbolSize (symbolSize) {\n        if (!arguments.length) {\n            return this._symbolSize;\n        }\n        this._symbolSize = symbolSize;\n        return this;\n    }\n\n    /**\n     * Set an accessor for the opacity\n     * @param {Function} [opacityAccessor]\n     * @returns {Function|ScatterPlot}\n     */\n    opacityAccessor (opacityAccessor) {\n        if (!arguments.length) {\n            return this._opacityAccessor;\n        }\n        this._opacityAccessor = opacityAccessor;\n        return this;\n    }\n\n    /**\n     * Set or get radius for symbols.\n     * @param {Function} [opacity]\n     * @returns {Function|ScatterPlot}\n     */\n    opacity (opacity) {\n        if (!arguments.length) {\n            return this._opacity;\n        }\n        this._opacity = opacity;\n        return this;\n    }\n\n    getOpacity (key) {\n        return this.opacity()(this.opacityAccessor()(key))\n    }\n\n    getExcludedOpacity (key) {\n        if (!isNaN(this.excludedOpacity())){\n            return this._excludedOpacity\n        } else { \n            return this.excludedOpacity() (this.opacityAccessor()(key))\n        }\n    }\n\n    /**\n     * Set or get radius for highlighted symbols.\n     * @see {@link https://github.com/d3/d3-shape/blob/master/README.md#symbol_size d3.symbol.size}\n     * @param {Number} [highlightedSize=5]\n     * @returns {Number|ScatterPlot}\n     */\n    highlightedSize (highlightedSize) {\n        if (!arguments.length) {\n            return this._highlightedSize;\n        }\n        this._highlightedSize = highlightedSize;\n        return this;\n    }\n\n    /**\n     * Set or get size for symbols excluded from this chart's filter. If null, no\n     * special size is applied for symbols based on their filter status.\n     * @see {@link https://github.com/d3/d3-shape/blob/master/README.md#symbol_size d3.symbol.size}\n     * @param {Number} [excludedSize=null]\n     * @returns {Number|ScatterPlot}\n     */\n    excludedSize (excludedSize) {\n        if (!arguments.length) {\n            return this._excludedSize;\n        }\n        this._excludedSize = excludedSize;\n        return this;\n    }\n\n    /**\n     * Set or get color for symbols excluded from this chart's filter. If null, no\n     * special color is applied for symbols based on their filter status.\n     * @param {Number} [excludedColor=null]\n     * @returns {Number|ScatterPlot}\n     */\n    excludedColor (excludedColor) {\n        if (!arguments.length) {\n            return this._excludedColor;\n        }\n        this._excludedColor = excludedColor;\n        return this;\n    }\n\n    /**\n     * Set or get opacity for symbols excluded from this chart's filter.\n     * @param {Number} [excludedOpacity=1.0]\n     * @returns {Number|ScatterPlot}\n     */\n    excludedOpacity (excludedOpacity) {\n        if (!arguments.length) {\n            return this._excludedOpacity;\n        }\n        this._excludedOpacity = excludedOpacity;\n        return this;\n    }\n\n    /**\n     * Set or get radius for symbols when the group is empty.\n     * @see {@link https://github.com/d3/d3-shape/blob/master/README.md#symbol_size d3.symbol.size}\n     * @param {Number} [emptySize=0]\n     * @returns {Number|ScatterPlot}\n     */\n    emptySize (emptySize) {\n        if (!arguments.length) {\n            return this._emptySize;\n        }\n        this._emptySize = emptySize;\n        return this;\n    }\n\n    hiddenSize (emptySize) {\n        if (!arguments.length) {\n            return this.emptySize();\n        }\n        return this.emptySize(emptySize);\n    }\n\n    /**\n     * Set or get color for symbols when the group is empty. If null, just use the\n     * {@link ColorMixin#colors colorMixin.colors} color scale zero value.\n     * @param {String} [emptyColor=null]\n     * @return {String}\n     * @return {ScatterPlot}/\n     */\n    emptyColor (emptyColor) {\n        if (!arguments.length) {\n            return this._emptyColor;\n        }\n        this._emptyColor = emptyColor;\n        return this;\n    }\n\n    /**\n     * Set or get opacity for symbols when the group is empty.\n     * @param {Number} [emptyOpacity=0]\n     * @return {Number}\n     * @return {ScatterPlot}\n     */\n    emptyOpacity (emptyOpacity) {\n        if (!arguments.length) {\n            return this._emptyOpacity;\n        }\n        this._emptyOpacity = emptyOpacity;\n        return this;\n    }\n\n    /**\n     * Set or get opacity for symbols when the group is not empty.\n     * @param {Number} [nonemptyOpacity=1]\n     * @return {Number}\n     * @return {ScatterPlot}\n     */\n    nonemptyOpacity (nonemptyOpacity) {\n        if (!arguments.length) {\n            return this._emptyOpacity;\n        }\n        this._nonemptyOpacity = nonemptyOpacity;\n        return this;\n    }\n\n    legendables () {\n        return [{chart: this, name: this._groupName, color: this.getColor()}];\n    }\n\n    legendHighlight (d) {\n        if (this._useCanvas) {\n            this._plotOnCanvas(d); // Supply legend datum to plotOnCanvas\n        } else {\n            this._resizeSymbolsWhere(s => s.attr('fill') === d.color, this._highlightedSize);\n            this.chartBodyG().selectAll('.chart-body path.symbol').filter(function () {\n                return select(this).attr('fill') !== d.color;\n            }).classed('fadeout', true);\n        }\n    }\n\n    legendReset (d) {\n        if (this._useCanvas) {\n            this._plotOnCanvas(d); // Supply legend datum to plotOnCanvas\n        } else {\n            this._resizeSymbolsWhere(s => s.attr('fill') === d.color, this._symbolSize);\n            this.chartBodyG().selectAll('.chart-body path.symbol').filter(function () {\n                return select(this).attr('fill') !== d.color;\n            }).classed('fadeout', false);\n        }\n    }\n\n    _resizeSymbolsWhere (condition, size) {\n        const symbols = this.chartBodyG().selectAll('.chart-body path.symbol').filter(function () {\n            return condition(select(this));\n        });\n        const oldSize = this._symbol.size();\n        this._symbol.size(Math.pow(size, 2));\n        transition(symbols, this.transitionDuration(), this.transitionDelay()).attr('d', this._symbol);\n        this._symbol.size(oldSize);\n    }\n    createBrushHandlePaths () {\n        // no handle paths for poly-brushes\n    }\n\n    extendBrush (brushSelection) {\n        if (this.round()) {\n            brushSelection[0] = brushSelection[0].map(this.round());\n            brushSelection[1] = brushSelection[1].map(this.round());\n        }\n        return brushSelection;\n    }\n\n    brushIsEmpty (brushSelection) {\n        return !brushSelection || brushSelection[0][0] >= brushSelection[1][0] || brushSelection[0][1] >= brushSelection[1][1];\n    }\n\n    _brushing (evt) {\n        if (this._ignoreBrushEvents) {\n            return;\n        }\n\n        let brushSelection = evt.selection;\n\n        // Testing with pixels is more reliable\n        let brushIsEmpty = this.brushIsEmpty(brushSelection);\n\n        if (brushSelection) {\n            brushSelection = brushSelection.map(point => point.map((coord, i) => {\n                const scale = i === 0 ? this.x() : this.y();\n                return scale.invert(coord);\n            }));\n\n            brushSelection = this.extendBrush(brushSelection);\n\n            // The rounding process might have made brushSelection empty, so we need to recheck\n            brushIsEmpty = brushIsEmpty && this.brushIsEmpty(brushSelection);\n        }\n\n        this.redrawBrush(brushSelection, false);\n\n        const ranged2DFilter = brushIsEmpty ? null : filters.RangedTwoDimensionalFilter(brushSelection);\n\n        events.trigger(() => {\n            this.replaceFilter(ranged2DFilter);\n            this.redrawGroup();\n        }, constants.EVENT_DELAY);\n    }\n\n    redrawBrush (brushSelection, doTransition) {\n        // override default x axis brush from parent chart\n        this._gBrush = this.gBrush();\n\n        if (this.brushOn() && this._gBrush) {\n            if (this.resizing()) {\n                this.setBrushExtents(doTransition);\n            }\n\n            if (!brushSelection) {\n                this._withoutBrushEvents(() => {\n                    this._gBrush\n                        .call(this.brush().move, brushSelection);\n                });\n            } else {\n                brushSelection = brushSelection.map(point => point.map((coord, i) => {\n                    const scale = i === 0 ? this.x() : this.y();\n                    return scale(coord);\n                }));\n\n                const gBrush =\n                    optionalTransition(doTransition, this.transitionDuration(), this.transitionDelay())(this._gBrush);\n\n                this._withoutBrushEvents(() => {\n                    gBrush\n                        .call(this.brush().move, brushSelection);\n                });\n            }\n        }\n\n        this.fadeDeselectedArea(brushSelection);\n    }\n}\n\nexport const scatterPlot = (parent, chartGroup) => new ScatterPlot(parent, chartGroup);\n","import {events} from '../core/events';\nimport {BaseMixin} from '../base/base-mixin';\nimport {logger} from '../core/logger';\nimport {adaptHandler} from '../core/d3compat';\n\nconst SELECT_CSS_CLASS = 'dc-select-menu';\nconst OPTION_CSS_CLASS = 'dc-select-option';\n\n/**\n * The select menu is a simple widget designed to filter a dimension by selecting an option from\n * an HTML `<select/>` menu. The menu can be optionally turned into a multiselect.\n * @mixes BaseMixin\n */\nexport class SelectMenu extends BaseMixin {\n    /**\n     * Create a Select Menu.\n     * @example\n     * // create a select menu under #select-container using the default global chart group\n     * var select = new SelectMenu('#select-container')\n     *                .dimension(states)\n     *                .group(stateGroup);\n     * // the option text can be set via the title() function\n     * // by default the option text is '`key`: `value`'\n     * select.title(function (d){\n     *     return 'STATE: ' + d.key;\n     * })\n     * @param {String|node|d3.selection|CompositeChart} parent - Any valid\n     * [d3 single selector](https://github.com/mbostock/d3/wiki/Selections#selecting-elements) specifying\n     * a dom block element such as a div; or a dom element or d3 selection.\n     * @param {String} [chartGroup] - The name of the chart group this widget should be placed in.\n     * Interaction with the widget will only trigger events and redraws within its group.\n     */\n    constructor (parent, chartGroup) {\n        super();\n\n        this._select = undefined;\n        this._promptText = 'Select all';\n        this._multiple = false;\n        this._promptValue = null;\n        this._numberVisible = null;\n\n        this.data(group => group.all().filter(this._filterDisplayed));\n\n        this._filterDisplayed = d => this.valueAccessor()(d) > 0;\n\n        this._order = (a, b) => {\n            if (this.keyAccessor()(a) > this.keyAccessor()(b)) {\n                return 1;\n            }\n            if (this.keyAccessor()(a) < this.keyAccessor()(b)) {\n                return -1;\n            }\n            return 0;\n        };\n\n        this.anchor(parent, chartGroup);\n    }\n\n    _doRender () {\n        this.select('select').remove();\n        this._select = this.root().append('select')\n            .classed(SELECT_CSS_CLASS, true);\n        this._select.append('option').text(this._promptText).attr('value', '');\n\n        this._doRedraw();\n        return this;\n    }\n\n    _doRedraw () {\n        this._setAttributes();\n        this._renderOptions();\n        // select the option(s) corresponding to current filter(s)\n        if (this.hasFilter() && this._multiple) {\n            this._select.selectAll('option')\n                .property('selected', d => typeof d !== 'undefined' && this.filters().indexOf(String(this.keyAccessor()(d))) >= 0);\n        } else if (this.hasFilter()) {\n            this._select.property('value', this.filter());\n        } else {\n            this._select.property('value', '');\n        }\n        return this;\n    }\n\n    _renderOptions () {\n        const options = this._select.selectAll(`option.${OPTION_CSS_CLASS}`)\n            .data(this.data(), d => this.keyAccessor()(d));\n\n        options.exit().remove();\n\n        options.enter()\n            .append('option')\n            .classed(OPTION_CSS_CLASS, true)\n            .attr('value', d => this.keyAccessor()(d))\n            .merge(options)\n            .text(this.title());\n\n        this._select.selectAll(`option.${OPTION_CSS_CLASS}`).sort(this._order);\n\n        this._select.on('change', adaptHandler((d, evt) => this._onChange(d, evt)));\n    }\n\n    _onChange (_d, evt) {\n        let values;\n\n        const target = evt.target;\n\n        if (target.selectedOptions) {\n            const selectedOptions = Array.prototype.slice.call(target.selectedOptions);\n            values = selectedOptions.map(d => d.value);\n        } else { // IE and other browsers do not support selectedOptions\n            // adapted from this polyfill: https://gist.github.com/brettz9/4212217\n            const options = [].slice.call(evt.target.options);\n            values = options.filter(option => option.selected).map(option => option.value);\n        }\n        // console.log(values);\n        // check if only prompt option is selected\n        if (values.length === 1 && values[0] === '') {\n            values = this._promptValue || null;\n        } else if (!this._multiple && values.length === 1) {\n            values = values[0];\n        }\n        this.onChange(values);\n    }\n\n    onChange (val) {\n        if (val && this._multiple) {\n            this.replaceFilter([val]);\n        } else if (val) {\n            this.replaceFilter(val);\n        } else {\n            this.filterAll();\n        }\n        events.trigger(() => {\n            this.redrawGroup();\n        });\n    }\n\n    _setAttributes () {\n        if (this._multiple) {\n            this._select.attr('multiple', true);\n        } else {\n            this._select.attr('multiple', null);\n        }\n        if (this._numberVisible !== null) {\n            this._select.attr('size', this._numberVisible);\n        } else {\n            this._select.attr('size', null);\n        }\n    }\n\n    /**\n     * Get or set the function that controls the ordering of option tags in the\n     * select menu. By default options are ordered by the group key in ascending\n     * order.\n     * @param {Function} [order]\n     * @returns {Function|SelectMenu}\n     * @example\n     * // order by the group's value\n     * chart.order(function (a,b) {\n     *     return a.value > b.value ? 1 : b.value > a.value ? -1 : 0;\n     * });\n     */\n    order (order) {\n        if (!arguments.length) {\n            return this._order;\n        }\n        this._order = order;\n        return this;\n    }\n\n    /**\n     * Get or set the text displayed in the options used to prompt selection.\n     * @param {String} [promptText='Select all']\n     * @returns {String|SelectMenu}\n     * @example\n     * chart.promptText('All states');\n     */\n    promptText (promptText) {\n        if (!arguments.length) {\n            return this._promptText;\n        }\n        this._promptText = promptText;\n        return this;\n    }\n\n    /**\n     * Get or set the function that filters option tags prior to display. By default options\n     * with a value of < 1 are not displayed.\n     * @param {function} [filterDisplayed]\n     * @returns {Function|SelectMenu}\n     * @example\n     * // display all options override the `filterDisplayed` function:\n     * chart.filterDisplayed(function () {\n     *     return true;\n     * });\n     */\n    filterDisplayed (filterDisplayed) {\n        if (!arguments.length) {\n            return this._filterDisplayed;\n        }\n        this._filterDisplayed = filterDisplayed;\n        return this;\n    }\n\n    /**\n     * Controls the type of select menu. Setting it to true converts the underlying\n     * HTML tag into a multiple select.\n     * @param {boolean} [multiple=false]\n     * @returns {boolean|SelectMenu}\n     * @example\n     * chart.multiple(true);\n     */\n    multiple (multiple) {\n        if (!arguments.length) {\n            return this._multiple;\n        }\n        this._multiple = multiple;\n\n        return this;\n    }\n\n    /**\n     * Controls the default value to be used for\n     * [dimension.filter](https://github.com/crossfilter/crossfilter/wiki/API-Reference#dimension_filter)\n     * when only the prompt value is selected. If `null` (the default), no filtering will occur when\n     * just the prompt is selected.\n     * @param {?*} [promptValue=null]\n     * @returns {*|SelectMenu}\n     */\n    promptValue (promptValue) {\n        if (!arguments.length) {\n            return this._promptValue;\n        }\n        this._promptValue = promptValue;\n\n        return this;\n    }\n\n    /**\n     * Controls the number of items to show in the select menu, when `.multiple()` is true. This\n     * controls the [`size` attribute](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/select#Attributes) of\n     * the `select` element. If `null` (the default), uses the browser's default height.\n     * @param {?number} [numberVisible=null]\n     * @returns {number|SelectMenu}\n     * @example\n     * chart.numberVisible(10);\n     */\n    numberVisible (numberVisible) {\n        if (!arguments.length) {\n            return this._numberVisible;\n        }\n        this._numberVisible = numberVisible;\n\n        return this;\n    }\n\n    size (numberVisible) {\n        logger.warnOnce('selectMenu.size is ambiguous - use selectMenu.numberVisible instead');\n        if (!arguments.length) {\n            return this.numberVisible();\n        }\n        return this.numberVisible(numberVisible);\n    }\n}\n\nexport const selectMenu = (parent, chartGroup) => new SelectMenu(parent, chartGroup);\n","import {ascending} from 'd3-array';\n\nimport {CompositeChart} from './composite-chart';\nimport {lineChart} from './line-chart';\nimport {utils} from '../core/utils';\nimport {compatNestHelper} from '../core/d3compat';\n\n/**\n * A series chart is a chart that shows multiple series of data overlaid on one chart, where the\n * series is specified in the data. It is a specialization of Composite Chart and inherits all\n * composite features other than recomposing the chart.\n *\n * Examples:\n * - {@link http://dc-js.github.io/dc.js/examples/series.html Series Chart}\n * @mixes CompositeChart\n */\nexport class SeriesChart extends CompositeChart {\n    /**\n     * Create a Series Chart.\n     * @example\n     * // create a series chart under #chart-container1 element using the default global chart group\n     * var seriesChart1 = new SeriesChart(\"#chart-container1\");\n     * // create a series chart under #chart-container2 element using chart group A\n     * var seriesChart2 = new SeriesChart(\"#chart-container2\", \"chartGroupA\");\n     * @param {String|node|d3.selection} parent - Any valid\n     * {@link https://github.com/d3/d3-selection/blob/master/README.md#select d3 single selector} specifying\n     * a dom block element such as a div; or a dom element or d3 selection.\n     * @param {String} [chartGroup] - The name of the chart group this chart instance should be placed in.\n     * Interaction with a chart will only trigger events and redraws within the chart's group.\n     */\n    constructor (parent, chartGroup) {\n        super(parent, chartGroup);\n\n        this._keySort = (a, b) => ascending(this.keyAccessor()(a), this.keyAccessor()(b));\n\n        this._charts = {};\n        this._chartFunction = lineChart;\n        this._chartGroup = chartGroup;\n        this._seriesAccessor = undefined;\n        this._seriesSort = ascending;\n        this._valueSort = this._keySort;\n\n        this._mandatoryAttributes().push('seriesAccessor', 'chart');\n        this.shareColors(true);\n    }\n\n    _compose (subChartArray) {\n        super.compose(subChartArray);\n    }\n\n    compose (subChartArray) {\n        throw new Error('Not supported for this chart type');\n    }\n\n    _preprocessData () {\n        const keep = [];\n        let childrenChanged;\n\n        const nesting = compatNestHelper({\n            key: this._seriesAccessor,\n            sortKeys: this._seriesSort,\n            sortValues: this._valueSort,\n            entries: this.data()\n        });\n\n        const children =\n            nesting.map((sub, i) => {\n                const subChart = this._charts[sub.key] || this._chartFunction(this, this._chartGroup , sub.key, i);\n                if (!this._charts[sub.key]) {\n                    childrenChanged = true;\n                }\n                this._charts[sub.key] = subChart;\n                keep.push(sub.key);\n                return subChart\n                    .dimension(this.dimension())\n                    .group({\n                        all: typeof sub.values === 'function' ? sub.values : utils.constant(sub.values)\n                    }, sub.key)\n                    .keyAccessor(this.keyAccessor())\n                    .valueAccessor(this.valueAccessor())\n                    .brushOn(false);\n            });\n        // this works around the fact compositeChart doesn't really\n        // have a removal interface\n        Object.keys(this._charts)\n            .filter(c => keep.indexOf(c) === -1)\n            .forEach(c => {\n                this._clearChart(c);\n                childrenChanged = true;\n            });\n        this._compose(children);\n        if (childrenChanged && this.legend()) {\n            this.legend().render();\n        }\n    }\n\n    _clearChart (c) {\n        if (this._charts[c].g()) {\n            this._charts[c].g().remove();\n        }\n        delete this._charts[c];\n    }\n\n    _resetChildren () {\n        Object.keys(this._charts).map(this._clearChart);\n        this._charts = {};\n    }\n\n    /**\n     * Get or set the chart function, which generates the child charts.\n     * @example\n     * // put curve on the line charts used for the series\n     * chart.chart(function(c) { return new LineChart(c).curve(d3.curveBasis); })\n     * // do a scatter series chart\n     * chart.chart(anchor => new ScatterPlot(anchor))\n     * @param {Function} [chartFunction= (anchor) =>  new LineChart(anchor)]\n     * @returns {Function|SeriesChart}\n     */\n    chart (chartFunction) {\n        if (!arguments.length) {\n            return this._chartFunction;\n        }\n        this._chartFunction = chartFunction;\n        this._resetChildren();\n        return this;\n    }\n\n    /**\n     * **mandatory**\n     *\n     * Get or set accessor function for the displayed series. Given a datum, this function\n     * should return the series that datum belongs to.\n     * @example\n     * // simple series accessor\n     * chart.seriesAccessor(function(d) { return \"Expt: \" + d.key[0]; })\n     * @param {Function} [accessor]\n     * @returns {Function|SeriesChart}\n     */\n    seriesAccessor (accessor) {\n        if (!arguments.length) {\n            return this._seriesAccessor;\n        }\n        this._seriesAccessor = accessor;\n        this._resetChildren();\n        return this;\n    }\n\n    /**\n     * Get or set a function to sort the list of series by, given series values.\n     * @see {@link https://github.com/d3/d3-array/blob/master/README.md#ascending d3.ascending}\n     * @see {@link https://github.com/d3/d3-array/blob/master/README.md#descending d3.descending}\n     * @example\n     * chart.seriesSort(d3.descending);\n     * @param {Function} [sortFunction=d3.ascending]\n     * @returns {Function|SeriesChart}\n     */\n    seriesSort (sortFunction) {\n        if (!arguments.length) {\n            return this._seriesSort;\n        }\n        this._seriesSort = sortFunction;\n        this._resetChildren();\n        return this;\n    }\n\n    /**\n     * Get or set a function to sort each series values by. By default this is the key accessor which,\n     * for example, will ensure a lineChart series connects its points in increasing key/x order,\n     * rather than haphazardly.\n     * @see {@link https://github.com/d3/d3-array/blob/master/README.md#ascending d3.ascending}\n     * @see {@link https://github.com/d3/d3-array/blob/master/README.md#descending d3.descending}\n     * @example\n     * // Default value sort\n     * _chart.valueSort(function keySort (a, b) {\n     *     return d3.ascending(_chart.keyAccessor()(a), _chart.keyAccessor()(b));\n     * });\n     * @param {Function} [sortFunction]\n     * @returns {Function|SeriesChart}\n     */\n    valueSort (sortFunction) {\n        if (!arguments.length) {\n            return this._valueSort;\n        }\n        this._valueSort = sortFunction;\n        this._resetChildren();\n        return this;\n    }\n\n}\n\nexport const seriesChart = (parent, chartGroup) => new SeriesChart(parent, chartGroup);\n","import {hierarchy, partition} from 'd3-hierarchy';\nimport {ascending, min, sum} from 'd3-array';\nimport {arc} from 'd3-shape';\nimport {select} from 'd3-selection';\nimport {interpolate} from 'd3-interpolate';\n\nimport {transition} from '../core/core';\nimport {filters} from '../core/filters';\nimport {utils, pluck} from '../core/utils';\nimport {adaptHandler} from '../core/d3compat';\nimport {events} from '../core/events';\nimport {ColorMixin} from '../base/color-mixin';\nimport {BaseMixin} from '../base/base-mixin';\nimport {constants} from '../core/constants';\nimport {BadArgumentException} from '../core/bad-argument-exception';\n\nconst DEFAULT_MIN_ANGLE_FOR_LABEL = 0.5;\n\n/**\n * The sunburst chart implementation is usually used to visualize a small tree distribution.  The sunburst\n * chart uses keyAccessor to determine the slices, and valueAccessor to calculate the size of each\n * slice relative to the sum of all values. Slices are ordered by {@link BaseMixin#ordering ordering} which defaults to sorting\n * by key.\n *\n * The keys used in the sunburst chart should be arrays, representing paths in the tree.\n *\n * When filtering, the sunburst chart creates instances of {@link Filters.HierarchyFilter HierarchyFilter}.\n *\n * @mixes CapMixin\n * @mixes ColorMixin\n * @mixes BaseMixin\n */\nexport class SunburstChart extends ColorMixin(BaseMixin) {\n    /**\n     * Create a Sunburst Chart\n     * @example\n     * // create a sunburst chart under #chart-container1 element using the default global chart group\n     * var chart1 = new SunburstChart('#chart-container1');\n     * // create a sunburst chart under #chart-container2 element using chart group A\n     * var chart2 = new SunburstChart('#chart-container2', 'chartGroupA');\n     *\n     * @param {String|node|d3.selection} parent - Any valid\n     * {@link https://github.com/d3/d3-3.x-api-reference/blob/master/Selections.md#selecting-elements d3 single selector} specifying\n     * a dom block element such as a div; or a dom element or d3 selection.\n     * @param {String} [chartGroup] - The name of the chart group this chart instance should be placed in.\n     * Interaction with a chart will only trigger events and redraws within the chart's group.\n     */\n    constructor (parent, chartGroup) {\n        super();\n\n        this._sliceCssClass = 'pie-slice';\n        this._emptyCssClass = 'empty-chart';\n        this._emptyTitle = 'empty';\n\n        this._radius = undefined;\n        this._givenRadius = undefined; // given radius, if any\n        this._innerRadius = 0;\n        this._ringSizes = null;\n\n        this._g = undefined;\n        this._cx = undefined;\n        this._cy = undefined;\n        this._minAngleForLabel = DEFAULT_MIN_ANGLE_FOR_LABEL;\n        this._externalLabelRadius = undefined;\n\n        this.colorAccessor(d => this.keyAccessor()(d));\n\n        // override cap mixin\n        this.ordering(pluck('key'));\n\n        this.title(d => `${this.keyAccessor()(d)}: ${this._extendedValueAccessor(d)}`);\n\n        this.label(d => this.keyAccessor()(d));\n        this.renderLabel(true);\n\n        this.transitionDuration(350);\n\n        this.anchor(parent, chartGroup);\n    }\n\n    // Handle cases if value corresponds to generated parent nodes\n    _extendedValueAccessor (d) {\n        if (d.path) {\n            return d.value;\n        }\n        return this.valueAccessor()(d);\n    }\n\n    _scaleRadius (ringIndex, y) {\n        if (ringIndex === 0) {\n            return this._innerRadius;\n        } else {\n            const customRelativeRadius = sum(this.ringSizes().relativeRingSizes.slice(0, ringIndex));\n            const scaleFactor = (ringIndex * (1 / this.ringSizes().relativeRingSizes.length)) /\n                  customRelativeRadius;\n            const standardRadius = (y - this.ringSizes().rootOffset) /\n                  (1 - this.ringSizes().rootOffset) * (this._radius - this._innerRadius);\n            return this._innerRadius + standardRadius / scaleFactor;\n        }\n    }\n\n    _doRender () {\n        this.resetSvg();\n\n        this._g = this.svg()\n            .append('g')\n            .attr('transform', `translate(${this.cx()},${this.cy()})`);\n\n        this._drawChart();\n\n        return this;\n    }\n\n    _drawChart () {\n        // set radius from chart size if none given, or if given radius is too large\n        const maxRadius = min([this.width(), this.height()]) / 2;\n        this._radius = this._givenRadius && this._givenRadius < maxRadius ? this._givenRadius : maxRadius;\n\n        const arcs = this._buildArcs();\n\n        let partitionedNodes, cdata;\n        // if we have data...\n        if (sum(this.data(), this.valueAccessor())) {\n            cdata = utils.toHierarchy(this.data(), this.valueAccessor());\n            partitionedNodes = this._partitionNodes(cdata);\n            // First one is the root, which is not needed\n            partitionedNodes.nodes.shift();\n            this._g.classed(this._emptyCssClass, false);\n        } else {\n            // otherwise we'd be getting NaNs, so override\n            // note: abuse others for its ignoring the value accessor\n            cdata = utils.toHierarchy([], d => d.value);\n            partitionedNodes = this._partitionNodes(cdata);\n            this._g.classed(this._emptyCssClass, true);\n        }\n        this.ringSizes().rootOffset = partitionedNodes.rootOffset;\n        this.ringSizes().relativeRingSizes = partitionedNodes.relativeRingSizes;\n\n        if (this._g) {\n            const slices = this._g.selectAll(`g.${this._sliceCssClass}`)\n                .data(partitionedNodes.nodes);\n            this._createElements(slices, arcs, partitionedNodes.nodes);\n\n            this._updateElements(partitionedNodes.nodes, arcs);\n\n            this._removeElements(slices);\n\n            this._highlightFilter();\n\n            transition(this._g, this.transitionDuration(), this.transitionDelay())\n                .attr('transform', `translate(${this.cx()},${this.cy()})`);\n        }\n    }\n\n    _createElements (slices, arcs, sunburstData) {\n        const slicesEnter = this._createSliceNodes(slices);\n\n        this._createSlicePath(slicesEnter, arcs);\n        this._createTitles(slicesEnter);\n        this._createLabels(sunburstData, arcs);\n    }\n\n    _createSliceNodes (slices) {\n        return slices\n            .enter()\n            .append('g')\n            .attr('class', (d, i) => `${this._sliceCssClass\n            } _${i} ${\n                this._sliceCssClass}-level-${d.depth}`);\n    }\n\n    _createSlicePath (slicesEnter, arcs) {\n        const slicePath = slicesEnter.append('path')\n            .attr('fill', (d, i) => this._fill(d, i))\n            .on('click', adaptHandler(d => this.onClick(d)))\n            .classed('dc-tabbable', this._keyboardAccessible)\n            .attr('d', d => this._safeArc(arcs, d));\n\n        if (this._keyboardAccessible) {\n            this._makeKeyboardAccessible(this.onClick);\n        }\n\n        const tranNodes = transition(slicePath, this.transitionDuration());\n        if (tranNodes.attrTween) {\n            const chart = this;\n            tranNodes.attrTween('d', function (d) {\n                return chart._tweenSlice(d, this);\n            });\n        }\n    }\n\n    _createTitles (slicesEnter) {\n        if (this.renderTitle()) {\n            slicesEnter.append('title').text(d => this.title()(d));\n        }\n    }\n\n    _positionLabels (labelsEnter, arcs) {\n        transition(labelsEnter, this.transitionDuration())\n            .attr('transform', d => this._labelPosition(d, arcs))\n            .attr('text-anchor', 'middle')\n            .text(d => {\n                // position label...\n                if (this._sliceHasNoData(d) || this._sliceTooSmall(d)) {\n                    return '';\n                }\n                return this.label()(d);\n            });\n    }\n\n    _createLabels (sunburstData, arcs) {\n        if (this.renderLabel()) {\n            const labels = this._g.selectAll(`text.${this._sliceCssClass}`)\n                .data(sunburstData);\n\n            labels.exit().remove();\n\n            const labelsEnter = labels\n                .enter()\n                .append('text')\n                .attr('class', (d, i) => {\n                    let classes = `${this._sliceCssClass} _${i}`;\n                    if (this._externalLabelRadius) {\n                        classes += ' external';\n                    }\n                    return classes;\n                })\n                .on('click', adaptHandler(d => this.onClick(d)));\n            this._positionLabels(labelsEnter, arcs);\n        }\n    }\n\n    _updateElements (sunburstData, arcs) {\n        this._updateSlicePaths(sunburstData, arcs);\n        this._updateLabels(sunburstData, arcs);\n        this._updateTitles(sunburstData);\n    }\n\n    _updateSlicePaths (sunburstData, arcs) {\n        const slicePaths = this._g.selectAll(`g.${this._sliceCssClass}`)\n            .data(sunburstData)\n            .select('path')\n            .attr('d', (d, i) => this._safeArc(arcs, d));\n        const tranNodes = transition(slicePaths, this.transitionDuration());\n        if (tranNodes.attrTween) {\n            const chart = this;\n            tranNodes.attrTween('d', function (d) {\n                return chart._tweenSlice(d, this);\n            });\n        }\n        tranNodes.attr('fill', (d, i) => this._fill(d, i));\n    }\n\n    _updateLabels (sunburstData, arcs) {\n        if (this.renderLabel()) {\n            const labels = this._g.selectAll(`text.${this._sliceCssClass}`)\n                .data(sunburstData);\n            this._positionLabels(labels, arcs);\n        }\n    }\n\n    _updateTitles (sunburstData) {\n        if (this.renderTitle()) {\n            this._g.selectAll(`g.${this._sliceCssClass}`)\n                .data(sunburstData)\n                .select('title')\n                .text(d => this.title()(d));\n        }\n    }\n\n    _removeElements (slices) {\n        slices.exit().remove();\n    }\n\n    _highlightFilter () {\n        const chart = this;\n        if (chart.hasFilter()) {\n            chart.selectAll(`g.${chart._sliceCssClass}`).each(function (d) {\n                if (chart._isSelectedSlice(d)) {\n                    chart.highlightSelected(this);\n                } else {\n                    chart.fadeDeselected(this);\n                }\n            });\n        } else {\n            chart.selectAll(`g.${chart._sliceCssClass}`).each(function (d) {\n                chart.resetHighlight(this);\n            });\n        }\n    }\n\n    /**\n     * Get or set the inner radius of the sunburst chart. If the inner radius is greater than 0px then the\n     * sunburst chart will be rendered as a doughnut chart. Default inner radius is 0px.\n     * @param {Number} [innerRadius=0]\n     * @returns {Number|SunburstChart}\n     */\n    innerRadius (innerRadius) {\n        if (!arguments.length) {\n            return this._innerRadius;\n        }\n        this._innerRadius = innerRadius;\n        return this;\n    }\n\n    /**\n     * Get or set the outer radius. If the radius is not set, it will be half of the minimum of the\n     * chart width and height.\n     * @param {Number} [radius]\n     * @returns {Number|SunburstChart}\n     */\n    radius (radius) {\n        if (!arguments.length) {\n            return this._givenRadius;\n        }\n        this._givenRadius = radius;\n        return this;\n    }\n\n    /**\n     * Get or set center x coordinate position. Default is center of svg.\n     * @param {Number} [cx]\n     * @returns {Number|SunburstChart}\n     */\n    cx (cx) {\n        if (!arguments.length) {\n            return (this._cx || this.width() / 2);\n        }\n        this._cx = cx;\n        return this;\n    }\n\n    /**\n     * Get or set center y coordinate position. Default is center of svg.\n     * @param {Number} [cy]\n     * @returns {Number|SunburstChart}\n     */\n    cy (cy) {\n        if (!arguments.length) {\n            return (this._cy || this.height() / 2);\n        }\n        this._cy = cy;\n        return this;\n    }\n\n    /**\n     * Get or set the minimal slice angle for label rendering. Any slice with a smaller angle will not\n     * display a slice label.\n     * @param {Number} [minAngleForLabel=0.5]\n     * @returns {Number|SunburstChart}\n     */\n    minAngleForLabel (minAngleForLabel) {\n        if (!arguments.length) {\n            return this._minAngleForLabel;\n        }\n        this._minAngleForLabel = minAngleForLabel;\n        return this;\n    }\n\n    /**\n     * Title to use for the only slice when there is no data.\n     * @param {String} [title]\n     * @returns {String|SunburstChart}\n     */\n    emptyTitle (title) {\n        if (arguments.length === 0) {\n            return this._emptyTitle;\n        }\n        this._emptyTitle = title;\n        return this;\n    }\n\n    /**\n     * Position slice labels offset from the outer edge of the chart.\n     *\n     * The argument specifies the extra radius to be added for slice labels.\n     * @param {Number} [externalLabelRadius]\n     * @returns {Number|SunburstChart}\n     */\n    externalLabels (externalLabelRadius) {\n        if (arguments.length === 0) {\n            return this._externalLabelRadius;\n        } else if (externalLabelRadius) {\n            this._externalLabelRadius = externalLabelRadius;\n        } else {\n            this._externalLabelRadius = undefined;\n        }\n\n        return this;\n    }\n\n    /**\n     * Constructs the default RingSizes parameter for {@link SunburstChart#ringSizes ringSizes()},\n     * which makes the rings narrower as they get farther away from the center.\n     *\n     * Can be used as a parameter to ringSizes() to reset the default behavior, or modified for custom ring sizes.\n     *\n     * @example\n     *   var chart = new dc.SunburstChart(...);\n     *   chart.ringSizes(chart.defaultRingSizes())\n     * @returns {RingSizes}\n     */\n    defaultRingSizes () {\n        return {\n            partitionDy: () => this._radius * this._radius,\n            scaleInnerRadius: d => d.data.path && d.data.path.length === 1 ?\n                this._innerRadius :\n                Math.sqrt(d.y0),\n            scaleOuterRadius: d => Math.sqrt(d.y1),\n            relativeRingSizesFunction: () => []\n        };\n    }\n\n    /**\n     * Constructs a RingSizes parameter for {@link SunburstChart#ringSizes ringSizes()}\n     * that will make the chart rings equally wide.\n     *\n     * @example\n     *   var chart = new dc.SunburstChart(...);\n     *   chart.ringSizes(chart.equalRingSizes())\n     * @returns {RingSizes}\n     */\n    equalRingSizes () {\n        return this.relativeRingSizes(\n            ringCount => {\n                const result = [];\n                for (let i = 0; i < ringCount; i++) {\n                    result.push(1 / ringCount);\n                }\n                return result;\n            }\n        );\n    }\n\n    /**\n     * Constructs a RingSizes parameter for {@link SunburstChart#ringSizes ringSizes()} using the given function\n     * to determine each rings width.\n     *\n     * * The function must return an array containing portion values for each ring/level of the chart.\n     * * The length of the array must match the number of rings of the chart at runtime, which is provided as the only\n     *   argument.\n     * * The sum of all portions from the array must be 1 (100%).\n     *\n     * @example\n     * // specific relative portions (the number of rings (3) is known in this case)\n     * chart.ringSizes(chart.relativeRingSizes(function (ringCount) {\n     *     return [.1, .3, .6];\n     * });\n     * @param {Function} [relativeRingSizesFunction]\n     * @returns {RingSizes}\n     */\n    relativeRingSizes (relativeRingSizesFunction) {\n        function assertPortionsArray (relativeSizes, numberOfRings) {\n            if (!Array.isArray(relativeSizes)) {\n                throw new BadArgumentException('relativeRingSizes function must return an array');\n            }\n\n            const portionsSum = sum(relativeSizes);\n            if (Math.abs(portionsSum - 1) > constants.NEGLIGIBLE_NUMBER) {\n                throw new BadArgumentException(\n                    `relativeRingSizes : portions must add up to 1, but sum was ${portionsSum}`);\n            }\n\n            if (relativeSizes.length !== numberOfRings) {\n                throw new BadArgumentException(\n                    `relativeRingSizes : number of values must match number of rings (${\n                        numberOfRings}) but was ${relativeSizes.length}`);\n            }\n        }\n        return {\n            partitionDy: () => 1,\n            scaleInnerRadius: d => this._scaleRadius(d.data.path.length - 1, d.y0),\n            scaleOuterRadius: d => this._scaleRadius(d.data.path.length, d.y1),\n            relativeRingSizesFunction: ringCount => {\n                const result = relativeRingSizesFunction(ringCount);\n                assertPortionsArray(result, ringCount);\n                return result;\n            }\n        };\n    }\n\n    /**\n     * Get or set the strategy to use for sizing the charts rings.\n     *\n     * There are three strategies available\n     * * {@link SunburstChart#defaultRingSizes `defaultRingSizes`}: the rings get narrower farther away from the center\n     * * {@link SunburstChart#relativeRingSizes `relativeRingSizes`}: set the ring sizes as portions of 1\n     * * {@link SunburstChart#equalRingSizes `equalRingSizes`}: the rings are equally wide\n     *\n     * You can modify the returned strategy, or create your own, for custom ring sizing.\n     *\n     * RingSizes is a duck-typed interface that must support the following methods:\n     * * `partitionDy()`: used for\n     *   {@link https://github.com/d3/d3-hierarchy/blob/v1.1.9/README.md#partition_size `d3.partition.size`}\n     * * `scaleInnerRadius(d)`: takes datum and returns radius for\n     *    {@link https://github.com/d3/d3-shape/blob/v1.3.7/README.md#arc_innerRadius `d3.arc.innerRadius`}\n     * * `scaleOuterRadius(d)`: takes datum and returns radius for\n     *    {@link https://github.com/d3/d3-shape/blob/v1.3.7/README.md#arc_outerRadius `d3.arc.outerRadius`}\n     * * `relativeRingSizesFunction(ringCount)`: takes ring count and returns an array of portions that\n     *   must add up to 1\n     *\n     * @example\n     * // make rings equally wide\n     * chart.ringSizes(chart.equalRingSizes())\n     * // reset to default behavior\n     * chart.ringSizes(chart.defaultRingSizes()))\n     * @param {RingSizes} ringSizes\n     * @returns {Object|SunburstChart}\n     */\n    ringSizes (ringSizes) {\n        if (!arguments.length) {\n            if (!this._ringSizes) {\n                this._ringSizes = this.defaultRingSizes();\n            }\n            return this._ringSizes;\n        }\n        this._ringSizes = ringSizes;\n        return this;\n    }\n\n    _buildArcs () {\n        return arc()\n            .startAngle(d => d.x0)\n            .endAngle(d => d.x1)\n            .innerRadius(d => this.ringSizes().scaleInnerRadius(d))\n            .outerRadius(d => this.ringSizes().scaleOuterRadius(d));\n    }\n\n    _isSelectedSlice (d) {\n        return this._isPathFiltered(d.path);\n    }\n\n    _isPathFiltered (path) {\n        for (let i = 0; i < this.filters().length; i++) {\n            const currentFilter = this.filters()[i];\n            if (currentFilter.isFiltered(path)) {\n                return true;\n            }\n        }\n        return false;\n    }\n\n    // returns all filters that are a parent or child of the path\n    _filtersForPath (path) {\n        const pathFilter = filters.HierarchyFilter(path);\n        const filtersList = [];\n        for (let i = 0; i < this.filters().length; i++) {\n            const currentFilter = this.filters()[i];\n            if (currentFilter.isFiltered(path) || pathFilter.isFiltered(currentFilter)) {\n                filtersList.push(currentFilter);\n            }\n        }\n        return filtersList;\n    }\n\n    _doRedraw () {\n        this._drawChart();\n        return this;\n    }\n\n    _partitionNodes (data) {\n        const getSortable = function (d) {\n            return {'key': d.data.key, 'value': d.value};\n        };\n        const _hierarchy = hierarchy(data)\n            .sum(d => d.children ? 0 : this._extendedValueAccessor(d))\n            .sort((a, b) => ascending(this.ordering()(getSortable(a)), this.ordering()(getSortable(b))));\n\n        const _partition = partition()\n              .size([2 * Math.PI, this.ringSizes().partitionDy()]);\n\n        _partition(_hierarchy);\n\n        // In D3v4 the returned data is slightly different, change it enough to suit our purposes.\n        const nodes = _hierarchy.descendants().map(d => {\n            d.key = d.data.key;\n            d.path = d.data.path;\n            return d;\n        });\n\n        const relativeSizes = this.ringSizes().relativeRingSizesFunction(_hierarchy.height);\n\n        return {\n            nodes,\n            rootOffset: _hierarchy.y1,\n            relativeRingSizes: relativeSizes\n        };\n    }\n\n    _sliceTooSmall (d) {\n        const angle = d.x1 - d.x0;\n        return isNaN(angle) || angle < this._minAngleForLabel;\n    }\n\n    _sliceHasNoData (d) {\n        return this._extendedValueAccessor(d) === 0;\n    }\n\n    _isOffCanvas (d) {\n        return !d || isNaN(d.x0) || isNaN(d.y0);\n    }\n\n    _fill (d, i) {\n        return this.getColor(d.data, i);\n    }\n\n    onClick (d) {\n        if (this._g.attr('class') === this._emptyCssClass) {\n            return;\n        }\n\n        // Must be better way to handle this, in legends we need to access `d.key`\n        const path = d.path || d.key;\n        const filter = filters.HierarchyFilter(path);\n\n        // filters are equal to parents or children of the path.\n        const filtersList = this._filtersForPath(path);\n        let exactMatch = false;\n        // clear out any filters that cover the path filtered.\n        for (let j = filtersList.length - 1; j >= 0; j--) {\n            const currentFilter = filtersList[j];\n            if (utils.arraysIdentical(currentFilter, path)) {\n                exactMatch = true;\n            }\n            this.filter(filtersList[j]);\n        }\n        events.trigger(() => {\n            // if it is a new filter - put it in.\n            if (!exactMatch) {\n                this.filter(filter);\n            }\n            this.redrawGroup();\n        });\n    }\n\n    _safeArc (_arc, d) {\n        let path = _arc(d);\n        if (path.indexOf('NaN') >= 0) {\n            path = 'M0,0';\n        }\n        return path;\n    }\n\n    _labelPosition (d, _arc) {\n        let centroid;\n        if (this._externalLabelRadius) {\n            centroid = arc()\n                .outerRadius(this._radius + this._externalLabelRadius)\n                .innerRadius(this._radius + this._externalLabelRadius)\n                .centroid(d);\n        } else {\n            centroid = _arc.centroid(d);\n        }\n        if (isNaN(centroid[0]) || isNaN(centroid[1])) {\n            return 'translate(0,0)';\n        } else {\n            return `translate(${centroid})`;\n        }\n    }\n\n    legendables () {\n        return this.data().map((d, i) => {\n            const legendable = {name: d.key, data: d.value, others: d.others, chart: this};\n            legendable.color = this.getColor(d, i);\n            return legendable;\n        });\n    }\n\n    legendHighlight (d) {\n        this._highlightSliceFromLegendable(d, true);\n    }\n\n    legendReset (d) {\n        this._highlightSliceFromLegendable(d, false);\n    }\n\n    legendToggle (d) {\n        this.onClick({key: d.name, others: d.others});\n    }\n\n    _highlightSliceFromLegendable (legendable, highlighted) {\n        this.selectAll('g.pie-slice').each(function (d) {\n            if (legendable.name === d.key) {\n                select(this).classed('highlight', highlighted);\n            }\n        });\n    }\n\n    _tweenSlice (d, element) {\n        let current = element._current;\n        if (this._isOffCanvas(current)) {\n            current = {x0: 0, x1: 0, y0: 0, y1: 0};\n        }\n        const tweenTarget = {\n            x0: d.x0,\n            x1: d.x1,\n            y0: d.y0,\n            y1: d.y1\n        };\n        const i = interpolate(current, tweenTarget);\n        element._current = i(0);\n        return t => this._safeArc(this._buildArcs(), Object.assign({}, d, i(t)));\n    }\n}\n\nexport const sunburstChart = (parent, chartGroup) => new SunburstChart(parent, chartGroup);\n","import {BaseMixin} from '../base/base-mixin';\nimport {constants} from '../core/constants';\nimport {events} from '../core/events';\n\nconst INPUT_CSS_CLASS = 'dc-text-filter-input';\n\n/**\n * Text Filter Widget\n *\n * The text filter widget is a simple widget designed to display an input field allowing to filter\n * data that matches the text typed.\n * As opposed to the other charts, this doesn't display any result and doesn't update its display,\n * it's just to input an filter other charts.\n *\n * @mixes BaseMixin\n */\nexport class TextFilterWidget extends BaseMixin {\n    /**\n     * Create Text Filter widget\n     * @example\n     *\n     * var data = [{\"firstName\":\"John\",\"lastName\":\"Coltrane\"}{\"firstName\":\"Miles\",lastName:\"Davis\"}]\n     * var ndx = crossfilter(data);\n     * var dimension = ndx.dimension(function(d) {\n     *     return d.lastName.toLowerCase() + ' ' + d.firstName.toLowerCase();\n     * });\n     *\n     * new TextFilterWidget('#search')\n     *     .dimension(dimension);\n     *     // you don't need the group() function\n     *\n     * @param {String|node|d3.selection|CompositeChart} parent - Any valid\n     * {@link https://github.com/d3/d3-selection/blob/master/README.md#select d3 single selector}\n     * specifying a dom block element such as a div; or a dom element or d3 selection.\n     * @param {String} [chartGroup] - The name of the chart group this chart instance should be placed in.\n     * Interaction with a chart will only trigger events and redraws within the chart's group.\n     */\n    constructor (parent, chartGroup) {\n        super();\n\n        this._normalize = s => s.toLowerCase();\n\n        this._filterFunctionFactory = query => {\n            query = this._normalize(query);\n            return d => this._normalize(d).indexOf(query) !== -1;\n        };\n\n        this._placeHolder = 'search';\n\n        this.group(() => {\n            throw 'the group function on textFilterWidget should never be called, please report the issue';\n        });\n\n        this.anchor(parent, chartGroup);\n    }\n\n    _doRender () {\n        this.select('input').remove();\n\n        this._input = this.root().append('input')\n            .classed(INPUT_CSS_CLASS, true);\n\n        const chart = this;\n        this._input.on('input', function () {\n            chart.dimension().filterFunction(chart._filterFunctionFactory(this.value));\n            events.trigger(() => {\n                chart.redrawGroup();\n            }, constants.EVENT_DELAY);\n        });\n\n        this._doRedraw();\n\n        return this;\n    }\n\n    _doRedraw () {\n        this.root().selectAll('input')\n            .attr('placeholder', this._placeHolder);\n\n        return this;\n    }\n\n    /**\n     * This function will be called on values before calling the filter function.\n     * @example\n     * // This is the default\n     * chart.normalize(function (s) {\n     *   return s.toLowerCase();\n     * });\n     * @param {function} [normalize]\n     * @returns {TextFilterWidget|function}\n     */\n    normalize (normalize) {\n        if (!arguments.length) {\n            return this._normalize;\n        }\n        this._normalize = normalize;\n        return this;\n    }\n\n    /**\n     * Placeholder text in the search box.\n     * @example\n     * // This is the default\n     * chart.placeHolder('type to filter');\n     * @param {function} [placeHolder='search']\n     * @returns {TextFilterWidget|string}\n     */\n    placeHolder (placeHolder) {\n        if (!arguments.length) {\n            return this._placeHolder;\n        }\n        this._placeHolder = placeHolder;\n        return this;\n    }\n\n    /**\n     * This function will be called with the search text, it needs to return a function that will be used to\n     * filter the data. The default function checks presence of the search text.\n     * @example\n     * // This is the default\n     * function (query) {\n     *     query = _normalize(query);\n     *     return function (d) {\n     *         return _normalize(d).indexOf(query) !== -1;\n     *     };\n     * };\n     * @param {function} [filterFunctionFactory]\n     * @returns {TextFilterWidget|function}\n     */\n    filterFunctionFactory (filterFunctionFactory) {\n        if (!arguments.length) {\n            return this._filterFunctionFactory;\n        }\n        this._filterFunctionFactory = filterFunctionFactory;\n        return this;\n    }\n}\n\nexport const textFilterWidget = (parent, chartGroup) => new TextFilterWidget(parent, chartGroup);\n"],"names":["BadArgumentException","Error","constants","CHART_CLASS","DEBUG_GROUP_CLASS","STACK_CLASS","DESELECTED_CLASS","SELECTED_CLASS","NODE_INDEX_NAME","GROUP_INDEX_NAME","DEFAULT_CHART_GROUP","EVENT_DELAY","NEGLIGIBLE_NUMBER","Logger","[object Object]","this","enableDebugLog","_alreadyWarned","msg","console","warn","log","logger","debug","Config","_defaultColors","_schemeCategory20c","dateFormat","timeFormat","_renderlet","disableTransitions","colors","arguments","length","warnOnce","config","chartRegistry","_chartMap","group","chart","e","indexOf","_initializeChartGroup","push","i","anchorName","splice","registerChart","register","deregisterChart","deregister","renderAll","charts","list","render","redrawAll","redraw","transition","selection","duration","delay","name","s","undefined","optionalTransition","enable","instanceOfChart","o","Object","__dcFlag__","events","current","trigger","closure","setTimeout","filters","RangedFilter","low","high","range","Array","isFiltered","value","filterType","TwoDimensionalFilter","filter","f","RangedTwoDimensionalFilter","fromBottomLeft","Math","min","max","Infinity","x","y","HierarchyFilter","path","slice","InvalidStateException","pluck","n","d","call","utils","printSingleValue","Date","isFloat","fformat","isInteger","round","format","_toTimeFunc","t","second","timeSecond","minute","timeMinute","hour","timeHour","day","timeDay","week","timeWeek","month","timeMonth","year","timeYear","add","l","r","replace","getTime","offset","percentage","subtract","isNumber","isNegligible","clamp","val","constant","_idCounter","findChild","children","nodeName","k","key","uniqueId","nameToId","toLowerCase","appendOrSelect","parent","selector","tag","element","select","empty","append","safeNumber","arraysEqual","a1","a2","every","elem","valueOf","allChildren","node","paths","concat","toHierarchy","accessor","root","data","parts","currentNode","j","currentPath","childNode","getAncestors","unshift","arraysIdentical","a","b","printers","map","join","units","adaptHandler","handler","target","event","compatNestHelper","sortKeys","sortValues","entries","nester","nest","_d3v5Nester","integers","start","end","abs","ordinal","fp","precision","_f","resolution","floor","ceil","_defaultFilterHandler","dimension","filterRange","filterFunction","filterExact","_defaultHasFilterHandler","some","_defaultRemoveFilterHandler","_defaultAddFilterHandler","_defaultResetFilterHandler","BaseMixin","_svgDescription","_keyboardAccessible","_dimension","_group","_anchor","_root","_svg","_isChild","_minWidth","_defaultWidthCalc","width","getBoundingClientRect","_widthCalc","_minHeight","_defaultHeightCalc","height","_heightCalc","_width","_height","_useViewBoxResizing","_keyAccessor","_valueAccessor","_label","_ordering","_renderLabel","_title","keyAccessor","valueAccessor","_renderTitle","_controlsUseVisibility","_transitionDuration","_transitionDelay","_filterPrinter","_mandatoryAttributesList","_chartGroup","_listeners","dispatch","_legend","_commitHandler","_defaultData","all","_data","_filters","_filterHandler","_hasFilterHandler","_removeFilterHandler","_addFilterHandler","_resetFilterHandler","minWidth","minHeight","useViewBoxResizing","expireCache","callback","_groupName","orderFunction","from","sort","ascending","sel","selectAll","chartGroup","anchor","classed","id","chartID","rootElement","svgElement","remove","generateSvg","attr","html","svgDescription","sizeSvg","description","constructor","keyboardAccessible","filterPrinterFunction","controlsUseVisibility","attribute","style","text","_","forEach","checkForMandatoryAttributes","result","_doRender","_activateRenderlets","onClickFunction","onClickArgs","tabElements","on","keyCode","preventDefault","transitionDuration","transitionDelay","_doRedraw","commitHandler","error","hasFilterHandler","removeFilterHandler","addFilterHandler","resetFilterHandler","fs","applyFilters","_invokeFilteredListener","hasFilter","turnOnControls","turnOffControls","datum","redrawGroup","filterHandler","labelFunction","enableLabels","renderLabel","titleFunction","renderTitle","legend","opts","applyOptions","apply","listener","renderletFunction","ColorMixin","Base","super","_colors","scaleOrdinal","defaultColors","_colorAccessor","_colorCalculator","getColor","newDomain","colorAccessor","domain","colorScale","scaleQuantize","scaleLinear","interpolate","interpolateHcl","colorCalculator","BubbleMixin","_maxBubbleRelativeSize","_minRadiusWithLabel","_sortBubbleSize","_elasticRadius","_excludeElasticZero","BUBBLE_NODE_CLASS","BUBBLE_CLASS","MIN_RADIUS","radiusAccessor","radiusValueAccessor","descending","_r","bubbleRadiusScale","elasticRadius","rMin","rMax","_rValueAccessor","values","isNaN","label","bubbleR","_shouldLabel","bubbleGEnter","onClick","_labelPointerEvent","_labelFunction","_labelOpacity","labels","title","g","_titleFunction","sortBubbleSize","radius","relativeSize","excludeZero","each","isSelectedNode","highlightSelected","fadeDeselected","resetHighlight","CapMixin","_cap","_takeFront","_othersLabel","_othersGrouper","topItems","restItems","restItemsSum","sum","restKeys","others","othersLabel","ordering","kv","_computeOrderedGroups","rest","items","count","takeFront","grouperFunction","MarginMixin","_margin","top","right","bottom","left","margins","X_AXIS_LABEL_CLASS","CUSTOM_BRUSH_HANDLE_CLASS","CoordinateGridMixin","schemeCategory10","_mandatoryAttributes","_parent","_g","_chartBodyG","_x","_origX","_xOriginalDomain","_xAxis","axisBottom","_xUnits","_xAxisPadding","_xAxisPaddingUnit","_xElasticity","_xAxisLabel","_xAxisLabelPadding","_lastXDomain","_y","_yAxis","_yAxisPadding","_yElasticity","_yAxisLabel","_yAxisLabelPadding","_brush","brushX","_gBrush","_brushOn","_parentBrushOn","_round","_ignoreBrushEvents","_renderHorizontalGridLine","_renderVerticalGridLine","_resizing","_unitCount","_zoomScale","_zoomOutRestrict","_zoom","zoom","evt","_onZoom","_nullZoom","_hasBeenMouseZoomable","_ignoreZoomEvents","_rangeChart","_focusChart","_mouseZoomable","_clipPadding","_fOuterRangeBandPadding","_fRangeBandPadding","_useRightYAxis","resizing","rangeChart","focusChart","extent","zoomOutRestrict","svg","href","window","location","split","_getClipPathId","gElement","mouseZoomable","chartBodyG","xScale","rescale","xUnits","xAxis","elasticX","padding","unit","isOrdinal","useRightYAxis","bandwidth","scaleBand","_ordinalXDomain","xAxisMin","xAxisMax","xdom","xAxisLength","paddingInner","paddingOuter","_useOuterPadding","scale","_renderVerticalGridLines","axisXG","_xAxisY","axisXLab","xAxisLabel","gridLineG","insert","ticks","tickValues","tickArguments","lines","linesGEnter","enter","exit","effectiveWidth","labelText","axisRight","axisLeft","elasticY","_min","yAxisMin","_max","yAxisMax","rangeRound","yAxisHeight","_createYAxis","_renderHorizontalGridLinesForAxis","axisClass","rotation","labelXPosition","axisYLab","labelYPosition","axis","position","axisYG","axisPosition","_yAxisX","renderYAxisAt","labelPosition","renderYAxisLabel","yAxisLabel","yScale","yAxis","renderHorizontalGridLines","renderVerticalGridLines","m","effectiveHeight","redrawBrush","doTransition","_brushing","setBrushExtents","createBrushHandlePaths","gBrush","brushHandles","type","merge","resizeHandlePath","brushSelection","invert","extendBrush","rangedFilter","brushIsEmpty","applyBrushSelection","replaceFilter","oldValue","_withoutBrushEvents","scaledSelection","move","fadeDeselectedArea","defs","chartBodyClip","resetSvg","_preprocessData","_generateG","_generateClipPath","_drawChart","_configureMouseZoom","_prepareXAxis","_prepareYAxis","plotData","renderXAxis","renderYAxis","renderBrush","copy","_enableMouseZoom","_disableMouseZoom","scaleExtent","zoomScaleMin","translateExtent","_updateD3zoomTransform","noRaiseEvents","domFilter","_hasRangeSelected","_invokeZoomedListener","origDomain","xt","zoomIdentity","translate","_withoutZoomEvents","transform","_domainToZoomTransform","rescaleX","focus","ext","outerLimits","_checkExtents","_zoomHandler","c","xOriginalDomain","brushOn","d3Box","Number","whiskers","boxWhiskers","quartiles","boxQuartiles","tickFormat","renderDataPoints","dataOpacity","dataWidthPortion","showOutliers","boldOutlier","box","index","quartileData","whiskerIndices","whiskerData","_i","outlierIndices","pointIndices","x1","x0","__chart__","center","_box","medianLine","whisker","outlierClass","outlierSize","outlierX","random","outlier","point","boxTick","whiskerTick","timerFlush","quantile","StackMixin","_stackLayout","stack","_stack","_titles","_hidableStacks","_evadeDomainFilter","layers","_visibility","_prepareValues","v4data","v","col","layer","keys","stackLayout","series","ys","y0","y1","layerIdx","valAccessor","String","allValues","hidden","domainValues","_domainFilter","evadeDomainFilter","xDomain","p","hidableStacks","stackName","_findLayerByName","_flattenStack","yAxisPadding","xAxisPadding","xAxisPaddingUnit","titleAccessor","flat","color","isLegendableHidden","showStack","hideStack","renderGroup","BarChart","_gap","_centerBar","_alwaysUseRounding","_barWidth","_outerRangeBandPadding","_calculateBarWidth","last","size","_renderBars","_renderLabels","_barHeight","layerIndex","labelsEnterUpdate","_labelXPos","_labelYPos","bars","_barXPos","barsEnterUpdate","_makeKeyboardAccessible","numberOfBars","xUnitCount","barPadding","parentBrushOn","centerBar","_rangeBandPadding","gap","alwaysUseRounding","colorFilter","inv","match","defaultWhiskersIQR","q1","q3","iqr","BoxPlot","_whiskerIqrFactor","_whiskersIqr","_whiskers","_tickFormat","_renderDataPoints","_dataOpacity","_dataWidthPortion","_showOutliers","_boldOutlier","_yRangePadding","_boxWidth","innerChartWidth","boxPadding","outerPadding","boxWidth","_calculatedBoxWidth","boxesG","boxesGEnterUpdate","_renderBoxes","_updateBoxes","_removeBoxes","boxesGEnter","_boxTransform","_maxDataValue","_minDataValue","_yAxisRangeRatio","yRangePadding","show","opacity","BubbleChart","_bubbleX","_bubbleY","calculateRadiusDomain","maxBubbleRelativeSize","bubbleG","order","_removeNodes","_renderNodes","_updateNodes","_bubbleLocator","_doRenderLabel","_doRenderTitles","doUpdateLabels","doUpdateTitles","isFinite","BUBBLE_OVERLAY_CLASS","BubbleOverlay","_points","_initOverlayG","_initializeBubbles","_mapData","nodeG","_getNodeG","circle","bubbleNodeClass","_updateBubbles","flag","debugG","debugText","mouse","ITEM_CSS_CLASS","CboxMenu","_cbox","_promptText","_multiple","_inputType","_promptValue","_uniqueId","_filterDisplayed","_order","_renderOptions","property","options","_onChange","li","checked","nodes","option","onChange","filterAll","promptText","filterDisplayed","multiple","promptValue","CompositeChart","_children","_childOptions","_shareColors","_shareTitle","_alignYAxes","_rightYAxis","_rightYAxisLabel","_rightYAxisLabelPadding","_rightY","_rightAxisGridLines","child","_generateChildG","_leftYAxisChildren","_rightYAxisChildren","ranges","_calculateYAxisRanges","_prepareLeftYAxis","_prepareRightYAxis","rightYAxis","rightYAxisLabel","lyAxisMin","lyAxisMax","ryAxisMin","ryAxisMax","_yAxisMin","_yAxisMax","_rightYAxisMin","_rightYAxisMax","alignYAxes","_alignYAxisRanges","extentRatio","needDomain","rightY","needRange","useRightAxisGridLines","childOptions","subChartArray","prop","_setChildrenProperty","shareColors","shareTitle","_getYAxisMin","_getYAxisMax","_getAllXAxisMinFromChildCharts","_getAllXAxisMaxFromChildCharts","reduce","legendables","legendHighlight","legendReset","DataCount","_formatNumber","_crossfilter","_groupAll","_html","formatter","tot","crossfilter","groupAll","selected","cf","GRID_CSS_CLASS","DataGrid","_section","_size","JSON","stringify","_sortBy","_beginSlice","_endSlice","_htmlSection","_renderItems","_renderSections","sections","_nestEntries","itemSection","section","beginSlice","endSlice","htmlSection","sortByFunction","ROW_CSS_CLASS","DataTable","_columns","_showSections","_renderRows","_doColumnHeaderFnToString","_doColumnHeaderCapitalize","charAt","toUpperCase","i1","i2","lastIndexOf","substring","bAllFunctions","thead","headrow","headcols","_doColumnHeaderFormat","rowSection","rows","rowEnter","_doColumnValueFormat","columns","sortBy","showSections","GeoChoroplethChart","_geoPath","geoPath","_projectionFlag","_projection","_geoJsons","regionG","_geoJson","_getGeoPath","_plotData","_generateLayeredData","_isDataLayer","_renderRegionG","_renderPaths","_renderTitles","_layerSelector","_isSelected","_isDeselected","baseClasses","_getKey","currentFill","selectedRegion","json","projection","geoAlbersUsa","geoJsons","HeatMap","_chartBody","_cols","_rows","_colOrdering","_rowOrdering","_colScale","_rowScale","_xBorderRadius","_yBorderRadius","_colsLabel","_rowsLabel","_xAxisOnClick","_filterAxis","_yAxisOnClick","_boxOnClick","cellsOnAxis","unfilteredCellsOnAxis","filtersList","nonstandardFilter","_filter","isArray","rowOrdering","cols","colOrdering","rowCount","colCount","boxHeight","boxes","gEnter","boxOnClick","gCols","gColsText","xAxisOnClick","colsLabel","gRows","gRowsText","yAxisOnClick","rowsLabel","xBorderRadius","yBorderRadius","HtmlLegend","_htmlLegendDivCssClass","_legendItemCssClassHorizontal","_legendItemCssClassVertical","_container","_legendText","_maxItems","_horizontal","_legendItemClass","_highlightSelected","_defaultLegendItemCssClass","container","legendItemClassName","itemEnter","legendToggle","_makeLegendKeyboardAccessible","legendItemClass","horizontal","legendText","maxItems","Legend","_itemHeight","_legendWidth","_itemWidth","_autoItemWidth","itemHeight","legendWidth","itemWidth","autoItemWidth","self","clientHeight","cumulativeLegendTextWidth","row","getBBox","translateBy","_legendItemHeight","Y_AXIS_REF_LINE_CLASS","X_AXIS_REF_LINE_CLASS","DEFAULT_DOT_OPACITY","LineChart","_renderArea","_dotRadius","_dataPointRadius","_dataPointFillOpacity","_dataPointStrokeOpacity","_curve","_interpolate","_tension","_defined","_dashStyle","_xyTipsOn","chartBody","layersList","layersEnter","_drawLine","_drawArea","_drawDots","_drawLabels","curve","tension","defined","dashStyle","renderArea","linear","curveLinear","linear-closed","curveLinearClosed","step","curveStep","step-before","curveStepBefore","step-after","curveStepAfter","basis","curveBasis","basis-open","curveBasisOpen","basis-closed","curveBasisClosed","bundle","curveBundle","cardinal","curveCardinal","cardinal-open","curveCardinalOpen","cardinal-closed","curveCardinalClosed","monotone","curveMonotoneX","_line","line","_getCurveFactory","_getColor","_safeD","_area","area","xyTipsOn","tooltipListClass","tooltips","points","_createRefLines","dots","dotsEnterModify","_getDotRadius","dot","_showDot","_showRefLines","_hideDot","_hideRefLines","_doRenderTitle","labelsEnterModify","yAxisRefPathD","xAxisRefPathD","dotRadius","fillOpacity","strokeOpacity","dashstyle","item","_colorFilter","lineChart","SPAN_CLASS","NumberDisplay","one","none","_lastValue","_ariaLiveRegion","valObj","_maxBin","sorted","newValue","span","ease","easeQuad","tween","interpStart","interp","interpolateNumber","num","formatNumber","innerHTML","ariaLiveRegion","PieChart","_sliceCssClass","_labelCssClass","_sliceGroupCssClass","_labelGroupCssClass","_emptyCssClass","_emptyTitle","_radius","_givenRadius","_innerRadius","_externalRadiusPadding","_cx","_cy","_minAngleForLabel","_externalLabelRadius","_drawPaths","cappedKeyAccessor","cappedValueAccessor","cap","cx","cy","maxRadius","arcs","_buildArcs","pieLayout","_pieLayout","pieData","slices","_removeElements","_createElements","_updateElements","_highlightFilter","slicesEnter","_createSliceNodes","_createSlicePath","_createTitles","_createLabels","slicePath","_fill","_onClick","_safeArc","tranNodes","attrTween","_tweenPie","_sliceHasNoData","_sliceTooSmall","_isSelectedSlice","_applyLabelText","_labelPosition","whether","labelsEnter","classes","_highlightSlice","_positionLabels","_updateLabelPaths","polyline","arc2","arc","outerRadius","innerRadius","_current","startAngle","endAngle","d2","centroid","_updateSlicePaths","_updateLabels","_updateTitles","slicePaths","externalRadiusPadding","minAngleForLabel","pie","angle","_arc","externalLabelRadius","drawPaths","legendable","_highlightSliceFromLegendable","highlighted","_isOffCanvas","RowChart","_labelOffsetX","_labelOffsetY","_hasLabelOffsetY","_dyOffset","_titleLabelOffsetX","_fixedBarHeight","_rowCssClass","_titleRowCssClass","_renderTitleLabel","_elasticX","_rowData","rowsCap","_extent","axisG","_calculateAxisScale","_drawAxis","_drawGridLines","rect","_isSelectedRow","_rootValue","_translateX","renderTitleLabel","lab","titlelab","fixedBarHeight","labelOffsetX","labelOffsety","titleLabelOffsetX","ScatterPlot","_symbol","symbol","_existenceAccessor","originalKeyAccessor","_opacityAccessor","_opacity","existenceAccessor","_highlightedSize","_symbolSize","_excludedSize","_excludedColor","_excludedOpacity","_emptySize","_emptyOpacity","_nonemptyOpacity","_emptyColor","_filtered","_canvas","_context","_useCanvas","brush","_elementSize","sqrt","PI","pow","svgSel","svgLeft","parseInt","svgTop","devicePixelRatio","getContext","clip","imageSmoothingQuality","useCanvas","canvasElement","legendHighlightDatum","_resizeCanvas","context","clearRect","canvas","cOpacity","getOpacity","getExcludedOpacity","cColor","excludedColor","cSize","_canvasElementSize","isHighlighted","fadeOutOpacity","save","globalAlpha","beginPath","fillStyle","fill","restore","symbols","_locator","excludedOpacity","_plotOnCanvas","_plotOnSVG","_d","customSymbol","symbolSize","opacityAccessor","highlightedSize","excludedSize","emptySize","emptyColor","emptyOpacity","nonemptyOpacity","_resizeSymbolsWhere","condition","oldSize","coord","ranged2DFilter","OPTION_CSS_CLASS","SelectMenu","_select","_numberVisible","_setAttributes","selectedOptions","prototype","numberVisible","SeriesChart","_keySort","_charts","_chartFunction","_seriesAccessor","_seriesSort","_valueSort","compose","keep","childrenChanged","sub","subChart","_clearChart","_compose","chartFunction","_resetChildren","sortFunction","SunburstChart","_ringSizes","_extendedValueAccessor","ringIndex","customRelativeRadius","ringSizes","relativeRingSizes","scaleFactor","standardRadius","rootOffset","partitionedNodes","cdata","_partitionNodes","shift","sunburstData","depth","_tweenSlice","partitionDy","scaleInnerRadius","scaleOuterRadius","relativeRingSizesFunction","ringCount","_scaleRadius","relativeSizes","numberOfRings","portionsSum","assertPortionsArray","defaultRingSizes","_isPathFiltered","pathFilter","currentFilter","getSortable","_hierarchy","hierarchy","partition","_partition","descendants","_filtersForPath","exactMatch","tweenTarget","assign","TextFilterWidget","_normalize","_filterFunctionFactory","query","_placeHolder","_input","normalize","placeHolder","filterFunctionFactory","_transition","clear","has"],"mappings":"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"}